<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>zeroto的博客</title>
  <subtitle>追求卓越，成功自然而来</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="//zeroto.tech/"/>
  <updated>2018-06-20T09:49:19.000Z</updated>
  <id>//zeroto.tech/</id>
  
  <author>
    <name>千古不见一人闲</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Quartz Best Practices</title>
    <link href="//zeroto.tech/2018/06/20/Quartz%20Best%20Practices/"/>
    <id>//zeroto.tech/2018/06/20/Quartz Best Practices/</id>
    <published>2018-06-20T08:28:15.000Z</published>
    <updated>2018-06-20T09:49:19.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h1><ul>
<li>Production System Tips</li>
<li>JobDataMap Tips</li>
<li>Trigger Tips</li>
<li>JDBC JobStore</li>
<li>Daylight Savings Time</li>
<li>Jobs</li>
<li>Listeners (TriggerListener, JobListener, SchedulerListener</li>
<li>Exposing Scheduler Functionality Through Applications</li>
</ul>
<a id="more"></a>
<h2 id="生产环境中的建议"><a href="#生产环境中的建议" class="headerlink" title="生产环境中的建议"></a>生产环境中的建议</h2><p><strong>跳过检查更新</strong><br>通过配置 “org.quartz.scheduler.skipUpdateCheck: true” 属性，你能够取消检查更新。</p>
<h2 id="JobDataMap-建议"><a href="#JobDataMap-建议" class="headerlink" title="JobDataMap 建议"></a>JobDataMap 建议</h2><p><strong>Only Store Primitive Data Types (including Strings) In the JobDataMap，避免序列化问题</strong></p>
<p><strong>Use the Merged JobDataMap</strong><br>在任务执行的时候，JobExecutionContext中的JobDataMap作为一个convenience。它是通过在JobDetail中的JobDataMap和Trigger中的JobDataMap合并而来，后者中的值会覆盖前面一个中同名变量的值。</p>
<p>当你有一个任务在scheduler中，而且这个任务又会被多个Triggers重复使用，那么你最好把值存在Trigger的JobDataMap中，这样对于每次独立的任务触发时，你就可以为Job提供不同的数据输入啦。</p>
<p>根据以上所述，我们提出了如下的最佳实践：在调用Job.execute(…)方法时，一般来说应该从JobExecutionContext中的JobDataMap中解析变量的值，而不是直接从JobDetail的JobDataMap中解析。</p>
<h2 id="Trigger-建议"><a href="#Trigger-建议" class="headerlink" title="Trigger 建议"></a>Trigger 建议</h2><p><strong>Use TriggerUtils</strong></p>
<ul>
<li>提供了一个简单的方法来创建triggers（schedules）</li>
<li>有很多不同的方法通过schedules来创建triggers以满足特定的描述，这个要比直接实例化特定类型的triggers（SimpleTrigger，CronTrigger等）然后调用不同的setter方法来配置它们方便许多</li>
<li>提供了一个简单的方法来创建日期（比如start/end日期）</li>
<li>提供了分析triggers的助手（e.g. calculating future fire times）</li>
</ul>
<h2 id="JDBC-JobStore"><a href="#JDBC-JobStore" class="headerlink" title="JDBC JobStore"></a>JDBC JobStore</h2><p><strong>永远都不要直接往Quartz的表中写数据</strong><br>Writing scheduling data directly to the database (via SQL) rather than using scheduling API:<br><strong>永远不要在同一个Database将一个Non-Clustered Scheduler 指向另一个相同名字的Scheduler Name</strong><br>If you point more than one scheduler instance at the same set of database tables, and one or more of those instances is not configured for clustering, any of the following may occur:</p>
<ul>
<li>会造成数据腐化（被删除的数据，混乱的数据）</li>
<li>会造成任务在到达执行点的时候像没有执行就消失了</li>
<li>会造成当触发时间到来时，而任务还未执行</li>
<li>可能会造成死锁</li>
</ul>
<p><strong>Ensure Adequate Datasource Connection Size</strong><br>建议将你的数据源连接数配置为配置为线程池中工作线程数加3。如果你的应用还要经常调用scheduler的API，那么你还需要增加额外的connections。If you are using JobStoreCMT, the “non managed” datasource should have a max connection size of at least four.</p>
<h2 id="Daylight-Savings-Time"><a href="#Daylight-Savings-Time" class="headerlink" title="Daylight Savings Time"></a>Daylight Savings Time</h2><p><strong>Avoid Scheduling Jobs Near the Transition Hours of Daylight Savings Time</strong><br>注意：本地的时钟向前或者向后转移时和总的时间的细节可以在如下链接中找到：<br><a href="https://en.wikipedia.org/wiki/Daylight_saving_time_by_country" target="_blank" rel="external">https://en.wikipedia.org/wiki/Daylight_saving_time_by_country</a>.</p>
<p>SimpleTriggers不受夏令时的影响，这是因为它们总是在毫秒时刻被精确地触发，并且在进过了精确的毫秒数之后会再次被触发。</p>
<p>由于CronTriggers会在给定的时/分/秒被触发，当夏令时转移时到来的时候，它们会受到这些怪事的影响。</p>
<p>举一个可能发生的例子，在夏令时的美国时区/位置进行调度的时候，如果使用CronTrigger并且调度的触发时间是在1:00 AM和2:00 AM之间时会发生下列的问题：</p>
<ul>
<li>1:05 AM may occur twice! - duplicate firings on CronTrigger possible</li>
<li>2:05 AM may never occur! - missed firings on CronTrigger possible</li>
</ul>
<p>Again, specifics of time and amount of adjustment varies by locale.</p>
<p>其他的触发器类型是根据日历的移动而不是根据确切的时间量来进行的，例如CalenderIntervalTrigger，将会同样地受影响，但不是错过触发或者触发两次，而是将它的触发时间偏移一个小时。</p>
<h2 id="Jobs"><a href="#Jobs" class="headerlink" title="Jobs"></a>Jobs</h2><p><strong>等待条件来到</strong><br>长时间运行的任务会阻止其他任务的运行（如果在线程池中所有的线程都繁忙）。</p>
<p>如果你认为需要调用 Thread.sleep() 这个方法来停止工作线程执行任务，这是一个典型的信号，任务不会完成其余的任务，因它必须等待某些条件的到来（比如某些数据可读）。</p>
<p>一个更好的方法是释放线程 (exit the job) 并且允许其他任务在这个线程执行。任务可以重新调度自己，或者在它退出之前其他任务。</p>
<p><strong>抛出异常</strong><br>一个任务的执行方法应该包含在try-catch块中，以此处理可能发生的异常。</p>
<p>如果一个任务抛出一个异常，Quartz一般会马上再执行它（可能会抛出相同的异常）。最好是任务捕获所有它可能遇到的异常并处理它们，然后重新调度自己或其他的任务。</p>
<p><strong>可恢复性和幂等性</strong><br>In-progress Jobs marked “recoverable” are automatically re-executed after a scheduler fails. This means some of the job’s “work” will be executed twice.</p>
<p>This means the job should be coded in such a way that its work is idempotent.</p>
<h2 id="监听器（TriggerListener-JobListener-SchedulerListener）"><a href="#监听器（TriggerListener-JobListener-SchedulerListener）" class="headerlink" title="监听器（TriggerListener, JobListener, SchedulerListener）"></a>监听器（TriggerListener, JobListener, SchedulerListener）</h2><p><strong>Keep Code In Listeners Concise And Efficient</strong><br>Keep Code In Listeners Concise And Efficient<br>Performing large amounts of work is discouraged, as the thread that would be executing the job (or completing the trigger and moving on to firing another job, etc.) will be tied up within the listener.</p>
<p><strong>处理异常</strong><br>每个监听器的方法都应该在try-catch块中处理所有可能的异常。</p>
<p>如果一个监听器抛出了一个异常，可能会造成其他的监听器无法被通知到或阻止其他任务的执行等。</p>
<h2 id="通过应用来暴露调度器的功能"><a href="#通过应用来暴露调度器的功能" class="headerlink" title="通过应用来暴露调度器的功能"></a>通过应用来暴露调度器的功能</h2><p><strong>Be Careful of Security!</strong><br>有的用户通过应用程序接口来暴露Quartz的调度功能。这会非常有用，虽它可能会造成极度的危险。</p>
<p>确保你没有错误地允许用户定义他们想要的任何参数和任何类型的任务。例如，Quartz会带有一个预定的任务org.quartz.jobs.NativeJob，这个任务将会在它们定义的任意的本地系统上执行命令。恶意的用户可能会使用这个来控制或者摧毁你的系统。</p>
<p>同样的像 SendEmailJob 之类的任务，并且事实上任何其他的任务都可以被当作恶意用途。</p>
<p>如果允许用户定义任意他们想要的任务将会是你的系统遭受各种可能的危害，等同于 OWASP 和 MITRE 定义的命令注入攻击等。</p>
<h1 id="参考在此："><a href="#参考在此：" class="headerlink" title="参考在此："></a>参考在此：</h1><p><a href="http://www.quartz-scheduler.org/documentation/best-practices.html" target="_blank" rel="external">Quartz Best Practices(http://www.quartz-scheduler.org/documentation/best-practices.html)</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;最佳实践&quot;&gt;&lt;a href=&quot;#最佳实践&quot; class=&quot;headerlink&quot; title=&quot;最佳实践&quot;&gt;&lt;/a&gt;最佳实践&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;Production System Tips&lt;/li&gt;
&lt;li&gt;JobDataMap Tips&lt;/li&gt;
&lt;li&gt;Trigger Tips&lt;/li&gt;
&lt;li&gt;JDBC JobStore&lt;/li&gt;
&lt;li&gt;Daylight Savings Time&lt;/li&gt;
&lt;li&gt;Jobs&lt;/li&gt;
&lt;li&gt;Listeners (TriggerListener, JobListener, SchedulerListener&lt;/li&gt;
&lt;li&gt;Exposing Scheduler Functionality Through Applications&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Quartz" scheme="//zeroto.tech/tags/Quartz/"/>
    
  </entry>
  
  <entry>
    <title>网线接口转换器 苹果Mac集线器HUB接硬盘</title>
    <link href="//zeroto.tech/2018/06/05/Mac%20%E7%BD%91%E7%BA%BF%E6%8E%A5%E5%8F%A3%E8%BD%AC%E6%8D%A2%E5%99%A8%E7%9A%84%E6%AD%A3%E7%A1%AE%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
    <id>//zeroto.tech/2018/06/05/Mac 网线接口转换器的正确使用方法/</id>
    <published>2018-06-05T09:38:55.000Z</published>
    <updated>2018-06-05T09:55:26.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Mac-连接网线"><a href="#Mac-连接网线" class="headerlink" title="Mac 连接网线"></a>Mac 连接网线</h1><p>以我在京东上购买的 毕亚兹(biaze) USB分线器3.0 千兆有线网卡 USB转RJ45网线接口转换器 苹果Mac集线器HUB接硬盘 ZH17-金属银 为例：</p>
<pre><code class="sh">~ csrutil status
System Integrity Protection status: enabled (Custom Configuration).

Configuration:
    Apple Internal: disabled
    Kext Signing: enabled
    Filesystem Protections: enabled
    Debugging Restrictions: disabled
    DTrace Restrictions: enabled
    NVRAM Protections: enabled
    BaseSystem Verification: enabled

This is an unsupported configuration, likely to break in the future and leave your machine in an unknown state.
~
</code></pre>
<p>首先，SIP status 必须是 disabled 状态才行，可以通过以下步骤设置：<br>1、重启电脑<br>2、按住command+r进入恢复模式<br>3、点击顶部菜单栏实用工具中的终端，（可以输入csrutil status检查状态）<br>4、然后输入csrutil disable</p>
<p>其次，<a href="http://www.realtek.com/downloads/downloadsView.aspx?Langid=3&amp;PNid=56&amp;PFid=56&amp;Level=5&amp;Conn=4&amp;DownTypeID=3&amp;GetDown=false#7" target="_blank" rel="external">下载驱动</a>,选择 MAC OS 10.6 to 10.13 版本，下载安装。</p>
<p>最后，重启电脑。此时，关闭Wi-Fi 网络，试试网络吧。公司网络应该是用网线连接上了。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Mac-连接网线&quot;&gt;&lt;a href=&quot;#Mac-连接网线&quot; class=&quot;headerlink&quot; title=&quot;Mac 连接网线&quot;&gt;&lt;/a&gt;Mac 连接网线&lt;/h1&gt;&lt;p&gt;以我在京东上购买的 毕亚兹(biaze) USB分线器3.0 千兆有线网卡 USB转RJ45
    
    </summary>
    
    
      <category term="Mac 网线接口转换器" scheme="//zeroto.tech/tags/Mac-%E7%BD%91%E7%BA%BF%E6%8E%A5%E5%8F%A3%E8%BD%AC%E6%8D%A2%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>亿级流量网站架构核心技术</title>
    <link href="//zeroto.tech/2018/05/14/%E9%AB%98%E5%8F%AF%E7%94%A8%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/"/>
    <id>//zeroto.tech/2018/05/14/高可用与高并发/</id>
    <published>2018-05-14T08:01:27.000Z</published>
    <updated>2018-05-14T08:20:33.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="跟开涛学搭建高可用高并发系统"><a href="#跟开涛学搭建高可用高并发系统" class="headerlink" title="跟开涛学搭建高可用高并发系统"></a>跟开涛学搭建高可用高并发系统</h1><p>本书将介绍缓存、异步并发、连接池、线程池、如何扩容、消息队列、分布式任务等高并发原则来提升系统吞吐量。</p>
<p>通过负载均衡和反向代理实现分流，通过限流 保护服务免受雪崩之灾，<br>通过降级实现部分可用、有损服务，通过隔离实现故障隔离，<br>通过设置合理的超时与重试机制避免请求堆积造成雪崩，通过回滚机制快速修复错误版本；<br>使得系统高可用。</p>
<a id="more"></a>
<p><img src="/assets/blogImg/高可用.png" alt="高可用"></p>
<p><img src="/assets/blogImg/高并发.png" alt="高并发"></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;跟开涛学搭建高可用高并发系统&quot;&gt;&lt;a href=&quot;#跟开涛学搭建高可用高并发系统&quot; class=&quot;headerlink&quot; title=&quot;跟开涛学搭建高可用高并发系统&quot;&gt;&lt;/a&gt;跟开涛学搭建高可用高并发系统&lt;/h1&gt;&lt;p&gt;本书将介绍缓存、异步并发、连接池、线程池、如何扩容、消息队列、分布式任务等高并发原则来提升系统吞吐量。&lt;/p&gt;
&lt;p&gt;通过负载均衡和反向代理实现分流，通过限流 保护服务免受雪崩之灾，&lt;br&gt;通过降级实现部分可用、有损服务，通过隔离实现故障隔离，&lt;br&gt;通过设置合理的超时与重试机制避免请求堆积造成雪崩，通过回滚机制快速修复错误版本；&lt;br&gt;使得系统高可用。&lt;/p&gt;
    
    </summary>
    
    
      <category term="高可用" scheme="//zeroto.tech/tags/%E9%AB%98%E5%8F%AF%E7%94%A8/"/>
    
      <category term="高并发" scheme="//zeroto.tech/tags/%E9%AB%98%E5%B9%B6%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>那些年我看过的书</title>
    <link href="//zeroto.tech/2018/03/14/recommend-books/"/>
    <id>//zeroto.tech/2018/03/14/recommend-books/</id>
    <published>2018-03-14T05:42:13.000Z</published>
    <updated>2018-06-22T01:12:18.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="开头"><a href="#开头" class="headerlink" title="开头"></a>开头</h1><p>2012年底正式参加工作，先后经历了三家单位（软通、必联（北京）电子商务、北京四合天地科技），有短有长（补充：2018-06入职互金行业了）。有的得到了经验，有的在那里得到了成长。不付青春吧。期间也认识了不少志同道合的好同事，有些也成为了好朋友。技术道路上还需披荆斩棘，更进一步。回首往事，才能更好的展望未来。</p>
<a id="more"></a>
<p><img src="/assets/blogImg/In-the-Grass.jpg" alt="In-the-Grass"></p>
<h2 id="技术书籍推荐（90-都是购买的书籍，偏爱）"><a href="#技术书籍推荐（90-都是购买的书籍，偏爱）" class="headerlink" title="技术书籍推荐（90%都是购买的书籍，偏爱）"></a>技术书籍推荐（90%都是购买的书籍，偏爱）</h2><p>有些是在京东上购买的书籍，有些是在异步社区上购买的，还有些就是<a href="http://tengj.top/" target="_blank" rel="external">嘟嘟独立博客</a>电子书互助计划得到的。<br>1、 《Java 核心技术》卷一 、卷二 两本书，算是入门比较好的书籍了<br>2、 <a href="https://legacy.gitbook.com/book/quanke/think-in-java/details" target="_blank" rel="external">Thinking in Java (Java 编程思想)</a>GitBook 可下载阅读。第13章没有编辑，Java的GUI现在应用少，正合我意。<br>3、 《Java 并发编程实战》<br>4、 《实战Java高并发程序设计》<br>5、 <a href="https://legacy.gitbook.com/@zhengyq" target="_blank" rel="external">Effective Java 中文版 第2版</a>GitBook 可下载阅读。算是 Java 的进阶书籍了，面试好多问题也是从这出来的<br>6、 《图解数据结构-使用Java》<br>7、 《Spring揭秘》<br>8、 《设计模式之禅（第2版）》<br>9、 《Redis实战》异步社区，购买的正版电子图书。超级清晰。在此推广一波<br>10、《MyBatis从入门到精通__刘增辉(著)》<br>11、《Android群英传：神兵利器》<br>12、《图解HTTP》对互联网基盘-HTTP协议进行了全面系统的介绍<br>13、《图解TCP/IP(第5版)》<br>14、《Spring Boot实战 ,丁雪丰 (译者) 》<br>15、《阿里巴巴Java开发手册（终极版）》</p>
<h3 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h3><p>1、《数据结构与算法分析-Java语言描述 第3版》木有坚持读下来<br>2、《算法 第4版》木有坚持读下来<br>3、《程序员的数学1》<br>4、《程序员的数学2：概率统计》<br>5、《程序员的数学3：线性代数》</p>
<h3 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h3><p>1、《大型网站技术架构：核心原理与案例分析》<br>2、《淘宝技术这十年》<br>3、《亿级流量网站架构核心技术(跟开涛学搭建高可用高并发系统)》<br>4、《深入分布式缓存：从原理到实践》<br>5、《Spring Cloud微服务实战》<br>6、《架构探险：轻量级微服务架构（上）》黄勇。由此加入了勇哥建立的微信群，大佬云集<br>7、《分布式服务框架原理与实践》<br>8、《Netty权威指南第二版》</p>
<h2 id="优秀博客推荐"><a href="#优秀博客推荐" class="headerlink" title="优秀博客推荐"></a>优秀博客推荐</h2><p>1、<a href="https://www.geekonomics10000.com/" target="_blank" rel="external">万维钢 用理工科思维理解世界</a><br>2、<a href="http://mindhacks.cn/" target="_blank" rel="external">刘未鹏</a><br>3、<a href="https://coolshell.cn/" target="_blank" rel="external">酷壳-陈皓</a><br>4、<a href="http://jinnianshilongnian.iteye.com/" target="_blank" rel="external">开涛的博客</a><br>5、<a href="http://cmsblogs.com/" target="_blank" rel="external">chenssy</a> Java并发编程实战</p>
<h2 id="人文书籍推荐"><a href="#人文书籍推荐" class="headerlink" title="人文书籍推荐"></a>人文书籍推荐</h2><p>1、《暗时间》 刘未鹏 | <a href="http://mindhacks.cn/" target="_blank" rel="external">Mind Hacks思维改变生活</a><br>2、《数学之美 （第二版）》吴军博士的，“数学之美”系列文章原刊载于谷歌黑板报<br>3、《浪潮之巅》同样也是吴军博士的<br>4、《三国机密》、《三国配角演义》马伯庸老爷子，有“文字鬼才”之誉<br>5、《北京折叠》<br>6、《人类简史》<br>7、《万万没想到：用理工科思维理解世界》万维钢<br>8、《黑客与画家》<br>9、《如何变得有意思：阮一峰博客文集》<br>10、《MacTalk 跨越边界》<br>11、《禅与摩托车维修艺术》</p>
<h2 id="商业、经济、财经"><a href="#商业、经济、财经" class="headerlink" title="商业、经济、财经"></a>商业、经济、财经</h2><p>1、《联盟：互联网时代的人才变革》参加了樊登读书会，因而知道的这本书<br>2、《重新定义公司：谷歌是如何运营的》<br>3、《罗辑思维 有种·有料·有趣》<br>4、《魔鬼经济学》也是罗辑思维视频节目了解到的，共四册；只读了前两册。<br>5、《从0到1开启商业与未来的秘密》<br>6、《怪诞行为学：可预测的非理性》<br>7、《怪诞行为学2：非理性的积极力量》<br>8、《三体：黑暗森林》<br>9、《我在碧桂园的1000天》电子版内部使用。以财务之眼看杨国强和他的地产王国。在碧桂园人称“三斌”之一吴建斌 著；</p>
<h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><p>Git ： 廖雪峰的 Git 教程<br>IDEA：<a href="https://github.com/judasn/IntelliJ-IDEA-Tutorial" target="_blank" rel="external">IntelliJ IDEA 简体中文专题教程</a><br>Maven：《Maven实战》</p>
<h2 id="程序员的自我修养"><a href="#程序员的自我修养" class="headerlink" title="程序员的自我修养"></a>程序员的自我修养</h2><p>1、《程序员修炼之道-从小工到专家》<br>2、《代码整洁之道》<br>3、《重构：改善既有代码的设计》<br>4、《软技能：代码之外的生存指南》 程序员除了写代码，还得懂点其他的软技能</p>
<h2 id="生活、其他"><a href="#生活、其他" class="headerlink" title="生活、其他"></a>生活、其他</h2><p>1、《悟空传》今何在。有这样一群人，他们宁肯死，也不肯输。<br>2、《煮酒探西游》吴闲云<br>3、《我不是潘金莲》刘震云的几乎都买来读过；12年、13年那两年很喜欢读他的书，一句顶一万句，温故一九四二、一地鸡毛、温故一九四二。<br>4、《人民的名义》影视剧开播前就已经读完了，电视剧还是追了。<br>5、《你我皆凡人》：从金庸武侠里读出来的现实江湖（六神磊磊处女作）。有微信大号“六神磊磊读金庸”，置顶公众号，粉丝支持所以买了这本书。<br>6、《为什么你总是害怕来不及》<br>7、《从你的全世界路过》张嘉佳<br>8、《儒林外史》、三言两拍；<br>9、《万历十五年》</p>
<h2 id="计划要看的电子书"><a href="#计划要看的电子书" class="headerlink" title="计划要看的电子书"></a>计划要看的电子书</h2><p>1、《编程之法：面试和算法心得_迷你书》<br>2、《架构即未来 现代企业可扩展的Web架构流程和组织原书第2版》<br>3、《一线架构师实践指南》<br>4、《O2O实战+他们是如何利用互联网的》<br>5、《实战Elasticsearch、Logstash、Kibana++分布式大数据搜索与日志挖掘及可视化解决方案》<br>6、《数据库查询优化器的艺术：原理解析与SQL性能优化》</p>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>个人认为，作为程序员不要吝啬对自己的投资，只有自己强大了才能更好的赚钱。每年都要买几本书投资一下，未来的回报会超出你的想象的，博主先准备把2017年买的书先看完先。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;开头&quot;&gt;&lt;a href=&quot;#开头&quot; class=&quot;headerlink&quot; title=&quot;开头&quot;&gt;&lt;/a&gt;开头&lt;/h1&gt;&lt;p&gt;2012年底正式参加工作，先后经历了三家单位（软通、必联（北京）电子商务、北京四合天地科技），有短有长（补充：2018-06入职互金行业了）。有的得到了经验，有的在那里得到了成长。不付青春吧。期间也认识了不少志同道合的好同事，有些也成为了好朋友。技术道路上还需披荆斩棘，更进一步。回首往事，才能更好的展望未来。&lt;/p&gt;
    
    </summary>
    
    
      <category term="随笔" scheme="//zeroto.tech/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>Spring Cloud构建微服务架构</title>
    <link href="//zeroto.tech/2018/03/07/Spring%20Boot%E6%9E%84%E5%BB%BA%E5%BE%AE%E6%9C%8D%E5%8A%A1/"/>
    <id>//zeroto.tech/2018/03/07/Spring Boot构建微服务/</id>
    <published>2018-03-07T06:45:37.000Z</published>
    <updated>2018-06-22T01:16:11.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="接触Spring-Boot"><a href="#接触Spring-Boot" class="headerlink" title="接触Spring Boot"></a>接触Spring Boot</h1><p>2016年 Spring Boot 还没有被广泛使用，到了现在经过2年的发展，很多互联网公司已经将 Spring Boot 搬上了生产，而使用 Spring Boot 的开源项目在 Github/码云 上面已有不少，很有必要开启一波学习潮了。</p>
<p>听到了一句挺中肯的话，“离开场景和业务的修炼都是伪命题”。所以呢，有必要总结一下Spring Boot 相关的开源项目，选取一个感兴趣的，然后深入学习提交pr，真正的提高自己的技术能力。</p>
<a id="more"></a>
<h2 id="搜集"><a href="#搜集" class="headerlink" title="搜集"></a>搜集</h2><ul>
<li><a href="https://gitee.com/vmaps" target="_blank" rel="external">springcloud-app/dubbo-app</a></li>
<li><a href="http://springcloud.cn/view/337" target="_blank" rel="external">海信商业云平台的微服务落地实践</a>马映辉 群分享</li>
<li><a href="https://mp.weixin.qq.com/s/R4uUH0y-ZwoelLNnM4zYow" target="_blank" rel="external">如何把复杂单体应用快速迁移到微服务</a></li>
<li><a href="http://tengj.top/2017/04/24/springboot0/" target="_blank" rel="external">Spring Boot干货系列总纲</a></li>
<li><a href="https://www.bysocket.com/?page_id=1639" target="_blank" rel="external">Spring Boot 那些事</a></li>
<li><a href="http://blog.didispace.com/Spring-Boot基础教程/" target="_blank" rel="external">Spring Boot基础教程</a></li>
<li>[江南一点雨（Spring Cloud教程合集）]作者参考了程序猿DD（翟永超）一书《Spring Cloud微服务实战》，可用来作为辩证学习的素材。</li>
<li>[江南一点雨] <a href="https://github.com/lenve" target="_blank" rel="external">https://github.com/lenve</a></li>
<li><a href="http://xujin.org/" target="_blank" rel="external">沉思录</a> Spring Cloud中国社区创始人，业余主要研究Spring Cloud。我们微信群猪的博客，强力推荐。</li>
</ul>
<h2 id="有思想的博客站点"><a href="#有思想的博客站点" class="headerlink" title="有思想的博客站点"></a>有思想的博客站点</h2><ul>
<li><a href="https://my.oschina.net/huangyong" target="_blank" rel="external">黄勇</a> 群主，强力推荐。</li>
<li><a href="http://www.ityouknow.com/" target="_blank" rel="external">纯洁的微笑</a> 微笑大佬，我们【原创技术博客作者交流群】群主。</li>
<li><a href="http://blog.didispace.com/" target="_blank" rel="external">程序猿DD</a></li>
<li><a href="http://tengj.top/" target="_blank" rel="external">嘟嘟独立博客</a></li>
<li><a href="https://www.bysocket.com/" target="_blank" rel="external">泥瓦匠BYSocket</a></li>
<li><a href="https://blog.52itstyle.com/" target="_blank" rel="external">小柒2012</a></li>
<li><a href="http://www.itmuch.com/" target="_blank" rel="external">周立</a></li>
<li><a href="https://juejin.im/user/56fe494539b0570054f2e032" target="_blank" rel="external">Aresn</a> iView 主力开发者</li>
<li><a href="https://juejin.im/post/591aa14f570c35006961acac" target="_blank" rel="external">花裤衩（手摸手，带你用vue撸后台）</a></li>
<li><a href="http://www.itdiffer.com/" target="_blank" rel="external">老齐</a></li>
<li><a href="http://goileo.top/#blog" target="_blank" rel="external">Goileo Lee</a></li>
<li><a href="http://binux.cn/" target="_blank" rel="external">许彬</a></li>
<li><a href="http://stormzhang.com/" target="_blank" rel="external">stormzhang</a></li>
<li><a href="http://shiyanjun.cn/" target="_blank" rel="external">简单之美</a></li>
<li><a href="https://gitee.com/sunlightcs" target="_blank" rel="external">独孤求胜</a></li>
<li><a href="http://blog.mayongfa.cn/" target="_blank" rel="external">马勇发</a></li>
<li><a href="http://blog.csdn.net/singwhatiwanna" target="_blank" rel="external">任玉刚</a></li>
<li><a href="https://jianshiapp.com/circles/1209" target="_blank" rel="external">见识（web前端）</a></li>
<li><a href="https://monkeysayhi.github.io/" target="_blank" rel="external">猴子007</a></li>
<li><a href="http://litten.me/" target="_blank" rel="external">Litten</a></li>
<li><a href="http://imweb.io/" target="_blank" rel="external">IMWeb前端博客</a></li>
<li><a href="https://github.com/Blankj/awesome-java-leetcode" target="_blank" rel="external">Blankj</a> 有个非常知名的 awesome-java-leetcode</li>
<li><a href="https://blankj.com/" target="_blank" rel="external">https://blankj.com/</a></li>
<li><a href="http://guolin.tech" target="_blank" rel="external">郭霖</a></li>
<li><a href="http://blog.csdn.net/lmj623565791" target="_blank" rel="external">张鸿洋</a></li>
<li><a href="http://www.wanandroid.com/" target="_blank" rel="external">http://www.wanandroid.com/</a> 张鸿洋运营</li>
<li><a href="http://blog.csdn.net/eclipsexys" target="_blank" rel="external">eclipse_xu</a> 《Android群英传：神兵利器》,买了读过。有意思的人儿</li>
<li><a href="http://lawlite.me/" target="_blank" rel="external">Lawlite</a></li>
<li><a href="http://www.54tianzhisheng.cn/" target="_blank" rel="external">zhisheng</a></li>
<li><a href="http://jumpbyte.cn/" target="_blank" rel="external">JumpByte</a></li>
<li><a href="http://blog.csdn.net/v_july_v" target="_blank" rel="external">结构之法 算法之道</a></li>
<li><a href="https://coolshell.cn/" target="_blank" rel="external">酷壳-陈皓</a></li>
<li><a href="http://calvin1978.blogcn.com/" target="_blank" rel="external">江南白衣 </a> 老司机</li>
<li><a href="http://www.iocoder.cn/?vip" target="_blank" rel="external">芋道源码的博客</a> 文斌兄的地盘，另外也有知识星球，可以加入我们。</li>
<li><a href="http://lovestblog.cn/" target="_blank" rel="external">你假笨@JVM</a></li>
<li><a href="https://blog.iwannarun.cn/" target="_blank" rel="external">I WANNA RUN</a></li>
<li><a href="http://moxfive.xyz/" target="_blank" rel="external">MOxFIVE</a> Yelee主题开发者，很美观。</li>
</ul>
<h3 id="终极搜寻"><a href="#终极搜寻" class="headerlink" title="终极搜寻"></a>终极搜寻</h3><ul>
<li><a href="http://springcloud.cn/" target="_blank" rel="external">Spring Cloud中国社区</a></li>
<li><a href="http://www.spring4all.com/" target="_blank" rel="external">http://www.spring4all.com/</a></li>
<li><a href="http://springboot.fun/" target="_blank" rel="external">Spring Boot 中文索引</a></li>
<li><a href="http://www.ityouknow.com/springboot/2018/03/05/spring-boot-open-source.html" target="_blank" rel="external">Spring Boot 开源软件都有哪些？</a>  </li>
</ul>
<h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p>朋友圈里看到了一句话，觉得特别好：不善于总结的人，就是在吃老本，吃惯性，吃你的智商和知识。<br>所以呢建立博客，有的没的写一些技术、生活相关的东西，但愿不辜负青春，便想努力留下印记。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;接触Spring-Boot&quot;&gt;&lt;a href=&quot;#接触Spring-Boot&quot; class=&quot;headerlink&quot; title=&quot;接触Spring Boot&quot;&gt;&lt;/a&gt;接触Spring Boot&lt;/h1&gt;&lt;p&gt;2016年 Spring Boot 还没有被广泛使用，到了现在经过2年的发展，很多互联网公司已经将 Spring Boot 搬上了生产，而使用 Spring Boot 的开源项目在 Github/码云 上面已有不少，很有必要开启一波学习潮了。&lt;/p&gt;
&lt;p&gt;听到了一句挺中肯的话，“离开场景和业务的修炼都是伪命题”。所以呢，有必要总结一下Spring Boot 相关的开源项目，选取一个感兴趣的，然后深入学习提交pr，真正的提高自己的技术能力。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Spring Boot" scheme="//zeroto.tech/tags/Spring-Boot/"/>
    
      <category term="Spring Cloud" scheme="//zeroto.tech/tags/Spring-Cloud/"/>
    
  </entry>
  
  <entry>
    <title>Mac之神兵利器</title>
    <link href="//zeroto.tech/2018/03/05/Mac%E4%B9%8B%E7%A5%9E%E5%85%B5%E5%88%A9%E5%99%A8/"/>
    <id>//zeroto.tech/2018/03/05/Mac之神兵利器/</id>
    <published>2018-03-05T03:18:28.000Z</published>
    <updated>2018-03-12T03:07:19.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="接触Mac"><a href="#接触Mac" class="headerlink" title="接触Mac"></a>接触Mac</h1><p>我是2016年底买的Mac，原因是在那时候通读了《MacTalk 跨越边界》、《MacTalk 人生元编程》这两本书，顿觉打开了一扇大门。随即宣告了我的联想Y570正式退役。<br>现如今Mac上的开发利器、效率工具也装了不少，也该是从资料库整理一下的时机了。</p>
<a id="more"></a>
<h2 id="搜集Mac"><a href="#搜集Mac" class="headerlink" title="搜集Mac"></a>搜集Mac</h2><ul>
<li><a href="https://mp.weixin.qq.com/s/v8TqIVyuNW7zjyAFUYUMaA" target="_blank" rel="external">Mac使用 Alfred 提高你的工作效率</a></li>
<li><a href="http://macshuo.com/?p=625" target="_blank" rel="external">神兵利器——Alfred</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MjM5ODQ2MDIyMA==&amp;mid=2650712591&amp;idx=1&amp;sn=96347db5cefd051aa94cc57a7b130519&amp;scene=38#wechat_redirect" target="_blank" rel="external">推荐几款我最喜爱的 Mac 软件（非技术）</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MjM5ODQ2MDIyMA==&amp;mid=2650712374&amp;idx=1&amp;sn=c85519d3e4730603811120c453cac7c6&amp;scene=38#wechat_redirect" target="_blank" rel="external">从 Mac OS 到 macOS，一个新的轮回</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MjM5ODQ2MDIyMA==&amp;mid=203870218&amp;idx=1&amp;sn=6865ca1a61508815934812eb8f4701df&amp;scene=38#wechat_redirect" target="_blank" rel="external">Mac 与 Windows 的虚妄之争</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MjM5ODQ2MDIyMA==&amp;mid=100342903&amp;idx=1&amp;sn=73f7fa339be9dc7dd5771aacca92f555&amp;scene=38#wechat_redirect" target="_blank" rel="external">程序员最常用的十个 Mac 工具（上）</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MjM5ODQ2MDIyMA==&amp;mid=100345605&amp;idx=1&amp;sn=79712e26aece94936ed3273757c07e9e&amp;scene=38#wechat_redirect" target="_blank" rel="external">程序员最常用的十个 Mac 工具（中）</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MjM5ODQ2MDIyMA==&amp;mid=100351098&amp;idx=1&amp;sn=6c67d2d78d331e90d4c9adbf2d9350cf&amp;scene=38#wechat_redirect" target="_blank" rel="external">程序员最常用的十个 Mac 工具（下）</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MjM5ODQ2MDIyMA==&amp;mid=200805470&amp;idx=1&amp;sn=8e1aeac4238592291ba8135f95144613&amp;scene=38#wechat_redirect" target="_blank" rel="external">我在大学里学到的几件事</a></li>
<li><a href="https://www.waitsun.com/omnifocus-2-10.html" target="_blank" rel="external">OmniFocus 2 Pro for Mac 2.10 序号版 - 最优秀的GTD效率工具</a></li>
<li><a href="https://www.waitsun.com/parallels-desktop-13-2-0-43213.html" target="_blank" rel="external">Parallels Desktop 13 for Mac 13.2.0.43213 破解版 - Mac上最优秀的虚拟机</a></li>
<li><a href="http://www.ntfsformac.cn/" target="_blank" rel="external">Paragon NTFS for Mac</a>付费购买</li>
<li><a href="https://cleanmymac.com/" target="_blank" rel="external">CleanMyMac 3</a>付费购买</li>
<li><a href="https://contexts.co/" target="_blank" rel="external">Contexts 3</a>花钱购买的</li>
</ul>
<h2 id="有思想的读物"><a href="#有思想的读物" class="headerlink" title="有思想的读物"></a>有思想的读物</h2><ul>
<li><a href="https://mp.weixin.qq.com/s/bbbsbxHoryLtTfEwulzUJg" target="_blank" rel="external">普通程序员能实现财务自由吗？</a></li>
<li><a href="https://mp.weixin.qq.com/s/AJSbHg1o7iYXy21TB1k48w" target="_blank" rel="external">罗永浩-酷玩实验室</a></li>
</ul>
<h3 id="终极搜寻"><a href="#终极搜寻" class="headerlink" title="终极搜寻"></a>终极搜寻</h3><ul>
<li><a href="https://www.waitsun.com/" target="_blank" rel="external">爱情守望者</a></li>
<li><a href="http://www.ifanr.com/" target="_blank" rel="external">爱范儿</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;接触Mac&quot;&gt;&lt;a href=&quot;#接触Mac&quot; class=&quot;headerlink&quot; title=&quot;接触Mac&quot;&gt;&lt;/a&gt;接触Mac&lt;/h1&gt;&lt;p&gt;我是2016年底买的Mac，原因是在那时候通读了《MacTalk 跨越边界》、《MacTalk 人生元编程》这两本书，顿觉打开了一扇大门。随即宣告了我的联想Y570正式退役。&lt;br&gt;现如今Mac上的开发利器、效率工具也装了不少，也该是从资料库整理一下的时机了。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Mac" scheme="//zeroto.tech/tags/Mac/"/>
    
  </entry>
  
  <entry>
    <title>区块链与比特币破冰</title>
    <link href="//zeroto.tech/2018/01/23/%E5%8C%BA%E5%9D%97%E9%93%BE%E4%B8%8E%E6%AF%94%E7%89%B9%E5%B8%81%E7%A0%B4%E5%86%B0/"/>
    <id>//zeroto.tech/2018/01/23/区块链与比特币破冰/</id>
    <published>2018-01-23T02:57:30.000Z</published>
    <updated>2018-03-12T03:42:03.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="大咖说"><a href="#大咖说" class="headerlink" title="大咖说"></a>大咖说</h1><p>池大大在<a href="https://goo.gl/a9KaZQ" target="_blank" rel="external">2018 年技术趋势预测</a>中写道：</p>
<blockquote>
<p>区块链是可以改变世界的发明。区块链源起比特币，但并不局限在币圈。区块链技术是储存、验证和数据保护等问题的实际解决办法。区块链可被视为分散的、极度安全的数据库。更专业一点来说，区块链是分布式的点对点的基于密码学的共享账本，可以在金融服务、保险、医疗、政府等领域内被广泛应用。2018年应该是区块链技术起飞并日趋成熟的一年。</p>
</blockquote>
<a id="more"></a>
<p>2018 年技术趋势预测 由于是在池建强 MacTalk 公众号上发布的文章，网址链接较长，这里用了<a href="https://goo.gl" target="_blank" rel="external">https://goo.gl</a> 做了short URL。<br>如果不能翻墙的话，还请前往微信阅读。</p>
<h2 id="疑惑不解"><a href="#疑惑不解" class="headerlink" title="疑惑不解"></a>疑惑不解</h2><p>面对比特币的疯涨诱惑，很多人按捺不住躁动：“虽然我买不起比特币，那还可以入手其它币吗？”</p>
<p>自从有人，就有投机的存在。但是人类历史上第一次有记载的大规模的投机事件是17世纪荷兰的郁金香泡沫。区块链存在泡沫吗？</p>
<p>还有 keso 描述的 <a href="https://mp.weixin.qq.com/s/seJEc29qyvfeodmLsfHDLQ" target="_blank" rel="external">区块链焦虑与错失恐惧症</a>。</p>
<p>好多问题都需要我们自己来判断、决定，前提是我们需要学习、多了解一些，不管从大势上面还是技术层面上！尽力避免成为吃瓜群众，“山寨币”的韭菜。</p>
<h2 id="了个究竟"><a href="#了个究竟" class="headerlink" title="了个究竟"></a>了个究竟</h2><p>一个浪头打过来，最好的办法是迎上去了解个究竟，而不是漠视，或者干脆当事情没有发生。</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI1ODIyMjAwMA==&amp;mid=2247484648&amp;idx=1&amp;sn=410c8c4769787916da418c7a6e64297a&amp;scene=21#wechat_redirect" target="_blank" rel="external">区块链有多火？</a> </li>
<li><a href="https://mp.weixin.qq.com/s/seJEc29qyvfeodmLsfHDLQ" target="_blank" rel="external">区块链焦虑与错失恐惧症</a></li>
<li><a href="https://mp.weixin.qq.com/s/Ck_ObFrlMmk3A_Sww9Hc7A" target="_blank" rel="external">再不懂区块链，你就OUT了！</a></li>
<li><a href="https://mp.weixin.qq.com/s/mv8EAny18zOI2gNlOHEIbQ" target="_blank" rel="external">比特币是如何被一群“囚犯”创造出来的</a></li>
<li><a href="https://mp.weixin.qq.com/s/v8HMMiWQuo36f0u_Id-79A" target="_blank" rel="external">九分钟了解区块链</a></li>
<li><a href="https://mp.weixin.qq.com/s/ucK4FIWiYlo8cgegW33TXQ" target="_blank" rel="external">迅雷出局：想靠“山寨币”致富的人，是时候醒来搬砖了</a></li>
<li><a href="https://mp.weixin.qq.com/s/_3QLtKxVLOwvzjlSprGKVQ" target="_blank" rel="external">不要试图挑战人性</a></li>
<li><a href="https://mp.weixin.qq.com/s/TvvRJPvAu_rSqmtYnkKAxQ" target="_blank" rel="external">一个足以颠覆微信、超越阿里的超级风口！40万亿大产业即将爆发！</a></li>
<li><a href="https://mp.weixin.qq.com/s/hDje9GjkZSRrG0IQFJf0kQ" target="_blank" rel="external">中国比特币矿机垄断全球：最被忽视的制造业样本</a></li>
<li><a href="https://mp.weixin.qq.com/s/qV9FaPdViRGkECTvPVkByA" target="_blank" rel="external">比特币和区块链(0)：骗局还是改变命运的科技</a></li>
<li><a href="https://mp.weixin.qq.com/s/2CIh42Kd_vuYQpjYtb0pdw" target="_blank" rel="external">比特币和区块链(1)：真钱，电子货币以及区块链</a></li>
<li><a href="https://mp.weixin.qq.com/s/fKlp5G5dBIX5YE56kgvDYw" target="_blank" rel="external">比特币和区块链(2)：比特币中区块链的实现</a></li>
<li><a href="https://mp.weixin.qq.com/s/UOFvMNm0PaocIVKfHPheYA" target="_blank" rel="external">比特币和区块链(3)：比特币的共识机制</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI5OTM3MjMyNA==&amp;mid=2247484741&amp;idx=1&amp;sn=359815c5810b765573787eef7554098c&amp;chksm=ec96df0edbe15618953a1965750c1a2f005ccb22e7fe8d131eea5864ff7395a8166b90152f52&amp;scene=38#wechat_redirect" target="_blank" rel="external">比特币和区块链(4)：比特币成功的不可复制性</a></li>
</ul>
<p><strong>2018-01-25</strong></p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/N-W254NYs5M3x6XqomChAA" target="_blank" rel="external">我做比特币矿工这一年。</a></li>
</ul>
<p><strong>2018-02-02</strong></p>
<ul>
<li><a href="https://yq.aliyun.com/roundtable/64570?spm=a2c4e.11157919.spm-bestcontent.8.618eebf09PefFs" target="_blank" rel="external">互联网大佬谈区块链，看法爱憎分明</a></li>
<li><a href="https://mp.weixin.qq.com/s/8AtpRrFTljr1F46DUJ0m6w" target="_blank" rel="external">“币圈”暴富指南：致不愿醒来的韭菜们</a></li>
</ul>
<p><strong>2018-02-24</strong></p>
<ul>
<li><a href="http://www.huoxing24.com/#/newsdetail/2018022215253260956/4?tags=区块链,三点钟" target="_blank" rel="external">春节假期“三点钟”社群大佬激辩区块链2万字干货全记录，看这一篇足够了！</a></li>
</ul>
<p><strong>2018-03-02</strong></p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/-NYfLg-TR5MLboDaMvGoTg" target="_blank" rel="external">区块链性能提升：链上设计之道</a></li>
<li><a href="https://mp.weixin.qq.com/s/2fQif5HQHHZlN68alIfyBg" target="_blank" rel="external">韭菜席地而坐</a></li>
<li><a href="https://mp.weixin.qq.com/s/6Rj6BQLeGhC6iodszAthYQ" target="_blank" rel="external">2018年区块链落地的现状、阻碍与机遇 |捕手志</a></li>
<li><a href="https://mp.weixin.qq.com/s/SU3q2uMuuTWae7CDRGOkDA" target="_blank" rel="external">专访陈伟星：解密加密数字经济为何是未来 |捕手志</a></li>
<li><a href="https://mp.weixin.qq.com/s/qOQCMh4C2BmZsVExikl9FA" target="_blank" rel="external">周鸿祎：写区块链最好的一篇文章</a></li>
<li><a href="https://www.iyiou.com/p/66758?share_from=cb1f36a_M5U7ZZtZVA5x-tJy8Z4f1hU_qv5CjYKJtJiECv137ev_8zXmIQDW0ednSXt2RSfYQBZSBq9cRCrerJXqWF1ASxEMy-01iCIUUMrttysHA&amp;from=timeline" target="_blank" rel="external">黄渊普：关于区块链，那些骗子都知道自己是骗子</a></li>
</ul>
<p><strong>2018-03-06</strong></p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/Y_DxSPyMnJWDQD6S0S1NYw" target="_blank" rel="external">ICO裹挟区块链强势重来</a></li>
<li><a href="https://mp.weixin.qq.com/s/7F2-eLqIdSiNIHHJDzkwcg" target="_blank" rel="external">深入研究的套路之黑客与区块链</a></li>
<li><a href="https://mp.weixin.qq.com/s/TbtpnHiZS8v1R_Udpun0xA" target="_blank" rel="external">5天钓到40枚以太币</a></li>
<li><a href="https://mp.weixin.qq.com/s/d_4gUc3Ay_He4fintNXw6Q" target="_blank" rel="external">杂谈区块链生态里的前端黑</a></li>
<li><a href="https://mp.weixin.qq.com/s/XK78b-qoPu5cu7rCPKXdEA" target="_blank" rel="external">区块链的十个吐槽</a></li>
</ul>
<h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p>2016年在接受《财经》杂志专访时，张一鸣说过的那段特别具有张一鸣色彩的话：</p>
<blockquote>
<p>历史上精英们一直在试图让大众拥有很高的精神追求，但社会整体从来没有达到过这个目标。以前的媒体精英意识不到这一点，他们认为自己特别希望导向的才是特别重要的。但多数人的强烈主张，从历史上看，多数都没有产生多大价值。</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;大咖说&quot;&gt;&lt;a href=&quot;#大咖说&quot; class=&quot;headerlink&quot; title=&quot;大咖说&quot;&gt;&lt;/a&gt;大咖说&lt;/h1&gt;&lt;p&gt;池大大在&lt;a href=&quot;https://goo.gl/a9KaZQ&quot;&gt;2018 年技术趋势预测&lt;/a&gt;中写道：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;区块链是可以改变世界的发明。区块链源起比特币，但并不局限在币圈。区块链技术是储存、验证和数据保护等问题的实际解决办法。区块链可被视为分散的、极度安全的数据库。更专业一点来说，区块链是分布式的点对点的基于密码学的共享账本，可以在金融服务、保险、医疗、政府等领域内被广泛应用。2018年应该是区块链技术起飞并日趋成熟的一年。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="区块链" scheme="//zeroto.tech/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
      <category term="比特币" scheme="//zeroto.tech/tags/%E6%AF%94%E7%89%B9%E5%B8%81/"/>
    
  </entry>
  
  <entry>
    <title>如何搭建个人网站</title>
    <link href="//zeroto.tech/2018/01/05/%E5%A6%82%E4%BD%95%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E7%BD%91%E7%AB%99/"/>
    <id>//zeroto.tech/2018/01/05/如何搭建个人网站/</id>
    <published>2018-01-05T06:57:16.000Z</published>
    <updated>2018-06-06T06:09:12.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="写在开头"><a href="#写在开头" class="headerlink" title="写在开头"></a>写在开头</h1><p>有了个人网站，可能就又多了一些学(zhuang)习(bi)的动力吧！<br>所以，拥有自己的网站，算是迈出了第一步！</p>
<p>好可惜最近才看到玉刚大神的文章，意识觉醒的晚了<a href="http://blog.csdn.net/singwhatiwanna/article/details/19174597" target="_blank" rel="external">树立个人品牌：让名企hr们主动来找你</a></p>
<a id="more"></a>
<h2 id="如何拥有自己的专属域名"><a href="#如何拥有自己的专属域名" class="headerlink" title="如何拥有自己的专属域名"></a>如何拥有自己的专属域名</h2><p>goileolee <a href="http://goileo.top/如何免费且快速的搭建个人网站" target="_blank" rel="external">http://goileo.top/如何免费且快速的搭建个人网站</a></p>
<h2 id="为-Github-Pages-绑定的自定义域名启用-HTTPS-协议"><a href="#为-Github-Pages-绑定的自定义域名启用-HTTPS-协议" class="headerlink" title="为 Github Pages 绑定的自定义域名启用 HTTPS 协议"></a>为 Github Pages 绑定的自定义域名启用 HTTPS 协议</h2><p><a href="https://zhouhao.me/2017/07/21/using-https-with-custom-domain-name-on-github-pages/" target="_blank" rel="external">https://zhouhao.me/2017/07/21/using-https-with-custom-domain-name-on-github-pages/</a></p>
<h2 id="hexo-yilia主题添加文章访问量统计"><a href="#hexo-yilia主题添加文章访问量统计" class="headerlink" title="hexo yilia主题添加文章访问量统计"></a>hexo yilia主题添加文章访问量统计</h2><p><a href="https://www.lookk.cn/2017/12/09/hexo-yilia主题添加文章访问量统计/" target="_blank" rel="external">https://www.lookk.cn/2017/12/09/hexo-yilia主题添加文章访问量统计/</a></p>
<h1 id="原因在结尾"><a href="#原因在结尾" class="headerlink" title="原因在结尾"></a>原因在结尾</h1><p><strong>在浏览器和访问的网站之间提供更安全的通讯</strong><br><strong>HTTPS 比 HTTP 的速度更快</strong><br><strong>能提高搜索引擎的优化排名</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;写在开头&quot;&gt;&lt;a href=&quot;#写在开头&quot; class=&quot;headerlink&quot; title=&quot;写在开头&quot;&gt;&lt;/a&gt;写在开头&lt;/h1&gt;&lt;p&gt;有了个人网站，可能就又多了一些学(zhuang)习(bi)的动力吧！&lt;br&gt;所以，拥有自己的网站，算是迈出了第一步！&lt;/p&gt;
&lt;p&gt;好可惜最近才看到玉刚大神的文章，意识觉醒的晚了&lt;a href=&quot;http://blog.csdn.net/singwhatiwanna/article/details/19174597&quot;&gt;树立个人品牌：让名企hr们主动来找你&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="阿里云域名注册" scheme="//zeroto.tech/tags/%E9%98%BF%E9%87%8C%E4%BA%91%E5%9F%9F%E5%90%8D%E6%B3%A8%E5%86%8C/"/>
    
      <category term="CloudFlare" scheme="//zeroto.tech/tags/CloudFlare/"/>
    
      <category term="HTTPS" scheme="//zeroto.tech/tags/HTTPS/"/>
    
  </entry>
  
  <entry>
    <title>初探Visual Studio Code编写Vue</title>
    <link href="//zeroto.tech/2017/12/28/Visual%20Studio%20Code/"/>
    <id>//zeroto.tech/2017/12/28/Visual Studio Code/</id>
    <published>2017-12-28T08:12:15.000Z</published>
    <updated>2018-03-12T03:42:11.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="应用介绍"><a href="#应用介绍" class="headerlink" title="应用介绍"></a>应用介绍</h1><p><a href="https://code.visualstudio.com/" target="_blank" rel="external">https://code.visualstudio.com/</a><br>界面简洁大方，^_^</p>
<a id="more"></a>
<h1 id="Vue插件安装"><a href="#Vue插件安装" class="headerlink" title="Vue插件安装"></a>Vue插件安装</h1><p>在 VSCode Marketplace <a href="https://marketplace.visualstudio.com/vscode" target="_blank" rel="external">https://marketplace.visualstudio.com/vscode</a> 搜素Vue 出现关于语法高亮的插件有 Vue 2 Snippets，vue-beautify，vue-color，Vetur等等。花花绿绿的，往下翻看，目前使用率最高的就是Vetur了。<br>安装插件：⌘P 然后输入 ext install vetur 然后回车点安装即可。<br>但是如果你使用惯了Vim/Sublime/Atom等，VSCode允许安装自己的键盘快捷方式。<br><img src="VSCode-Sublime.png" alt="VSCode-Sublime"><br>我个人选择了Sublime，设置后并激活，这时按下<code>command+shift+p</code><br><img src="VSCode-Ext.png" alt="VSCode-Ext"><br>输入 Vetur<br><img src="VSCode-Vetur.png" alt="VSCode-Vetur"></p>
<h2 id="VS-Code-ESLint-extension"><a href="#VS-Code-ESLint-extension" class="headerlink" title="VS Code ESLint extension"></a>VS Code ESLint extension</h2><h3 id="安装插件和Vetur类似。"><a href="#安装插件和Vetur类似。" class="headerlink" title="安装插件和Vetur类似。"></a>安装插件和Vetur类似。</h3><p>ESLint 不是安装后就可以用的，还需要一些环境和配置：<br>eg：首先在自己的工作空间建立一个文件夹xmall-front，zsh中运行 <code>npm init</code><br>然后依次执行命令，快速体验下：</p>
<pre><code class="bash">
~/VSCodeProjects/xmall-front npm install --save-dev eslint eslint-plugin-html
npm notice created a lockfile as package-lock.json. You should commit this file.
npm WARN xmall-front@1.0.0 No repository field.

+ eslint-plugin-html@4.0.1
+ eslint@4.14.0
added 146 packages in 14.54s
~/VSCodeProjects/xmall-front ./node_modules/.bin/eslint --init
? How would you like to configure ESLint? Answer questions about your style
? Are you using ECMAScript 6 features? Yes
? Are you using ES6 modules? Yes
? Where will your code run? Browser
? Do you use CommonJS? Yes
? Do you use JSX? Yes
? Do you use React? No
? What style of indentation do you use? Tabs
? What quotes do you use for strings? Single
? What line endings do you use? Unix
? Do you require semicolons? No
? What format do you want your config file to be in? JavaScript
Successfully created .eslintrc.js file in /Users/jinkui/VSCodeProjects/xmall-front
~/VSCodeProjects/xmall-front la
.                 ..                .eslintrc.js      node_modules      package-lock.json package.json
</code></pre>
<h3 id="在-vscode-中配置下-ESLint："><a href="#在-vscode-中配置下-ESLint：" class="headerlink" title="在 vscode 中配置下 ESLint："></a>在 vscode 中配置下 ESLint：</h3><p>eslint.validate - an array of language identifiers specify the files to be validated. Something like “eslint.validate”: [ “javascript”, “javascriptreact”, “html” ]. If the setting is missing, it defaults to [“javascript”, “javascriptreact”].<br>查看扩展：ESLint 的Settings Options，发现确实默认不支持vue文件啊。<br>所以说虽然安装了eslint-plugin-html还是需要配置一下的：On a Mac, click Code &gt; Preferences &gt; Settings</p>
<pre><code class="json">
// An array of language ids which should be validated by ESLint
    &quot;eslint.validate&quot;: [
        &quot;javascript&quot;,
        &quot;javascriptreact&quot;,
        {
            &quot;language&quot;: &quot;html&quot;,
            &quot;autoFix&quot;: true
        },
        &quot;vue&quot;
    ]
</code></pre>
<h2 id="安装插件-提高效率"><a href="#安装插件-提高效率" class="headerlink" title="安装插件-提高效率"></a>安装插件-提高效率</h2><p>所有插件都类似于Sublime使用Package Control安装，按下快捷键<code>⌘⇧P</code>，在命令提示框搜索插件即可。</p>
<ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=alefragnani.project-manager" target="_blank" rel="external">Project Manager</a> 在多个项目之前快速切换的工具</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=abusaidm.html-snippets" target="_blank" rel="external">HTML Snippets</a> Full HTML tags including HTML5 Snippets</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=ecmel.vscode-html-css" target="_blank" rel="external">HTML CSS Support</a> 让 html 标签上写class 智能提示当前项目所支持的样式</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=donjayamanne.jquerysnippets" target="_blank" rel="external">jQuery Code Snippets</a> Over 130 jQuery Code Snippets</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=HookyQR.beautify" target="_blank" rel="external">Beautify</a> Beautify code in place for VS Code</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=mikey.vscode-fileheader" target="_blank" rel="external">vscode-fileheader</a> insert header comment,and automatically update the time.</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=CoenraadS.bracket-pair-colorizer" target="_blank" rel="external">Bracket Pair Colorizer</a> 让括号拥有独立的颜色，易于区分。可以配合任意主题使用</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=formulahendry.auto-close-tag" target="_blank" rel="external">Auto Close Tag</a> Automatically add HTML/XML close tag, same as Visual Studio IDE or Sublime Text does</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=formulahendry.auto-rename-tag" target="_blank" rel="external">Auto Rename Tag</a> Auto rename paired HTML/XML tag</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=alefragnani.Bookmarks" target="_blank" rel="external">Bookmarks</a> 添加行书签</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=SirTori.indenticator" target="_blank" rel="external">Indenticator</a> 缩进高亮</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=WallabyJs.quokka-vscode" target="_blank" rel="external">Quokka.js</a> 不需要手动运行，行内显示变量结果</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=xabikos.JavaScriptSnippets" target="_blank" rel="external">JavaScript (ES6) code snippets</a> ES6语法代码段</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=sysoev.language-stylus" target="_blank" rel="external">language-stylus</a> Stylus语法高亮和提示</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=marclipovsky.string-manipulation" target="_blank" rel="external">String Manipulation</a> 字符串转换处理（驼峰、大写开头、下划线等等）</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=oysun.vuehelper" target="_blank" rel="external">VueHelper</a> Vue2代码段（包括Vue2 api、vue-router2、vuex2）</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=abierbaum.vscode-file-peek" target="_blank" rel="external">File Peek</a> The extension supports all the normal capabilities of symbol definition tracking, but does it for file names</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=christian-kohler.path-intellisense" target="_blank" rel="external">Path Intellisense</a> Visual Studio Code plugin that autocompletes filenames</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=minhthai.vscode-todo-parser" target="_blank" rel="external">TODO Parser</a> Parse TODOs in your working files</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=donjayamanne.githistory" target="_blank" rel="external">Git History (git log)</a> View git log, file or line History</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=eamodio.gitlens" target="_blank" rel="external">Git Lens</a> 显示文件最近的commit和作者，显示当前行commit信息</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=huizhou.githd" target="_blank" rel="external">Git History Diff</a> View git history. View commit details. View diff of committed files. Multi-root workspaces supported.</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=codezombiech.gitignore" target="_blank" rel="external">gitignore</a> .gitignore文件语法</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=fknop.vscode-npm" target="_blank" rel="external">npm</a> npm commands for VSCode</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=christian-kohler.npm-intellisense" target="_blank" rel="external">npm Intellisense</a> 导入模块时，提示已安装模块名称</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=IBM.output-colorizer" target="_blank" rel="external">Output Colorizer</a> 彩色输出信息</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=DavidAnson.vscode-markdownlint" target="_blank" rel="external">markdownlint</a> Markdown linting and style checking for Visual Studio Code</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=robertohuertasm.vscode-icons" target="_blank" rel="external">vscode-icons</a> Icons for Visual Studio Code(大大的好啊)</li>
</ul>
<h2 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h2><p>见官网。<a href="https://code.visualstudio.com/shortcuts/keyboard-shortcuts-macos.pdf" target="_blank" rel="external">https://code.visualstudio.com/shortcuts/keyboard-shortcuts-macos.pdf</a></p>
<h3 id="修改默认快捷键"><a href="#修改默认快捷键" class="headerlink" title="修改默认快捷键"></a>修改默认快捷键</h3><p>打开默认键盘快捷方式设置：</p>
<p>修改 keybindings.json：</p>
<pre><code class="json">
// 将键绑定放入此文件中以覆盖默认值
[
  // &#39;删除一行&#39;
  {
    &quot;key&quot;: &quot;cmd+d&quot;,
    &quot;command&quot;: &quot;editor.action.deleteLines&quot;,
    &quot;when&quot;: &quot;editorTextFocus &amp;&amp; !editorReadonly&quot;
  },
  // 与&#39;删除一行&#39;的快捷键互换
  {
    &quot;key&quot;: &quot;shift+cmd+k&quot;,
    &quot;command&quot;: &quot;editor.action.addSelectionToNextFindMatch&quot;,
    &quot;when&quot;: &quot;editorFocus&quot;
  },
  // 大小写转换快捷键，需安装 TextTransform 插件
  {
    &quot;key&quot;: &quot;cmd+shift+y&quot;,
    &quot;command&quot;: &quot;editor.action.transformToUppercase&quot;,
    &quot;when&quot;: &quot;editorTextFocus&quot;
  },
  {
    &quot;key&quot;: &quot;cmd+shift+x&quot;,
    &quot;command&quot;: &quot;editor.action.transformtolowercase&quot;,
    &quot;when&quot;: &quot;editorTextFocus&quot;
  }
]
</code></pre>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>开启一波Vue学习潮，干后端的也不能落伍啊</p>
<p>参考在此：<br><a href="https://cloud.tencent.com/community/article/983896" target="_blank" rel="external">使用Visual Studio Code编写Vue的札记</a><br><a href="http://www.silianpan.club/2017/05/18/tool1/" target="_blank" rel="external">vs code &amp; Atom 对比使用心得</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;应用介绍&quot;&gt;&lt;a href=&quot;#应用介绍&quot; class=&quot;headerlink&quot; title=&quot;应用介绍&quot;&gt;&lt;/a&gt;应用介绍&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://code.visualstudio.com/&quot;&gt;https://code.visualstudio.com/&lt;/a&gt;&lt;br&gt;界面简洁大方，^_^&lt;/p&gt;
    
    </summary>
    
    
      <category term="Visual Studio Code" scheme="//zeroto.tech/tags/Visual-Studio-Code/"/>
    
      <category term="Vue" scheme="//zeroto.tech/tags/Vue/"/>
    
  </entry>
  
  <entry>
    <title>Mac下之Sublime Text的好用之处</title>
    <link href="//zeroto.tech/2017/12/27/Sublime%20Text/"/>
    <id>//zeroto.tech/2017/12/27/Sublime Text/</id>
    <published>2017-12-27T06:01:44.000Z</published>
    <updated>2018-03-12T03:42:22.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="应用介绍"><a href="#应用介绍" class="headerlink" title="应用介绍"></a>应用介绍</h1><p>Sublime Text 拥有漂亮的用户界面和非凡的功能，而根据其官网介绍，Sublime Text的特点如下：拥有高效、没有干扰的界面，在编辑方面的多选、宏、代码片段等功能，以及很有特色的Minimap。<br>用户广受喜爱的众多功能之一GOTO ANYTHING<br>仅仅敲击几次键盘就能即刻jump to symbols, lines or words.<strong>Shortcuts:</strong>  <code>⌘ + P</code></p>
<a id="more"></a>
<p>要支持一把的官网购买啊<a href="http://www.sublimetext.com/" target="_blank" rel="external">http://www.sublimetext.com/</a>啊不花钱看这里：<a href="http://xclient.info/s/sublime-text.html?_=854c5c4c70359873adbd147e3e8c9cf3" target="_blank" rel="external">Sublime Text 3 Build 3156</a></p>
<h1 id="主题插件安装"><a href="#主题插件安装" class="headerlink" title="主题插件安装"></a>主题插件安装</h1><p><a href="http://buymeasoda.github.io/soda-theme/" target="_blank" rel="external">soda-theme</a>该插件主要能够使sublime 兼容mac的retina屏幕<br>我采用Git安装最新版本，可以通过菜单 Preferences -&gt; Browse Packages….，定位到你的Sublime Text Packages文件夹，然后在这个文件夹下面 git clone就OK了。</p>
<pre><code class="git">git clone https://github.com/buymeasoda/soda-theme/ &quot;Theme - Soda&quot;
</code></pre>
<p><strong> Configure Sublime Text 3 </strong></p>
<ul>
<li>打开配置文件： Sublime Text -&gt; Preferences -&gt; Settings - User</li>
<li>添加主题：”theme”: “Soda Light 3.sublime-theme”</li>
</ul>
<p>我自己的主题和字体配置：<br><img src="Sublime Text-color_scheme.png" alt="Sublime Text-color_scheme"></p>
<h1 id="插件与配置"><a href="#插件与配置" class="headerlink" title="插件与配置"></a>插件与配置</h1><h2 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h2><p>所有插件都可以使用Package Control安装，按下快捷键<code>⌘⇧P</code>，在命令提示框搜索插件即可。<br><a href="https://github.com/zhiqiang21/blog/issues/10" target="_blank" rel="external">前端开发 sublime text 常用插件和配置</a></p>
<h2 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h2><table>
<thead>
<tr>
<th>符号</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>⌘</td>
<td>command</td>
</tr>
<tr>
<td>⌃</td>
<td>control</td>
</tr>
<tr>
<td>⌥</td>
<td>option</td>
</tr>
<tr>
<td>⇧</td>
<td>shift</td>
</tr>
<tr>
<td>↩</td>
<td>enter</td>
</tr>
<tr>
<td> ⌫</td>
<td>delete</td>
</tr>
</tbody>
</table>
<p><strong>Shortcuts:</strong>  <code>⌘ + P</code> 即刻jump to symbols, lines or words.</p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>@</code></td>
<td>jump to symbols</td>
</tr>
<tr>
<td><code>#</code></td>
<td>查找文件内的单词</td>
</tr>
<tr>
<td><code>:</code></td>
<td>跳到行号处</td>
</tr>
</tbody>
</table>
<p>Preferences -&gt; Key Bindings,在-User文件里自定义快捷键（会覆盖相应的-Default配置）</p>
<h3 id="打开-关闭-前往"><a href="#打开-关闭-前往" class="headerlink" title="打开/关闭/前往"></a>打开/关闭/前往</h3><table>
<thead>
<tr>
<th>快捷键</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>⌘⇧N</td>
<td>打开一个新的sublime窗口</td>
</tr>
<tr>
<td>⌘N</td>
<td>新建文件</td>
</tr>
<tr>
<td>⌘⇧W</td>
<td>关闭sublime，关闭所有文件</td>
</tr>
<tr>
<td>⌘W</td>
<td>关闭当前文件</td>
</tr>
<tr>
<td>⌘P</td>
<td>GOTO ANYTHING</td>
</tr>
<tr>
<td>⌘⇧T</td>
<td>重新打开最近关闭的文件</td>
</tr>
<tr>
<td>⌘T</td>
<td>前往文件</td>
</tr>
<tr>
<td>⌘R</td>
<td>前往method</td>
</tr>
<tr>
<td>⌘⇧P</td>
<td>命令提示</td>
</tr>
<tr>
<td>⌃`</td>
<td>打开控制台</td>
</tr>
</tbody>
</table>
<h3 id="编辑"><a href="#编辑" class="headerlink" title="编辑"></a>编辑</h3><table>
<thead>
<tr>
<th>快捷键</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>⌘KK</td>
<td>从光标处删除至行尾</td>
</tr>
<tr>
<td>⌘⌫</td>
<td>从光标处删除至行首</td>
</tr>
<tr>
<td>⌘KV</td>
<td>paste_from_history</td>
</tr>
<tr>
<td>⌘L</td>
<td>Select line - Repeat to select next lines</td>
</tr>
<tr>
<td>⌘D</td>
<td>删除行(⌃⇧K)</td>
</tr>
<tr>
<td>⌘E</td>
<td>选择词（重复按下时多重选择相同的词进行多重编辑）(⌘D)</td>
</tr>
<tr>
<td>⌘J</td>
<td>选择行（重复按下将下一行加入选择）</td>
</tr>
<tr>
<td>⌘JL</td>
<td>Join line below to the end of the current line（⌘J）</td>
</tr>
<tr>
<td>⌃ + ⇧ + M</td>
<td>Select all contents of the current parentheses</td>
</tr>
<tr>
<td>⌃ + M</td>
<td>Jump to closing parentheses Repeat to jump to opening parentheses</td>
</tr>
<tr>
<td>⌘⇧↩</td>
<td>在当前行前插入新行</td>
</tr>
<tr>
<td>⌘↩</td>
<td>在当前行后插入新行</td>
</tr>
<tr>
<td>⌘+shift+y</td>
<td>改为大写（⌘KU）</td>
</tr>
<tr>
<td>⌘+shift+x</td>
<td>改为小写（⌘KL）</td>
</tr>
<tr>
<td>⌘C</td>
<td>复制</td>
</tr>
<tr>
<td>⌘X</td>
<td>剪切</td>
</tr>
<tr>
<td>⌘V</td>
<td>粘贴</td>
</tr>
<tr>
<td>⌘Z</td>
<td>撤销</td>
</tr>
<tr>
<td>⌘+shift+z</td>
<td>恢复撤销</td>
</tr>
<tr>
<td>⌘y</td>
<td>重做</td>
</tr>
<tr>
<td>⌘u</td>
<td>soft_undo</td>
</tr>
<tr>
<td>⌘⇧u</td>
<td>soft_redo</td>
</tr>
<tr>
<td>⌘/</td>
<td>注释</td>
</tr>
<tr>
<td>⌘]</td>
<td>向右缩进</td>
</tr>
<tr>
<td>⌘[</td>
<td>向左缩进</td>
</tr>
<tr>
<td>⌃ + ⇧ + ↑</td>
<td>一个或多行向上移动</td>
</tr>
<tr>
<td>⌃ + ⇧ + ↓</td>
<td>一个或多行向下移动</td>
</tr>
</tbody>
</table>
<h3 id="打开-关闭-前往-1"><a href="#打开-关闭-前往-1" class="headerlink" title="打开/关闭/前往"></a>打开/关闭/前往</h3><table>
<thead>
<tr>
<th>快捷键</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>⌘f</td>
<td>查找</td>
</tr>
<tr>
<td>⌘⌥f</td>
<td>查找并替换</td>
</tr>
<tr>
<td>⌘⌥g</td>
<td>查找下一个符合当前所选的内容</td>
</tr>
<tr>
<td>⌘⌃g</td>
<td>查找所有符合当前选择的内容进行多重编辑</td>
</tr>
<tr>
<td>⌘⇧F</td>
<td>在所有打开的文件中进行查找</td>
</tr>
<tr>
<td>⌘ + I</td>
<td>Incremental Find</td>
</tr>
</tbody>
</table>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>Preferences -&gt; Key Bindings,在-User文件里自定义快捷键：</p>
<pre><code class="json">
[
    { &quot;keys&quot;: [&quot;super+shift+y&quot;], &quot;command&quot;: &quot;upper_case&quot; },
    { &quot;keys&quot;: [&quot;super+shift+x&quot;], &quot;command&quot;: &quot;lower_case&quot; },
    { &quot;keys&quot;: [&quot;super+j&quot;], &quot;command&quot;: &quot;expand_selection&quot;, &quot;args&quot;: {&quot;to&quot;: &quot;line&quot;} },
    { &quot;keys&quot;: [&quot;super+j+l&quot;], &quot;command&quot;: &quot;join_lines&quot; },
    { &quot;keys&quot;: [&quot;super+e+s+f+s&quot;], &quot;command&quot;: &quot;slurp_find_string&quot; },
    { &quot;keys&quot;: [&quot;super+e&quot;], &quot;command&quot;: &quot;find_under_expand&quot; },
    { &quot;keys&quot;: [&quot;super+d&quot;], &quot;command&quot;: &quot;run_macro_file&quot;, &quot;args&quot;: {&quot;file&quot;: &quot;res://Packages/Default/Delete Line.sublime-macro&quot;} }
]
</code></pre>
<p>参考在此：<a href="http://docs.sublimetext.info/en/latest/reference/keyboard_shortcuts_osx.html" target="_blank" rel="external">Keyboard Shortcuts - OSX</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;应用介绍&quot;&gt;&lt;a href=&quot;#应用介绍&quot; class=&quot;headerlink&quot; title=&quot;应用介绍&quot;&gt;&lt;/a&gt;应用介绍&lt;/h1&gt;&lt;p&gt;Sublime Text 拥有漂亮的用户界面和非凡的功能，而根据其官网介绍，Sublime Text的特点如下：拥有高效、没有干扰的界面，在编辑方面的多选、宏、代码片段等功能，以及很有特色的Minimap。&lt;br&gt;用户广受喜爱的众多功能之一GOTO ANYTHING&lt;br&gt;仅仅敲击几次键盘就能即刻jump to symbols, lines or words.&lt;strong&gt;Shortcuts:&lt;/strong&gt;  &lt;code&gt;⌘ + P&lt;/code&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Sublime Text" scheme="//zeroto.tech/tags/Sublime-Text/"/>
    
  </entry>
  
  <entry>
    <title>一张通往计算机世界的地图</title>
    <link href="//zeroto.tech/2017/12/19/%E4%B8%80%E5%BC%A0%E9%80%9A%E5%BE%80%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B8%96%E7%95%8C%E7%9A%84%E5%9C%B0%E5%9B%BE/"/>
    <id>//zeroto.tech/2017/12/19/一张通往计算机世界的地图/</id>
    <published>2017-12-19T05:25:09.000Z</published>
    <updated>2018-03-12T03:42:26.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一张通往计算机世界的地图"><a href="#一张通往计算机世界的地图" class="headerlink" title="一张通往计算机世界的地图"></a>一张通往计算机世界的地图</h1><h2 id="引述"><a href="#引述" class="headerlink" title="引述"></a>引述</h2><p>我们通过计算机来拓展我们自己的大脑。最开始计算机被用来解决和算数有关的问题，但其自身的价值很快地延伸到了各个领域。 像是运行互联网络，处理实时图像，制造人工智能，以及模拟整个宇宙等等。 而其神奇的地方就在于这一切强大功能的背后，竟然仅是 0 和 1 的来回变化。</p>
<a id="more"></a>
<h2 id="原文"><a href="#原文" class="headerlink" title="原文"></a>原文</h2><p>作者：Surmon <a href="https://surmon.me/article/75" target="_blank" rel="external">https://surmon.me/article/75</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;一张通往计算机世界的地图&quot;&gt;&lt;a href=&quot;#一张通往计算机世界的地图&quot; class=&quot;headerlink&quot; title=&quot;一张通往计算机世界的地图&quot;&gt;&lt;/a&gt;一张通往计算机世界的地图&lt;/h1&gt;&lt;h2 id=&quot;引述&quot;&gt;&lt;a href=&quot;#引述&quot; class=&quot;headerlink&quot; title=&quot;引述&quot;&gt;&lt;/a&gt;引述&lt;/h2&gt;&lt;p&gt;我们通过计算机来拓展我们自己的大脑。最开始计算机被用来解决和算数有关的问题，但其自身的价值很快地延伸到了各个领域。 像是运行互联网络，处理实时图像，制造人工智能，以及模拟整个宇宙等等。 而其神奇的地方就在于这一切强大功能的背后，竟然仅是 0 和 1 的来回变化。&lt;/p&gt;
    
    </summary>
    
    
      <category term="计算机" scheme="//zeroto.tech/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
      <category term="网络" scheme="//zeroto.tech/tags/%E7%BD%91%E7%BB%9C/"/>
    
      <category term="Linux" scheme="//zeroto.tech/tags/Linux/"/>
    
      <category term="软件工程" scheme="//zeroto.tech/tags/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>Redis技术交流</title>
    <link href="//zeroto.tech/2017/12/12/redis%E6%8A%80%E6%9C%AF%E4%BA%A4%E6%B5%81/"/>
    <id>//zeroto.tech/2017/12/12/redis技术交流/</id>
    <published>2017-12-12T08:56:14.000Z</published>
    <updated>2018-03-12T03:46:12.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Redis原理与实战，不定期更新"><a href="#Redis原理与实战，不定期更新" class="headerlink" title="Redis原理与实战，不定期更新"></a>Redis原理与实战，不定期更新</h2><p>Redis是业界普遍应用的缓存组件，研究一个组件框架，就要探究它的设计哲学。<br><a href="https://redis.io/" target="_blank" rel="external">https://redis.io/</a></p>
<a id="more"></a>
<p>系列文章有些是从Redis源码，有些是从数据结构、内存优化、持久化、Redis集群实现原理探讨开来。<br>总之，很是流行，有必要多方位了解一下啦。</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/3TU9qxHJyxHJgVDaYXoluA" target="_blank" rel="external">张铁蕾</a> </li>
<li><a href="https://goo.gl/uBKGr1" target="_blank" rel="external">Redis压缩列表原理与应用分析</a></li>
<li><a href="https://goo.gl/vTe1b5" target="_blank" rel="external">深入浅出Redis Cluster原理</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzAxMTEyOTQ5OQ==&amp;mid=402004912&amp;idx=1&amp;sn=7517696a86f54262e60e1b5636d6cbe0&amp;scene=1&amp;srcid=0521HB3pYYfb5rwuUr19GmB5#rd" target="_blank" rel="external">Redis 集群的合纵与连横</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzAwMDU1MTE1OQ==&amp;mid=2653547160&amp;idx=1&amp;sn=befd195e2aa788775aaf1cc3b6f6fab3&amp;scene=1&amp;srcid=051242VSB3OeDvn9GbmJ2QY0#rd" target="_blank" rel="external">360开源的类Redis存储系统:Pika</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MjM5ODQ2MDIyMA==&amp;mid=2650712266&amp;idx=1&amp;sn=54d909d240eb701ae48467dc798ddc7f&amp;scene=1&amp;srcid=0506xZXTUptwNdQOqmeVNjjK#rd" target="_blank" rel="external">动态追踪技术（中） - Dtrace、SystemTap、火焰图</a></li>
<li><a href="https://github.com/QConChina/QConShanghai2016" target="_blank" rel="external">QCon上海2016的幻灯片合集</a></li>
<li><a href="http://ppt.geekbang.org/qconbj2016?amp;amp;isappinstalled=0&amp;amp;amp;isappinstalled=0&amp;amp;from=timeline&amp;amp;isappinstalled=0&amp;from=timeline&amp;isappinstalled=0" target="_blank" rel="external">QCon北京2016幻灯片下载合集</a></li>
<li><a href="http://ppt.geekbang.org/qconsh2017" target="_blank" rel="external">QCon 上海 2017 PPT 合集</a></li>
<li><a href="https://m.aliyun.com/yunqi/articles/58703?from=singlemessage&amp;isappinstalled=1" target="_blank" rel="external">Redis源码学习(云栖社区)</a></li>
<li><a href="http://www.cnblogs.com/wxisme/p/5742456.html" target="_blank" rel="external">基于Redis的BloomFilter算法去重</a></li>
<li><a href="http://bg2bkk.github.io/post/redis过期清除机制及应用方法" target="_blank" rel="external">redis过期清除机制及应用方法</a></li>
<li><a href="http://blog.jobbole.com/107084/" target="_blank" rel="external">由浅入深介绍 Redis LRU 策略的具体实现</a></li>
<li><a href="http://gongfuxiang.com/post-98.html" target="_blank" rel="external">Nginx+Lua+Redis搭建高并发服务</a></li>
<li><a href="https://neway6655.github.io/redis/2016/10/10/redis-hmget-deep-study.html" target="_blank" rel="external">Redis的hmget操作复杂度问题</a></li>
<li><a href="https://goo.gl/H4afYW" target="_blank" rel="external">Redis中BitMap的妙用</a></li>
<li><a href="https://cachecloud.github.io/2017/02/16/Redis内存优化/" target="_blank" rel="external">Redis的内存优化</a></li>
<li><a href="https://goo.gl/g89ZXh" target="_blank" rel="external">理解Redis的RESP协议</a></li>
<li><a href="https://goo.gl/cNCTGW" target="_blank" rel="external">深入学习 Redis：Redis API 的原子性分析</a></li>
<li><a href="https://goo.gl/9fLJ7d" target="_blank" rel="external">Redis 实现接口访问频率限制</a></li>
<li><a href="https://goo.gl/5qFP6L" target="_blank" rel="external">Redis 源码学习之事件驱动</a></li>
<li><a href="https://goo.gl/ztG8TC" target="_blank" rel="external">Redis 通信协议 —— 了解 Redis 客户端实现原理</a></li>
<li><a href="https://goo.gl/4mTRVX" target="_blank" rel="external">有赞延迟队列设计</a></li>
<li><a href="https://yq.aliyun.com/articles/62899?spm=5176.154649.801568.9.UvJFm2" target="_blank" rel="external">Redis内存分析方法</a></li>
<li><a href="https://goo.gl/i5WhU8" target="_blank" rel="external">redis分布式内存锁：余量扣除示例(上)</a></li>
<li><a href="https://goo.gl/iZTeCB" target="_blank" rel="external">redis分布式内存锁：余量扣除示例(下)</a></li>
<li><a href="https://github.com/redisson/redisson/wiki/1.-%E6%A6%82%E8%BF%B0" target="_blank" rel="external">redisson</a></li>
<li><a href="https://www.zybuluo.com/sambodhi/note/642230" target="_blank" rel="external">GitHub将持久数据从Redis迁出</a></li>
<li><a href="https://goo.gl/z1TKdu" target="_blank" rel="external">Redis架构之防雪崩设计：网站不宕机背后的兵法</a></li>
<li><a href="https://goo.gl/m3Bn6V" target="_blank" rel="external">千亿级高性能 KV 存储生态圈</a></li>
<li><a href="https://yq.aliyun.com/articles/68350" target="_blank" rel="external">Redis内核基于时间点的备份恢复和基于AOF日志的增量同步机制设计</a></li>
<li><a href="https://pingcap.com/blog-cn/ga-liuqi/" target="_blank" rel="external">TiDB技术内幕</a></li>
<li><a href="http://beautyboss.farbox.com/post/redis/redisyuan-ma-xue-xi-zhi-shi-jian-qu-dong" target="_blank" rel="external">Redis源码学习之事件驱动</a></li>
<li><a href="https://goo.gl/eRgcAj" target="_blank" rel="external">揭秘 Reddit 愚人节项目的技术实现过程</a></li>
<li><a href="https://goo.gl/7ZXVjP" target="_blank" rel="external">Redis 通信协议 —— 了解 Redis 客户端实现原理</a></li>
<li><a href="http://blog.csdn.net/mr_smile2014/article/details/73849573" target="_blank" rel="external">redis哨兵模式使用lua脚本实现分布式锁</a></li>
<li><a href="https://goo.gl/dkyPck" target="_blank" rel="external">CRUG | Redisson性能压测权威发布</a></li>
<li><a href="https://goo.gl/2bcHHi" target="_blank" rel="external">听滴滴大神给你讲Redis Cluster迁移遇到的坑</a></li>
<li><a href="http://wangxin123.com/2017/05/27/" target="_blank" rel="external">Redis开启AOF导致的删库事件</a></li>
<li><a href="https://goo.gl/5jmgPZ" target="_blank" rel="external">唯品会海量实时OLAP分析技术升级之路</a></li>
<li><a href="https://m.aliyun.com/yunqi/articles/236384" target="_blank" rel="external">Jedis常见异常汇总</a></li>
<li><a href="http://www.jianshu.com/u/6df88dea0d41" target="_blank" rel="external">redis cluster 集群畅谈</a></li>
<li><a href="https://logz.io/blog/redis-performance-monitoring-elk-stack/" target="_blank" rel="external">Redis Performance Monitoring with the ELK Stack</a></li>
<li><a href="https://draveness.me/redis-io-multiplexing" target="_blank" rel="external">Redis 和 I/O 多路复用</a></li>
<li><a href="https://goo.gl/nYK3gx" target="_blank" rel="external">使用 Redis 解决“树”形数据的复杂查询</a></li>
<li><a href="https://www.blazemeter.com/blog/jmeters-redis-data-set-an-introduction" target="_blank" rel="external">JMeter’s Redis Data Set - An Introduction</a></li>
<li><a href="https://goo.gl/vEyUUs" target="_blank" rel="external">Redis 如何分布式，来看京东金融的设计与实践</a></li>
<li><a href="https://goo.gl/VapkrK" target="_blank" rel="external">Redis 新数据结构 - Streams</a></li>
<li><a href="https://tech.youzan.com/redisji-qun-shi-xian-yuan-li-tan-tao/?sf=wx_sm" target="_blank" rel="external">Redis集群实现原理探讨</a></li>
<li><a href="http://weakyon.com/2017/10/11/sentinel-does-not-trigger-failover-when-master-reboot-resulting-in-data-loss.html" target="_blank" rel="external">当主重启时sentinel没有切换导致数据丢失</a></li>
<li><a href="https://goo.gl/8hxsuc" target="_blank" rel="external">大规模codis集群的治理与实践</a></li>
<li><a href="http://www.jianshu.com/p/b5a96142fdd9" target="_blank" rel="external">springboot中redis的使用和分布式session共享问题</a></li>
<li><a href="http://www.baeldung.com/redis-redisson" target="_blank" rel="external">A Guide to Redis with Redisson</a></li>
<li><a href="https://goo.gl/wzk7LU" target="_blank" rel="external">直击Redis持久化磁盘IO痛点，让存储不再有负担！</a></li>
<li><a href="http://www.10tiao.com/html/496/201708/2652402631/1.html" target="_blank" rel="external">Redis Cluster 迁移案例</a></li>
<li><a href="https://yemengying.com/2017/06/04/reddit-view-counting/" target="_blank" rel="external">【译】Reddit如何统计每个帖子的浏览量</a></li>
<li><a href="http://liu-xin.me/2015/11/17/在Redis中进行分页排序查询/" target="_blank" rel="external">在Redis中进行分页排序查询</a></li>
<li><a href="http://dbaplus.cn/news-21-1142-1.html" target="_blank" rel="external">一个小改进，解决Redis数据在线加载大痛点</a></li>
<li><a href="https://quericy.me/blog/861/" target="_blank" rel="external">社区好友动态Feed流的Redis实现</a></li>
<li><a href="http://yogoup.sinaapp.com/" target="_blank" rel="external">Redis 应用案例 - 在问题中不断成长</a></li>
<li><a href="https://goo.gl/xHZMB9" target="_blank" rel="external">国内外三个领域巨头告诉你Redis怎么用</a></li>
<li><a href="https://goo.gl/x4bj6C" target="_blank" rel="external">Redis作为LRU Cache的实现</a></li>
<li><a href="https://zzyongx.github.io/blogs/index.html" target="_blank" rel="external">如何使用redis存储海量小数据</a></li>
<li><a href="https://goo.gl/KZnCcd" target="_blank" rel="external">Redis性能问题排查解决手册</a></li>
<li><a href="https://www.tuicool.com/articles/jyINfin" target="_blank" rel="external">如何在Redis中实现事务</a></li>
<li><a href="https://goo.gl/cFfebR" target="_blank" rel="external">ansible-playbook配置redis的sentinel高可用集群</a></li>
<li><a href="http://bg2bkk.github.io/post/redis过期清除机制及应用方法/" target="_blank" rel="external">redis过期清除机制及应用方法</a></li>
<li><a href="https://ruby-china.org/topics/30720" target="_blank" rel="external">记一次 Redis 实战，实现答题系统</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI3NTM1MjExMg==&amp;mid=2247483816&amp;idx=1&amp;sn=136d3da5f2a7cf546440fa8279cbaa47&amp;scene=1&amp;srcid=0823pmID5jdOnO0qQSz1g1ez#rd" target="_blank" rel="external">大规模排行榜系统实践及挑战</a></li>
<li><a href="https://goo.gl/5q7TKn" target="_blank" rel="external">京东抢购服务高并发实践</a></li>
<li><a href="https://goo.gl/yfpNuC" target="_blank" rel="external">教你看懂redis配置系列</a></li>
<li><a href="https://leibnizhu.gitlab.io/2016/09/11/Netty+Redis开发高并发应用的一些思考(二" target="_blank" rel="external">Netty+Redis开发高并发应用的一些思考(二)</a>/)</li>
<li><a href="http://sanyuesha.com/2016/08/20/distributed-lock-with-redis/" target="_blank" rel="external">如何用 redis 造一把分布式锁</a></li>
<li><a href="https://www.qcloud.com/community/article/222" target="_blank" rel="external">Redis 设计思路学习与总结</a></li>
<li><a href="https://mp.weixin.qq.com/s/7ituCSDrLCTo07ZgR66Oqw" target="_blank" rel="external">如何改变Redis用不好的误区</a></li>
<li><a href="http://www.jianshu.com/p/b68647b753e4?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=reader_share&amp;utm_source=weixin" target="_blank" rel="external">基于 Redis 的序列号服务的设计</a></li>
<li><a href="https://professorlea.github.io/2016/08/22/Redis-practice（一）基础篇/" target="_blank" rel="external">Redis practice（一）基础篇</a></li>
<li><a href="https://professorlea.github.io/2016/08/22/Redis-practise（二）使用Docker部署Redis高可用，分布式集群/#more" target="_blank" rel="external">Redis practise（二）使用Docker部署Redis高可用，分布式集群</a></li>
</ul>
<p><strong>2017-12-29更新</strong></p>
<ul>
<li><a href="http://www.darcy.org.cn/2016/07/23/Redis中的used-memory与maxmemory解惑/" target="_blank" rel="external">Redis中的used_memory与maxmemory解惑</a></li>
<li><a href="http://xiaorui.cc/2017/10/22/golang基于redis-lua封装的优先级去重队列/" target="_blank" rel="external">golang基于redis lua封装的优先级去重队列</a></li>
<li><a href="http://www.freebuf.com/sectool/156904.html" target="_blank" rel="external">搭建Redis&amp;Minerd安全应急演练环境</a></li>
<li><a href="https://redislabs.com/blog/geobike-building-location-aware-application-with-redis/" target="_blank" rel="external">GeoBike: Building Location Aware Application with Redis</a></li>
<li><a href="https://mp.weixin.qq.com/s/zv_tcdGiuOgUafNmM1UPmw" target="_blank" rel="external">利用Redis实现Bloom-Filter</a></li>
<li><a href="http://www.cnblogs.com/svan/p/7366397.html" target="_blank" rel="external">神奇的Redis延迟</a></li>
<li><a href="https://mp.weixin.qq.com/s/GZeOs6K0XfQLopMWticYdw" target="_blank" rel="external">Spring Boot + Redis 缓存方案深度解读</a></li>
<li><a href="https://mp.weixin.qq.com/s/2FEbkas_m1WnYUqjVpMkWw" target="_blank" rel="external">同程凤凰缓存系统基于Redis的设计与实践</a></li>
</ul>
<p><strong>2018-01-24更新</strong></p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/02NDtPI_CyDLDxAnf_OLdg" target="_blank" rel="external">不管你的Redis集群规模有多大，都是时候思考下如何提升资源利用率了</a></li>
<li><a href="https://www.codeproject.com/Articles/1223882/Setting-Up-a-Redis-Test-Environment-using-Docker-C" target="_blank" rel="external">Setting Up a Redis Test Environment using Docker Compose</a></li>
</ul>
<p><strong>2018-02-24</strong></p>
<ul>
<li><a href="https://www.jianshu.com/p/5d98222e36c0" target="_blank" rel="external">Redis 队列</a></li>
<li><a href="https://mp.weixin.qq.com/s/e5FF2a5WJyuYrlVAWEqhNQ" target="_blank" rel="external">Jmeter Redis插件开发 – 读写数据</a></li>
<li><a href="https://juejin.im/post/5a6873fcf265da3e3245a985" target="_blank" rel="external">线上redis迁移思路</a></li>
<li><a href="https://my.oschina.net/giegie/blog/1525931" target="_blank" rel="external">基于Redis实现分布式应用限流</a></li>
</ul>
<p><strong>2018-03-05</strong></p>
<ul>
<li><a href="https://ningyu1.github.io/site/post/05-cache-design/?from=groupmessage" target="_blank" rel="external">Cache设计和使用上的套路</a></li>
<li><a href="https://blog.52itstyle.com/archives/2308/" target="_blank" rel="external">Shiro安全框架基于Redis的分布式集群方案</a></li>
<li><a href="https://mp.weixin.qq.com/s/reaVnCtF982Jqo45IKgjeg" target="_blank" rel="external">运用 Redis 构建分布式爬虫，抓妹子图</a></li>
<li><a href="http://view.zsxq.com/view/5a9cb2a42540ed22f43a2014" target="_blank" rel="external">Redisson PRO</a></li>
<li><a href="https://mp.weixin.qq.com/s/hfbTRWaGSZfed4I2Op0O-w" target="_blank" rel="external">Redis探索之路</a></li>
<li><a href="https://opensource.com/article/18/2/building-bikesharing-application-open-source-tools" target="_blank" rel="external">Build a bikesharing app with Redis and Python</a></li>
<li><a href="https://mp.weixin.qq.com/s/uKGdK-1jP0q6xiJyczGwFw" target="_blank" rel="external">不停机分库分表迁移</a></li>
<li><a href="http://blog.csdn.net/dc_726/article/details/47355989" target="_blank" rel="external">豌豆夹Redis解决方案Codis源码剖析：Dashboard</a></li>
<li><a href="https://huoding.com/2012/02/29/146" target="_blank" rel="external">Redis消息通知系统的实现</a></li>
<li><a href="https://dzone.com/articles/swarmweek-part-2-rescheduling-redis-with-swarm" target="_blank" rel="external">Docker Swarm Part II: Rescheduling Redis</a></li>
<li><a href="http://blog.mayongfa.cn/287.html" target="_blank" rel="external">Redis 集群搭建详细指南</a></li>
</ul>
<p>参考在此：<br><a href="http://moelove.info/redis-articles/" target="_blank" rel="external">Redis技术交流群</a><br>Redis技术交流群2：微信群</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Redis原理与实战，不定期更新&quot;&gt;&lt;a href=&quot;#Redis原理与实战，不定期更新&quot; class=&quot;headerlink&quot; title=&quot;Redis原理与实战，不定期更新&quot;&gt;&lt;/a&gt;Redis原理与实战，不定期更新&lt;/h2&gt;&lt;p&gt;Redis是业界普遍应用的缓存组件，研究一个组件框架，就要探究它的设计哲学。&lt;br&gt;&lt;a href=&quot;https://redis.io/&quot;&gt;https://redis.io/&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Redis" scheme="//zeroto.tech/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>Nginx + Keepalived 高可用</title>
    <link href="//zeroto.tech/2017/11/22/Nginx-Keepalived-Install-And-Settings/"/>
    <id>//zeroto.tech/2017/11/22/Nginx-Keepalived-Install-And-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:51:09.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Nginx-Keepalived-高可用"><a href="#Nginx-Keepalived-高可用" class="headerlink" title="Nginx + Keepalived 高可用"></a>Nginx + Keepalived 高可用</h1><a id="more"></a>
<h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><ul>
<li>高可用 HA（High Availability），简单讲就是：我某个应用挂了，自动有另外应用起来接着扛着，致使整个服务对外来看是没有中断过的。这里的重点就是不中断，致使公司整个业务能不断进行中，把影响减到最小，赚得更多。</li>
<li>因为要不中断，所以我们就需要用到了 Keepalived。Keepalived 一般不会单独使用，基本都是跟负载均衡软件（LVS、HAProxy、Nginx）一起工作来达到集群的高可用效果。</li>
<li>Keepalived 有双主、主备方案</li>
<li>常用词：<ul>
<li>心跳：Master 会主动给 Backup 发送心跳检测包以及对外的网络功能，而 Backup 负责接收 Master 的心跳检测包，随时准备接管主机。为什么叫心跳不知道，但是挺形象的，心跳同步。</li>
<li>选举：Keepalived 配置的时候可以指定各台主机优先级，Master 挂了，各台 Backup 要选举出一个新的 Master。</li>
</ul>
</li>
<li>Keepalived<ul>
<li>官网：<a href="http://www.keepalived.org/" target="_blank" rel="external">http://www.keepalived.org/</a></li>
<li>官网下载：<a href="http://www.keepalived.org/download.html" target="_blank" rel="external">http://www.keepalived.org/download.html</a></li>
<li>官网文档：<a href="http://www.keepalived.org/documentation.html" target="_blank" rel="external">http://www.keepalived.org/documentation.html</a></li>
</ul>
</li>
</ul>
<h2 id="搭建"><a href="#搭建" class="headerlink" title="搭建"></a>搭建</h2><ul>
<li>软件版本：<ul>
<li>Nginx：<strong>1.8.1</strong></li>
<li>Keepalived：<strong>1.2.20</strong></li>
<li>JDK：<strong>8u72</strong></li>
<li>Tomcat：<strong>8.0.32</strong></li>
</ul>
</li>
<li>部署环境（下文中以第几台来代表这些主机）：<ul>
<li>虚拟 IP（VIP）：192.168.1.50</li>
<li>第一台主机：Nginx 1 + Keepalived 1 == 192.168.1.120（Master）</li>
<li>第二台主机：Nginx 2 + Keepalived 2 == 192.168.1.121（Backup）</li>
<li>第三台主机：Tomcat 1 == 192.168.1.122（Web 1）</li>
<li>第四台主机：Tomcat 2 == 192.168.1.123（Web 2）</li>
</ul>
</li>
<li>所有机子进行时间校准：<a href="NTP.md">NTP（Network Time Protocol）介绍</a></li>
<li>第三、第四台主机部署：<ul>
<li>JDK 的安装：<a href="JDK-Install.md">JDK 安装</a></li>
<li>Tomcat 的安装：<a href="Tomcat-Install-And-Settings.md">Tomcat 安装和配置、优化</a></li>
</ul>
</li>
<li>第一、二台主机部署（两台部署内容一样）：<ul>
<li>Nginx 的安装：<a href="Nginx-Install-And-Settings.md">Nginx 安装和配置</a></li>
<li>添加虚拟 IP：<ul>
<li>复制一个网卡信息：<code>sudo cp /etc/sysconfig/network-scripts/ifcfg-eth0 /etc/sysconfig/network-scripts/ifcfg-eth0:0</code></li>
<li>编辑配置文件：<code>sudo vim /etc/sysconfig/network-scripts/ifcfg-eth0:0</code></li>
<li>修改内容为如下信息：<pre><code class="nginx">DEVICE=eth0:0    &gt;&gt;&gt; 这个需要修改
TYPE=Ethernet
UUID=8ddbb256-caab-4ddf-8e9a-6527b4ac5a26
ONBOOT=yes 
NM_CONTROLLED=yes
BOOTPROTO=none
IPADDR=192.168.1.50    &gt;&gt;&gt; 这个需要修改
PREFIX=24  
GATEWAY=192.168.1.1
DNS1=101.226.4.6
DEFROUTE=yes
IPV4_FAILURE_FATAL=yes
IPV6INIT=no
NAME=&quot;System eth0:0&quot;    &gt;&gt;&gt; 这个需要修改
HWADDR=00:0c:29:f4:17:db
LAST_CONNECT=1460213205
</code></pre>
</li>
<li>重启网卡服务：<code>service network restart</code></li>
<li>如果你要绑定更多虚拟 IP，则多复制几个网卡配置出来，命名如下：ifcfg-eth0:0，ifcfg-eth0:1，ifcfg-eth0:2 ……</li>
</ul>
</li>
<li>Keepalived 开始安装<ul>
<li>安装依赖：<code>sudo yum install -y gcc openssl-devel popt-devel</code></li>
<li>解压包：<code>cd /opt/setups/ ; tar zxvf keepalived-1.2.20.tar.gz</code></li>
<li>编译：<code>cd /opt/setups/keepalived-1.2.20 ; ./configure --prefix=/usr/program/keepalived</code></li>
<li>编译安装：<code>make &amp;&amp; make install</code></li>
</ul>
</li>
<li>Keepalived 设置服务和随机启动<ul>
<li>复制配置文件到启动脚本目录：<code>cp /usr/program/keepalived/etc/rc.d/init.d/keepalived /etc/init.d/keepalived</code></li>
<li>增加权限：<code>chmod +x /etc/init.d/keepalived</code></li>
<li>编辑配置文件：<code>vim /etc/init.d/keepalived</code><pre><code class="nginx">把 15 行的：. /etc/sysconfig/keepalived，改为：
. /usr/program/keepalived/etc/sysconfig/keepalived（注意：前面有一个点和空格需要注意）
</code></pre>
</li>
<li>添加环境变量：<code>vim /etc/profile</code><pre><code class="nginx"># Keepalived 配置
KEEPALIVED_HOME=/usr/program/keepalived
PATH=$PATH:$KEEPALIVED_HOME/sbin
export KEEPALIVED_HOME
export PATH
</code></pre>
</li>
<li>刷新环境变量：<code>source /etc/profile</code></li>
<li>检测环境变量：<code>keepalived -v</code></li>
<li><code>ln -s /usr/program/keepalived/sbin/keepalived /usr/sbin/</code></li>
<li><code>vim /usr/program/keepalived/etc/sysconfig/keepalived</code><pre><code class="nginx">把 14 行的：KEEPALIVED_OPTIONS=&quot;-D&quot;，改为：
KEEPALIVED_OPTIONS=&quot;-D -f /usr/program/keepalived/etc/keepalived/keepalived.conf&quot;
</code></pre>
</li>
<li>加入随机启动：<code>chkconfig keepalived on</code></li>
</ul>
</li>
</ul>
</li>
<li><p>第一、二台主机配置（两台在 Keepalived 配置上稍微有不一样）：</p>
<ul>
<li>健康监测脚本（我个人放在：/opt/bash 目录下）：<a href="Keepalived-Settings/nginx_check.sh">nginx_check.sh</a></li>
<li>健康监测脚本添加执行权限：<code>chmod 755 /opt/bash/nginx_check.sh</code></li>
<li>运行监测脚本，看下是否有问题：<code>sh /opt/bash/nginx_check.sh</code>，如果没有报错，则表示改脚本没有问题<ul>
<li>这个脚本很重要，如果脚本没法用，在启用 Keepalived 的时候可能会报：<code>Keepalived_vrrp[5684]: pid 5959 exited with status 1</code></li>
</ul>
</li>
<li><p>nginx 配置（两台一样配置）：</p>
<pre><code class="nginx">worker_processes  1;

events {
  worker_connections  1024;
}

http {
  include       mime.types;
  default_type  application/octet-stream;

  sendfile        on;
  keepalive_timeout  65;

  # （重点）
  upstream tomcatCluster {
      server 192.168.1.122:8080 weight=1;
      server 192.168.1.123:8080 weight=1;
  }

  # （重点）
  server {
      listen       80;
      server_name  192.168.1.50;

      location / {
          proxy_pass   http://tomcatCluster;
          index  index.html index.htm;
      }
  }
}
</code></pre>
</li>
<li><p>Keepalived 配置文件编辑（第一、二台配置稍微不同，不同点具体看下面重点说明）</p>
<ul>
<li>编辑：<code>vim /usr/program/keepalived/etc/keepalived/keepalived.conf</code></li>
</ul>
<p>``` nginx<br>! Configuration File for keepalived</p>
<h1 id="全局配置"><a href="#全局配置" class="headerlink" title="全局配置"></a>全局配置</h1><p>global_defs {</p>
<h1 id="邮箱通知配置，keepalived-在发生切换时需要发送-email-到的对象，一行一个"><a href="#邮箱通知配置，keepalived-在发生切换时需要发送-email-到的对象，一行一个" class="headerlink" title="邮箱通知配置，keepalived 在发生切换时需要发送 email 到的对象，一行一个"></a>邮箱通知配置，keepalived 在发生切换时需要发送 email 到的对象，一行一个</h1><p>  notification_email {</p>
<pre><code>  #acassen@firewall.loc
  #failover@firewall.loc
  #sysadmin@firewall.loc
</code></pre><p>  }</p>
<h1 id="指定发件人"><a href="#指定发件人" class="headerlink" title="指定发件人"></a>指定发件人</h1><p>  #notification_email_from Alexandre.Cassen@firewall.loc</p>
<h1 id="指定smtp服务器地址"><a href="#指定smtp服务器地址" class="headerlink" title="指定smtp服务器地址"></a>指定smtp服务器地址</h1><p>  #smtp_server 192.168.200.1</p>
<h1 id="指定smtp连接超时时间，单位秒"><a href="#指定smtp连接超时时间，单位秒" class="headerlink" title="指定smtp连接超时时间，单位秒"></a>指定smtp连接超时时间，单位秒</h1><p>  #smtp_connect_timeout 30</p>
<p>  router_id LVS_DEVEL<br>  vrrp_skip_check_adv_addr<br>  vrrp_strict<br>}</p>
<h1 id="（重点）脚本监控实现"><a href="#（重点）脚本监控实现" class="headerlink" title="（重点）脚本监控实现"></a>（重点）脚本监控实现</h1><p>vrrp_script check_nginx {</p>
<h1 id="运行脚本"><a href="#运行脚本" class="headerlink" title="运行脚本"></a>运行脚本</h1><p>  script “/opt/bash/nginx_check.sh”</p>
<h1 id="时间间隔，2秒"><a href="#时间间隔，2秒" class="headerlink" title="时间间隔，2秒"></a>时间间隔，2秒</h1><p>  interval 2</p>
<h1 id="权重"><a href="#权重" class="headerlink" title="权重"></a>权重</h1><p>  weight 2<br>}</p>
</li>
</ul>
</li>
</ul>
<pre><code>vrrp_instance VI_1 {
    # （重点）Backup 机子这里是设置为：BACKUP
    state MASTER
    interface eth0
    virtual_router_id 51
    # （重点）Backup 机子要小于当前 Master 设置的 100，建议设置为 99
    priority 100
    # Master 与 Backup 负载均衡器之间同步检查的时间间隔，单位是秒
    advert_int 1
    authentication {
        auth_type PASS
        auth_pass 1111
    }

    # （重点）配置虚拟 IP 地址，如果有多个则一行一个
    virtual_ipaddress {
        192.168.1.50
    }

    # （重点）脚本监控调用
    track_script {
        check_nginx
    }
}
```
</code></pre><h3 id="启动各自服务"><a href="#启动各自服务" class="headerlink" title="启动各自服务"></a>启动各自服务</h3><ul>
<li>四台机子都停掉防火墙：<code>service iptables stop</code></li>
<li>先启动两台 Tomcat：<code>sh /usr/program/tomcat8/bin/startup.sh ; tail -200f /usr/program/tomcat8/logs/catalina.out</code><ul>
<li>检查两台 Tomcat 是否可以单独访问，最好给首页加上不同标识，好方便等下确认是否有负载<ul>
<li><code>http://192.168.1.122:8080</code></li>
<li><code>http://192.168.1.123:8080</code></li>
</ul>
</li>
</ul>
</li>
<li>启动两台 Nginx 服务：<code>/usr/local/nginx/sbin/nginx</code></li>
<li>启动两台 Keepalived 服务：<code>service keepalived start</code></li>
<li>查看 Master 和 Backup 两台主机的对应日志：<code>tail -f /var/log/messages</code></li>
</ul>
<h3 id="高可用测试"><a href="#高可用测试" class="headerlink" title="高可用测试"></a>高可用测试</h3><ul>
<li>模拟 Keepalived 挂掉<ul>
<li>关闭 Master 主机的 Keepalived，查看 Master 和 Backup 两台主机的对应日志：<code>tail -f /var/log/messages</code><ul>
<li>关闭服务：<code>service keepalived stop</code></li>
<li>如果第二台机接管了，则表示成功</li>
</ul>
</li>
<li>重新开启 Master 主机的 Keepalived，查看 Master 和 Backup 两台主机的对应日志：<code>tail -f /var/log/messages</code><ul>
<li>重启服务：<code>service keepalived restart</code></li>
<li>如果第一台机重新接管了，则表示成功</li>
</ul>
</li>
</ul>
</li>
<li>模拟 Nginx 挂掉<ul>
<li>关闭 Master 主机的 Nginx，查看 Master 和 Backup 两台主机的对应日志：<code>tail -f /var/log/messages</code><ul>
<li>关闭服务：<code>/usr/local/nginx/sbin/nginx -s stop</code></li>
<li>如果第二台机接管了，则表示成功</li>
</ul>
</li>
<li>重新开启 Master 主机的 Nginx，查看 Master 和 Backup 两台主机的对应日志：<code>tail -f /var/log/messages</code><ul>
<li>重启 Nginx 服务：<code>/usr/local/nginx/sbin/nginx -s reload</code></li>
<li>重启 Keepalived 服务：<code>service keepalived restart</code></li>
<li>如果第一台机重新接管了，则表示成功</li>
</ul>
</li>
</ul>
</li>
<li>可以优化的地方，改为双主热备，监控脚本上带有自启动相关细节，后续再进行。</li>
<li>日志中常用的几句话解释：<ul>
<li><code>Entering to MASTER STATE</code>，变成 Master 状态<ul>
<li><code>Netlink reflector reports IP 192.168.1.50 added</code>，一般变为 Master 状态，都要重新加入虚拟 IP，一般叫法叫做：虚拟 IP 重新漂移到 Master 机子上</li>
</ul>
</li>
<li><code>Entering BACKUP STATE</code>，变成 Backup 状态<ul>
<li><code>Netlink reflector reports IP 192.168.1.50 removed</code>，一般变为 Backup 状态，都要移出虚拟 IP，一般叫法叫做：虚拟 IP 重新漂移到 Master 机子上</li>
</ul>
</li>
<li><code>VRRP_Script(check_nginx) succeeded</code>，监控脚本执行成功</li>
</ul>
</li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://xutaibao.blog.51cto.com/7482722/1669123" target="_blank" rel="external">http://xutaibao.blog.51cto.com/7482722/1669123</a></li>
<li><a href="https://m.oschina.net/blog/301710" target="_blank" rel="external">https://m.oschina.net/blog/301710</a></li>
<li><a href="http://blog.csdn.net/u010028869/article/details/50612571" target="_blank" rel="external">http://blog.csdn.net/u010028869/article/details/50612571</a></li>
<li><a href="http://blog.csdn.net/wanglei_storage/article/details/51175418" target="_blank" rel="external">http://blog.csdn.net/wanglei_storage/article/details/51175418</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Nginx-Keepalived-高可用&quot;&gt;&lt;a href=&quot;#Nginx-Keepalived-高可用&quot; class=&quot;headerlink&quot; title=&quot;Nginx + Keepalived 高可用&quot;&gt;&lt;/a&gt;Nginx + Keepalived 高可用&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>FastDFS 安装和配置</title>
    <link href="//zeroto.tech/2017/11/22/FastDFS-Install-And-Settings/"/>
    <id>//zeroto.tech/2017/11/22/FastDFS-Install-And-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:35:11.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="FastDFS-安装和配置"><a href="#FastDFS-安装和配置" class="headerlink" title="FastDFS 安装和配置"></a>FastDFS 安装和配置</h1><a id="more"></a>
<h2 id="它是什么"><a href="#它是什么" class="headerlink" title="它是什么"></a>它是什么</h2><ul>
<li>FastDFS 介绍：<a href="http://www.oschina.net/p/fastdfs" target="_blank" rel="external">http://www.oschina.net/p/fastdfs</a></li>
<li>官网下载：<a href="https://github.com/happyfish100/fastdfs/releases" target="_blank" rel="external">https://github.com/happyfish100/fastdfs/releases</a></li>
</ul>
<h2 id="为什么会出现"><a href="#为什么会出现" class="headerlink" title="为什么会出现"></a>为什么会出现</h2><h2 id="哪些人喜欢它"><a href="#哪些人喜欢它" class="headerlink" title="哪些人喜欢它"></a>哪些人喜欢它</h2><h2 id="哪些人不喜欢它"><a href="#哪些人不喜欢它" class="headerlink" title="哪些人不喜欢它"></a>哪些人不喜欢它</h2><h2 id="为什么学习它"><a href="#为什么学习它" class="headerlink" title="为什么学习它"></a>为什么学习它</h2><h2 id="同类工具"><a href="#同类工具" class="headerlink" title="同类工具"></a>同类工具</h2><h3 id="单机安装部署（CentOS-6-7-环境）"><a href="#单机安装部署（CentOS-6-7-环境）" class="headerlink" title="单机安装部署（CentOS 6.7 环境）"></a>单机安装部署（CentOS 6.7 环境）</h3><ul>
<li>环境准备：<ul>
<li>已经安装好 Nginx</li>
</ul>
</li>
<li>软件准备：<ul>
<li><strong>FastDFS_v5.05.tar.gz</strong></li>
<li><strong>fastdfs-nginx-module_v1.16.tar.gz</strong></li>
<li><strong>libfastcommon-1.0.7.tar.gz</strong></li>
</ul>
</li>
<li>安装依赖包：<code>yum install -y libevent</code></li>
<li>安装 <strong>libfastcommon-1.0.7.tar.gz</strong><ul>
<li>解压：<code>tar zxvf libfastcommon-1.0.7.tar.gz</code></li>
<li>进入解压后目录：<code>cd libfastcommon-1.0.7/</code></li>
<li>编译：<code>./make.sh</code></li>
<li>安装：<code>./make.sh install</code></li>
<li>设置几个软链接：<code>ln -s /usr/lib64/libfastcommon.so /usr/local/lib/libfastcommon.so</code>  </li>
<li>设置几个软链接：<code>ln -s /usr/lib64/libfastcommon.so /usr/lib/libfastcommon.so</code>  </li>
<li>设置几个软链接：<code>ln -s /usr/lib64/libfdfsclient.so /usr/local/lib/libfdfsclient.so</code>  </li>
<li>设置几个软链接：<code>ln -s /usr/lib64/libfdfsclient.so /usr/lib/libfdfsclient.so</code> </li>
</ul>
</li>
<li>安装 tracker （跟踪器）服务 <strong>FastDFS_v5.08.tar.gz</strong><ul>
<li>解压：<code>tar zxvf FastDFS_v5.05.tar.gz</code></li>
<li>进入解压后目录：<code>cd FastDFS/</code></li>
<li>编译：<code>./make.sh</code></li>
<li>安装：<code>./make.sh install</code></li>
<li>安装结果：<pre><code class="ini">/usr/bin 存放有编译出来的文件
/etc/fdfs 存放有配置文件
</code></pre>
</li>
</ul>
</li>
<li>配置 tracker 服务<ul>
<li>复制一份配置文件：<code>cp /etc/fdfs/tracker.conf.sample /etc/fdfs/tracker.conf</code></li>
<li>编辑：<code>vim /etc/fdfs/tracker.conf</code>，编辑内容看下面中文注释<pre><code class="ini">disabled=false
bind_addr=
port=22122
connect_timeout=30
network_timeout=60
# 下面这个路径是保存 store data 和 log 的地方，需要我们改下，指向我们一个存在的目录
# 创建目录：mkdir -p /opt/fastdfs/tracker/data-and-log
base_path=/opt/fastdfs/tracker/data-and-log
max_connections=256
accept_threads=1
work_threads=4
store_lookup=2
store_group=group2
store_server=0
store_path=0
download_server=0
reserved_storage_space = 10%
log_level=info
run_by_group=
run_by_user=
allow_hosts=*
sync_log_buff_interval = 10
check_active_interval = 120
thread_stack_size = 64KB
storage_ip_changed_auto_adjust = true
storage_sync_file_max_delay = 86400
storage_sync_file_max_time = 300
use_trunk_file = false 
slot_min_size = 256
slot_max_size = 16MB
trunk_file_size = 64MB
trunk_create_file_advance = false
trunk_create_file_time_base = 02:00
trunk_create_file_interval = 86400
trunk_create_file_space_threshold = 20G
trunk_init_check_occupying = false
trunk_init_reload_from_binlog = false
trunk_compress_binlog_min_interval = 0
use_storage_id = false
storage_ids_filename = storage_ids.conf
id_type_in_filename = ip
store_slave_file_use_link = false
rotate_error_log = false
error_log_rotate_time=00:00
rotate_error_log_size = 0
log_file_keep_days = 0
use_connection_pool = false
connection_pool_max_idle_time = 3600
http.server_port=8080
http.check_alive_interval=30
http.check_alive_type=tcp
http.check_alive_uri=/status.html
</code></pre>
</li>
<li>启动 tracker 服务：<code>/usr/bin/fdfs_trackerd /etc/fdfs/tracker.conf</code></li>
<li>重启 tracker 服务：<code>/usr/bin/fdfs_trackerd /etc/fdfs/tracker.conf restart</code></li>
<li>查看是否有 tracker 进程：<code>ps aux | grep tracker</code></li>
</ul>
</li>
<li>storage （存储节点）服务部署<ul>
<li>一般 storage 服务我们会单独装一台机子，但是这里为了方便我们安装在同一台。</li>
<li>如果 storage 单独安装的话，那上面安装的步骤都要在走一遍，只是到了编辑配置文件的时候，编辑的是 storage.conf 而已</li>
<li>复制一份配置文件：<code>cp /etc/fdfs/storage.conf.sample /etc/fdfs/storage.conf</code></li>
<li>编辑：<code>vim /etc/fdfs/storage.conf</code>，编辑内容看下面中文注释<pre><code class="ini">disabled=false
group_name=group1
bind_addr=
client_bind=true
port=23000
connect_timeout=30
network_timeout=60
heart_beat_interval=30
stat_report_interval=60
# 下面这个路径是保存 store data 和 log 的地方，需要我们改下，指向我们一个存在的目录
# 创建目录：mkdir -p /opt/fastdfs/storage/data-and-log
base_path=/opt/fastdfs/storage/data-and-log
max_connections=256
buff_size = 256KB
accept_threads=1
work_threads=4
disk_rw_separated = true
disk_reader_threads = 1
disk_writer_threads = 1
sync_wait_msec=50
sync_interval=0
sync_start_time=00:00
sync_end_time=23:59
write_mark_file_freq=500
store_path_count=1
# 图片实际存放路径，如果有多个，这里可以有多行：
# store_path0=/opt/fastdfs/storage/images-data0
# store_path1=/opt/fastdfs/storage/images-data1
# store_path2=/opt/fastdfs/storage/images-data2
# 创建目录：mkdir -p /opt/fastdfs/storage/images-data
store_path0=/opt/fastdfs/storage/images-data
subdir_count_per_path=256
# 指定 tracker 服务器的 IP 和端口
tracker_server=192.168.1.114:22122
log_level=info
run_by_group=
run_by_user=
allow_hosts=*
file_distribute_path_mode=0
file_distribute_rotate_count=100
fsync_after_written_bytes=0
sync_log_buff_interval=10
sync_binlog_buff_interval=10
sync_stat_file_interval=300
thread_stack_size=512KB
upload_priority=10
if_alias_prefix=
check_file_duplicate=0
file_signature_method=hash
key_namespace=FastDFS
keep_alive=0
use_access_log = false
rotate_access_log = false
access_log_rotate_time=00:00
rotate_error_log = false
error_log_rotate_time=00:00
rotate_access_log_size = 0
rotate_error_log_size = 0
log_file_keep_days = 0
file_sync_skip_invalid_record=false
use_connection_pool = false
connection_pool_max_idle_time = 3600
http.domain_name=
http.server_port=8888
</code></pre>
</li>
<li>启动 storage 服务：<code>/usr/bin/fdfs_storaged /etc/fdfs/storage.conf</code>，首次启动会很慢，因为它在创建预设存储文件的目录</li>
<li>重启 storage 服务：<code>/usr/bin/fdfs_storaged /etc/fdfs/storage.conf restart</code></li>
<li>查看是否有 storage 进程：<code>ps aux | grep storage</code></li>
</ul>
</li>
<li>测试是否部署成功<ul>
<li>利用自带的 client 进行测试</li>
<li>复制一份配置文件：<code>cp /etc/fdfs/client.conf.sample /etc/fdfs/client.conf</code></li>
<li>编辑：<code>vim /etc/fdfs/client.conf</code>，编辑内容看下面中文注释<pre><code class="ini">connect_timeout=30
network_timeout=60
# 下面这个路径是保存 store log 的地方，需要我们改下，指向我们一个存在的目录
# 创建目录：mkdir -p /opt/fastdfs/client/data-and-log
base_path=/opt/fastdfs/client/data-and-log
# 指定 tracker 服务器的 IP 和端口
tracker_server=192.168.1.114:22122
log_level=info
use_connection_pool = false
connection_pool_max_idle_time = 3600
load_fdfs_parameters_from_tracker=false
use_storage_id = false
storage_ids_filename = storage_ids.conf
http.tracker_server_port=80
</code></pre>
</li>
<li>在终端中通过 shell 上传 opt 目录下的一张图片：<code>/usr/bin/fdfs_test /etc/fdfs/client.conf upload /opt/test.jpg</code></li>
<li>如下图箭头所示，生成的图片地址为：<code>http://192.168.1.114/group1/M00/00/00/wKgBclb0aqWAbVNrAAAjn7_h9gM813_big.jpg</code><ul>
<li><img src="images/FastDFS-a-1.jpg" alt="FastDFS"></li>
</ul>
</li>
<li>即使我们现在知道图片的访问地址我们也访问不了，因为我们还没装 FastDFS 的 Nginx 模块</li>
</ul>
</li>
<li>安装 <strong>fastdfs-nginx-module_v1.16.tar.gz</strong>，安装 Nginx 第三方模块相当于这个 Nginx 都是要重新安装一遍的<ul>
<li>解压 Nginx 模块：<code>tar zxvf fastdfs-nginx-module_v1.16.tar.gz</code>，得到目录地址：<strong>/opt/setups/FastDFS/fastdfs-nginx-module</strong></li>
<li>编辑 Nginx 模块的配置文件：<code>vim /opt/setups/FastDFS/fastdfs-nginx-module/src/config</code></li>
<li>找到下面一行包含有 <code>local</code> 字眼去掉，因为这三个路径根本不是在 local 目录下的。<pre><code class="nginx">CORE_INCS=&quot;$CORE_INCS /usr/local/include/fastdfs /usr/local/include/fastcommon/&quot;
</code></pre>
</li>
<li>改为如下：<pre><code class="nginx">CORE_INCS=&quot;$CORE_INCS /usr/include/fastdfs /usr/include/fastcommon/&quot;
</code></pre>
</li>
<li>复制文件：<code>cp /opt/setups/FastDFS/FastDFS/conf/http.conf /etc/fdfs</code></li>
<li>复制文件：<code>cp /opt/setups/FastDFS/FastDFS/conf/mime.types /etc/fdfs</code></li>
</ul>
</li>
<li><p>安装 Nginx 和 Nginx 第三方模块</p>
<ul>
<li>安装 Nginx 依赖包：<code>yum install -y gcc gcc-c++ pcre pcre-devel zlib zlib-devel openssl openssl-devel</code></li>
<li>预设几个文件夹，方便等下安装的时候有些文件可以进行存放：<ul>
<li><code>mkdir -p /usr/local/nginx /var/log/nginx /var/temp/nginx /var/lock/nginx</code></li>
</ul>
</li>
<li>解压 Nginx：<code>tar zxvf /opt/setups/nginx-1.8.1.tar.gz</code></li>
<li>进入解压后目录：<code>cd /opt/setups/nginx-1.8.1/</code></li>
<li>编译配置：（注意最后一行）<pre><code class="ini">./configure \
--prefix=/usr/local/nginx \
--pid-path=/var/local/nginx/nginx.pid \
--lock-path=/var/lock/nginx/nginx.lock \
--error-log-path=/var/log/nginx/error.log \
--http-log-path=/var/log/nginx/access.log \
--with-http_gzip_static_module \
--http-client-body-temp-path=/var/temp/nginx/client \
--http-proxy-temp-path=/var/temp/nginx/proxy \
--http-fastcgi-temp-path=/var/temp/nginx/fastcgi \
--http-uwsgi-temp-path=/var/temp/nginx/uwsgi \
--http-scgi-temp-path=/var/temp/nginx/scgi \
--add-module=/opt/setups/FastDFS/fastdfs-nginx-module/src
</code></pre>
</li>
<li>编译：<code>make</code></li>
<li>安装：<code>make install</code></li>
<li>复制 Nginx 模块的配置文件：<code>cp /opt/setups/FastDFS/fastdfs-nginx-module/src/mod_fastdfs.conf /etc/fdfs</code></li>
<li>编辑 Nginx 模块的配置文件：<code>vim /etc/fdfs/mod_fastdfs.conf</code>，编辑内容看下面中文注释</li>
<li><p>如果在已经启动 Nginx 的情况下修改下面内容记得要重启 Nginx。</p>
<pre><code class="ini">connect_timeout=2
network_timeout=30
# 下面这个路径是保存 log 的地方，需要我们改下，指向我们一个存在的目录
# 创建目录：mkdir -p /opt/fastdfs/fastdfs-nginx-module/data-and-log
base_path=/opt/fastdfs/fastdfs-nginx-module/data-and-log
load_fdfs_parameters_from_tracker=true
storage_sync_file_max_delay = 86400
use_storage_id = false
storage_ids_filename = storage_ids.conf
# 指定 tracker 服务器的 IP 和端口
tracker_server=192.168.1.114:22122
storage_server_port=23000
group_name=group1
# 因为我们访问图片的地址是：http://192.168.1.114/group1/M00/00/00/wKgBclb0aqWAbVNrAAAjn7_h9gM813_big.jpg
# 该地址前面是带有 /group1/M00，所以我们这里要使用 true，不然访问不到（原值是 false）
url_have_group_name = true
store_path_count=1
# 图片实际存放路径，如果有多个，这里可以有多行：
# store_path0=/opt/fastdfs/storage/images-data0
# store_path1=/opt/fastdfs/storage/images-data1
# store_path2=/opt/fastdfs/storage/images-data2
store_path0=/opt/fastdfs/storage/images-data
log_level=info
log_filename=
response_mode=proxy
if_alias_prefix=
flv_support = true
flv_extension = flv
group_count = 0
</code></pre>
</li>
<li><p>编辑 Nginx 配置文件</p>
<pre><code class="nginx"># 注意这一行行，我特别加上了使用 root 用户去执行，不然有些日记目录没有权限访问
user  root;
worker_processes  1;

events {
  worker_connections  1024;
}

http {
  include       mime.types;
  default_type  application/octet-stream;

  sendfile        on;
  keepalive_timeout  65;

  server {
      listen       80;
      # 访问本机
      server_name  192.168.1.114;

      # 拦截包含 /group1/M00 请求，使用 fastdfs 这个 Nginx 模块进行转发
      location /group1/M00 {
          ngx_fastdfs_module;
      }
    }
}
</code></pre>
</li>
<li>启动 Nginx<ul>
<li>停掉防火墙：<code>service iptables stop</code></li>
<li>启动：<code>/usr/local/nginx/sbin/nginx</code>，启动完成 shell 是不会有输出的</li>
<li>访问：<code>192.168.1.114</code>，如果能看到：<code>Welcome to nginx!</code>，即可表示安装成功</li>
<li>检查 时候有 Nginx 进程：<code>ps aux | grep nginx</code>，正常是显示 3 个结果出来 </li>
<li>刷新 Nginx 配置后重启：<code>/usr/local/nginx/sbin/nginx -s reload</code></li>
<li>停止 Nginx：<code>/usr/local/nginx/sbin/nginx -s stop</code></li>
<li>如果访问不了，或是出现其他信息看下错误立即：<code>vim /var/log/nginx/error.log</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="多机安装部署（CentOS-6-7-环境）"><a href="#多机安装部署（CentOS-6-7-环境）" class="headerlink" title="多机安装部署（CentOS 6.7 环境）"></a>多机安装部署（CentOS 6.7 环境）</h3><p><a href="http://blog.csdn.net/ricciozhang/article/details/49402273" target="_blank" rel="external">http://blog.csdn.net/ricciozhang/article/details/49402273</a></p>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://blog.csdn.net/ricciozhang/article/details/49402273" target="_blank" rel="external">fastdfs+nginx安装配置</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;FastDFS-安装和配置&quot;&gt;&lt;a href=&quot;#FastDFS-安装和配置&quot; class=&quot;headerlink&quot; title=&quot;FastDFS 安装和配置&quot;&gt;&lt;/a&gt;FastDFS 安装和配置&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>FastDFS 结合 GraphicsMagick</title>
    <link href="//zeroto.tech/2017/11/22/FastDFS-Nginx-Lua-GraphicsMagick/"/>
    <id>//zeroto.tech/2017/11/22/FastDFS-Nginx-Lua-GraphicsMagick/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:36:12.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="FastDFS-结合-GraphicsMagick"><a href="#FastDFS-结合-GraphicsMagick" class="headerlink" title="FastDFS 结合 GraphicsMagick"></a>FastDFS 结合 GraphicsMagick</h1><a id="more"></a>
<h2 id="单机安装部署（CentOS-6-7-环境）"><a href="#单机安装部署（CentOS-6-7-环境）" class="headerlink" title="单机安装部署（CentOS 6.7 环境）"></a>单机安装部署（CentOS 6.7 环境）</h2><h3 id="先安装-FastDFS"><a href="#先安装-FastDFS" class="headerlink" title="先安装 FastDFS"></a>先安装 FastDFS</h3><ul>
<li>软件准备：<ul>
<li>我这边统一提供了一个压缩包，方便使用。<ul>
<li>下载地址：<a href="http://pan.baidu.com/s/1hsg2brA" target="_blank" rel="external">http://pan.baidu.com/s/1hsg2brA</a></li>
</ul>
</li>
</ul>
</li>
<li>安装依赖包：<code>yum install -y gcc gcc-c++ pcre pcre-devel zlib zlib-devel openssl openssl-devel libevent</code></li>
<li>安装 <strong>libfastcommon-1.0.7.tar.gz</strong><ul>
<li>解压：<code>tar zxvf libfastcommon-1.0.7.tar.gz</code></li>
<li>进入解压后目录：<code>cd libfastcommon-1.0.7/</code></li>
<li>编译：<code>./make.sh</code></li>
<li>安装：<code>./make.sh install</code></li>
<li>设置几个软链接：<code>ln -s /usr/lib64/libfastcommon.so /usr/local/lib/libfastcommon.so</code>  </li>
<li>设置几个软链接：<code>ln -s /usr/lib64/libfastcommon.so /usr/lib/libfastcommon.so</code>  </li>
<li>设置几个软链接：<code>ln -s /usr/lib64/libfdfsclient.so /usr/local/lib/libfdfsclient.so</code>  </li>
<li>设置几个软链接：<code>ln -s /usr/lib64/libfdfsclient.so /usr/lib/libfdfsclient.so</code> </li>
</ul>
</li>
<li>安装 tracker （跟踪器）服务 <strong>FastDFS_v5.08.tar.gz</strong><ul>
<li>解压：<code>tar zxvf FastDFS_v5.05.tar.gz</code></li>
<li>进入解压后目录：<code>cd FastDFS/</code></li>
<li>编译：<code>./make.sh</code></li>
<li>安装：<code>./make.sh install</code></li>
</ul>
</li>
<li>配置 tracker 服务<ul>
<li>复制一份配置文件：<code>cp /etc/fdfs/tracker.conf.sample /etc/fdfs/tracker.conf</code></li>
<li>编辑：<code>vim /etc/fdfs/tracker.conf</code>，编辑内容看下面中文注释<pre><code class="ini">disabled=false
bind_addr=
port=22122
connect_timeout=30
network_timeout=60
# 下面这个路径是保存 store data 和 log 的地方，需要我们改下，指向我们一个存在的目录
# 创建目录：mkdir -p /opt/fastdfs/tracker/data-and-log
base_path=/opt/fastdfs/tracker/data-and-log
max_connections=256
accept_threads=1
work_threads=4
store_lookup=2
store_group=group2
store_server=0
store_path=0
download_server=0
reserved_storage_space = 10%
log_level=info
run_by_group=
run_by_user=
allow_hosts=*
sync_log_buff_interval = 10
check_active_interval = 120
thread_stack_size = 64KB
storage_ip_changed_auto_adjust = true
storage_sync_file_max_delay = 86400
storage_sync_file_max_time = 300
use_trunk_file = false 
slot_min_size = 256
slot_max_size = 16MB
trunk_file_size = 64MB
trunk_create_file_advance = false
trunk_create_file_time_base = 02:00
trunk_create_file_interval = 86400
trunk_create_file_space_threshold = 20G
trunk_init_check_occupying = false
trunk_init_reload_from_binlog = false
trunk_compress_binlog_min_interval = 0
use_storage_id = false
storage_ids_filename = storage_ids.conf
id_type_in_filename = ip
store_slave_file_use_link = false
rotate_error_log = false
error_log_rotate_time=00:00
rotate_error_log_size = 0
log_file_keep_days = 0
use_connection_pool = false
connection_pool_max_idle_time = 3600
http.server_port=8080
http.check_alive_interval=30
http.check_alive_type=tcp
http.check_alive_uri=/status.html
</code></pre>
</li>
<li>启动 tracker 服务：<code>/usr/bin/fdfs_trackerd /etc/fdfs/tracker.conf</code></li>
<li>重启 tracker 服务：<code>/usr/bin/fdfs_trackerd /etc/fdfs/tracker.conf restart</code></li>
<li>查看是否有 tracker 进程：<code>ps aux | grep tracker</code></li>
</ul>
</li>
<li>storage （存储节点）服务部署<ul>
<li>一般 storage 服务我们会单独装一台机子，但是这里为了方便我们安装在同一台。</li>
<li>如果 storage 单独安装的话，那上面安装的步骤都要在走一遍，只是到了编辑配置文件的时候，编辑的是 storage.conf 而已</li>
<li>复制一份配置文件：<code>cp /etc/fdfs/storage.conf.sample /etc/fdfs/storage.conf</code></li>
<li>编辑：<code>vim /etc/fdfs/storage.conf</code>，编辑内容看下面中文注释<pre><code class="ini">disabled=false
group_name=group1
bind_addr=
client_bind=true
port=23000
connect_timeout=30
network_timeout=60
heart_beat_interval=30
stat_report_interval=60
# 下面这个路径是保存 store data 和 log 的地方，需要我们改下，指向我们一个存在的目录
# 创建目录：mkdir -p /opt/fastdfs/storage/data-and-log
base_path=/opt/fastdfs/storage/data-and-log
max_connections=256
buff_size = 256KB
accept_threads=1
work_threads=4
disk_rw_separated = true
disk_reader_threads = 1
disk_writer_threads = 1
sync_wait_msec=50
sync_interval=0
sync_start_time=00:00
sync_end_time=23:59
write_mark_file_freq=500
store_path_count=1
# 图片实际存放路径，如果有多个，这里可以有多行：
# store_path0=/opt/fastdfs/storage/images-data0
# store_path1=/opt/fastdfs/storage/images-data1
# store_path2=/opt/fastdfs/storage/images-data2
# 创建目录：mkdir -p /opt/fastdfs/storage/images-data
store_path0=/opt/fastdfs/storage/images-data
subdir_count_per_path=256
# 指定 tracker 服务器的 IP 和端口
tracker_server=192.168.1.114:22122
log_level=info
run_by_group=
run_by_user=
allow_hosts=*
file_distribute_path_mode=0
file_distribute_rotate_count=100
fsync_after_written_bytes=0
sync_log_buff_interval=10
sync_binlog_buff_interval=10
sync_stat_file_interval=300
thread_stack_size=512KB
upload_priority=10
if_alias_prefix=
check_file_duplicate=0
file_signature_method=hash
key_namespace=FastDFS
keep_alive=0
use_access_log = false
rotate_access_log = false
access_log_rotate_time=00:00
rotate_error_log = false
error_log_rotate_time=00:00
rotate_access_log_size = 0
rotate_error_log_size = 0
log_file_keep_days = 0
file_sync_skip_invalid_record=false
use_connection_pool = false
connection_pool_max_idle_time = 3600
http.domain_name=
http.server_port=8888
</code></pre>
</li>
<li>启动 storage 服务：<code>/usr/bin/fdfs_storaged /etc/fdfs/storage.conf</code>，首次启动会很慢，因为它在创建预设存储文件的目录</li>
<li>重启 storage 服务：<code>/usr/bin/fdfs_storaged /etc/fdfs/storage.conf restart</code></li>
<li>查看是否有 storage 进程：<code>ps aux | grep storage</code></li>
</ul>
</li>
<li>测试是否部署成功<ul>
<li>利用自带的 client 进行测试</li>
<li>复制一份配置文件：<code>cp /etc/fdfs/client.conf.sample /etc/fdfs/client.conf</code></li>
<li>编辑：<code>vim /etc/fdfs/client.conf</code>，编辑内容看下面中文注释<pre><code class="ini">connect_timeout=30
network_timeout=60
# 下面这个路径是保存 store log 的地方，需要我们改下，指向我们一个存在的目录
# 创建目录：mkdir -p /opt/fastdfs/client/data-and-log
base_path=/opt/fastdfs/client/data-and-log
# 指定 tracker 服务器的 IP 和端口
tracker_server=192.168.1.114:22122
log_level=info
use_connection_pool = false
connection_pool_max_idle_time = 3600
load_fdfs_parameters_from_tracker=false
use_storage_id = false
storage_ids_filename = storage_ids.conf
http.tracker_server_port=80
</code></pre>
</li>
<li>在终端中通过 shell 上传 opt 目录下的一张图片：<code>/usr/bin/fdfs_test /etc/fdfs/client.conf upload /opt/test.jpg</code></li>
<li>如下图箭头所示，生成的图片地址为：<code>http://192.168.1.114/group1/M00/00/00/wKgBclb0aqWAbVNrAAAjn7_h9gM813_big.jpg</code><ul>
<li><img src="images/FastDFS-a-1.jpg" alt="FastDFS"></li>
</ul>
</li>
<li>即使我们现在知道图片的访问地址我们也访问不了，因为我们还没装 FastDFS 的 Nginx 模块</li>
</ul>
</li>
</ul>
<h3 id="安装-nginx-lua-GraphicsMagick"><a href="#安装-nginx-lua-GraphicsMagick" class="headerlink" title="安装 nginx-lua-GraphicsMagick"></a>安装 nginx-lua-GraphicsMagick</h3><ul>
<li>来源：<a href="https://github.com/yanue/nginx-lua-GraphicsMagick/blob/master/nginx-install.md" target="_blank" rel="external">https://github.com/yanue/nginx-lua-GraphicsMagick/blob/master/nginx-install.md</a></li>
<li>添加专用用户，后面有用<ul>
<li><code>groupadd www</code></li>
<li><code>useradd -g www www -s /bin/false</code></li>
</ul>
</li>
<li>安装依赖包<ul>
<li><code>yum install -y gcc gcc-c++ zlib zlib-devel openssl openssl-devel pcre pcre-devel</code></li>
<li><code>yum install -y libpng libjpeg libpng-devel libjpeg-devel ghostscript libtiff libtiff-devel freetype freetype-devel</code></li>
<li><code>yum install -y GraphicsMagick GraphicsMagick-devel</code></li>
</ul>
</li>
<li>下面的这些软件都在本文在开头的那个压缩包里面。现在我们需要解压这些压缩包<ul>
<li><code>cd /opt/setups</code></li>
<li><code>tar -zxvf nginx-1.8.0.tar.gz</code></li>
<li><code>tar -zxvf LuaJIT-2.0.4.tar.gz</code></li>
<li><code>tar -zxvf GraphicsMagick-1.3.21.tar.gz</code></li>
<li><code>tar -zxvf zlib-1.2.8.tar.gz</code></li>
</ul>
</li>
<li>安装 LuaJIT<ul>
<li><code>cd /opt/setups/LuaJIT-2.0.4</code></li>
<li><code>make</code></li>
<li><code>make install</code></li>
<li><code>export LUAJIT_LIB=/usr/local/lib</code></li>
<li><code>export LUAJIT_INC=/usr/local/include/luajit-2.0</code></li>
<li><code>ln -s /usr/local/lib/libluajit-5.1.so.2 /lib64/libluajit-5.1.so.2</code></li>
</ul>
</li>
<li>修改一些配置文件<ul>
<li>编辑 Nginx 模块的配置文件：<code>vim /opt/setups/fastdfs-nginx-module/src/config</code></li>
<li>找到下面一行包含有 <code>local</code> 字眼去掉，因为这三个路径根本不是在 local 目录下的。（如果你的配置文件没有这个 local，那这一步跳过）<pre><code class="nginx">CORE_INCS=&quot;$CORE_INCS /usr/local/include/fastdfs /usr/local/include/fastcommon/&quot;
</code></pre>
</li>
<li>改为如下：<pre><code class="nginx">CORE_INCS=&quot;$CORE_INCS /usr/include/fastdfs /usr/include/fastcommon/&quot;
</code></pre>
</li>
<li>复制文件：<code>cp /opt/setups/FastDFS/conf/http.conf /etc/fdfs</code></li>
<li>复制文件：<code>cp /opt/setups/FastDFS/conf/mime.types /etc/fdfs</code></li>
</ul>
</li>
<li>开始安装 Nginx<ul>
<li><code>cd /opt/setups/nginx-1.8.0</code></li>
<li><code>mkdir -p /usr/local/nginx /var/log/nginx /var/temp/nginx /var/lock/nginx</code></li>
<li>执行下面编译语句：<pre><code class="nginx">./configure --prefix=/usr/local/nginx \
--user=www \
--group=www \
--pid-path=/var/local/nginx/nginx.pid  \
--lock-path=/var/lock/nginx/nginx.lock \
--error-log-path=/var/log/nginx/error.log \
--http-log-path=/var/log/nginx/access.log \
--http-client-body-temp-path=/var/temp/nginx/client \
--http-proxy-temp-path=/var/temp/nginx/proxy \
--http-fastcgi-temp-path=/var/temp/nginx/fastcgi \
--http-uwsgi-temp-path=/var/temp/nginx/uwsgi \
--http-scgi-temp-path=/var/temp/nginx/scgi \
--sbin-path=/usr/local/nginx/sbin/nginx \
--with-http_ssl_module \
--with-http_realip_module \
--with-http_sub_module \
--with-http_flv_module \
--with-http_dav_module \
--with-http_gzip_static_module \
--with-http_stub_status_module \
--with-http_addition_module \
--with-http_spdy_module \
--with-pcre \
--with-zlib=/opt/setups/zlib-1.2.8 \
--add-module=/opt/setups/nginx-http-concat \
--add-module=/opt/setups/lua-nginx-module \
--add-module=/opt/setups/ngx_devel_kit \
--add-module=/opt/setups/fastdfs-nginx-module/src
</code></pre>
</li>
<li><code>make</code></li>
<li><code>make install</code></li>
</ul>
</li>
<li>修改一下配置<ul>
<li>复制 Nginx 模块的配置文件：<code>cp /opt/setups/fastdfs-nginx-module/src/mod_fastdfs.conf /etc/fdfs</code></li>
<li>编辑 Nginx 模块的配置文件：<code>vim /etc/fdfs/mod_fastdfs.conf</code>，编辑内容看下面中文注释</li>
<li>如果在已经启动 Nginx 的情况下修改下面内容记得要重启 Nginx。<pre><code class="ini">connect_timeout=2
network_timeout=30
# 下面这个路径是保存 log 的地方，需要我们改下，指向我们一个存在的目录
# 创建目录：mkdir -p /opt/fastdfs/fastdfs-nginx-module/data-and-log
base_path=/opt/fastdfs/fastdfs-nginx-module/data-and-log
load_fdfs_parameters_from_tracker=true
storage_sync_file_max_delay = 86400
use_storage_id = false
storage_ids_filename = storage_ids.conf
# 指定 tracker 服务器的 IP 和端口
tracker_server=192.168.1.114:22122
storage_server_port=23000
group_name=group1
# 因为我们访问图片的地址是：http://192.168.1.114/group1/M00/00/00/wKgBclb0aqWAbVNrAAAjn7_h9gM813_big.jpg
# 该地址前面是带有 /group1/M00，所以我们这里要使用 true，不然访问不到（原值是 false）
url_have_group_name = true
store_path_count=1
# 图片实际存放路径，如果有多个，这里可以有多行：
# store_path0=/opt/fastdfs/storage/images-data0
# store_path1=/opt/fastdfs/storage/images-data1
# store_path2=/opt/fastdfs/storage/images-data2
store_path0=/opt/fastdfs/storage/images-data
log_level=info
log_filename=
response_mode=proxy
if_alias_prefix=
flv_support = true
flv_extension = flv
group_count = 0
</code></pre>
</li>
<li>创建文件夹：<code>mkdir -p /opt/fastdfs/thumb</code></li>
<li>编辑 Nginx 配置文件</li>
<li><code>vim /usr/local/nginx/conf/nginx.conf</code><br>``` nginx<h1 id="注意这一行行，我特别加上了使用-root-用户去执行，不然有些日记目录没有权限访问"><a href="#注意这一行行，我特别加上了使用-root-用户去执行，不然有些日记目录没有权限访问" class="headerlink" title="注意这一行行，我特别加上了使用 root 用户去执行，不然有些日记目录没有权限访问"></a>注意这一行行，我特别加上了使用 root 用户去执行，不然有些日记目录没有权限访问</h1>user  root;<br>worker_processes  1;</li>
</ul>
</li>
</ul>
<pre><code>events {
    worker_connections  1024;
}


http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;

    keepalive_timeout  65;


    server{
        listen      80;
        server_name 192.168.1.112;

        set $img_thumbnail_root /opt/fastdfs/thumb; 
        set $img_file $img_thumbnail_root$uri;  

        # like：/pic/M00/xx/xx/xx.jpg_200x100.jpg
        # /group1/M00
        location ~* ^(\/(\w+)(\/M00)(.+\.(jpg|jpeg|gif|png))_(\d+)+x(\d+)+\.(jpg|jpeg|gif|png))$ {
                root $img_thumbnail_root;    
                set $fdfs_group_root /opt/fastdfs/storage/images-data/data; 

                # 如果缩略图不存在
                if (!-f $img_file) {   
                        add_header X-Powered-By &#39;Nginx+Lua+GraphicsMagick By Yanue&#39;;  
                        add_header file-path $request_filename;

                        set $request_filepath $fdfs_group_root$4;    
                        set $img_width $6;    
                        set $img_height $7;    
                        set $img_ext $5;     
                        content_by_lua_file /opt/setups/lua/cropSize.lua;   
                }
        }

        location /group1/M00 {
                alias /opt/fastdfs/storage/images-data/data;
                ngx_fastdfs_module;
        }

    }
}
```
- 启动 Nginx
    - 停掉防火墙：`service iptables stop`
    - 启动：`/usr/local/nginx/sbin/nginx`，启动完成 shell 是不会有输出的
    - 访问：`192.168.1.114`，如果能看到：`Welcome to nginx!`，即可表示安装成功
    - 检查 时候有 Nginx 进程：`ps aux | grep nginx`，正常是显示 3 个结果出来 
    - 刷新 Nginx 配置后重启：`/usr/local/nginx/sbin/nginx -s reload`
    - 停止 Nginx：`/usr/local/nginx/sbin/nginx -s stop`
    - 如果访问不了，或是出现其他信息看下错误立即：`vim /var/log/nginx/error.log`
</code></pre><h3 id="多机安装部署（CentOS-6-7-环境）"><a href="#多机安装部署（CentOS-6-7-环境）" class="headerlink" title="多机安装部署（CentOS 6.7 环境）"></a>多机安装部署（CentOS 6.7 环境）</h3><ul>
<li>多机部署的情况，对生成大小图的 Nginx 也有地方要修改。</li>
<li>资料：<a href="http://blog.csdn.net/ricciozhang/article/details/49402273" target="_blank" rel="external">http://blog.csdn.net/ricciozhang/article/details/49402273</a></li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://blog.csdn.net/ricciozhang/article/details/49402273" target="_blank" rel="external">fastdfs+nginx安装配置</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;FastDFS-结合-GraphicsMagick&quot;&gt;&lt;a href=&quot;#FastDFS-结合-GraphicsMagick&quot; class=&quot;headerlink&quot; title=&quot;FastDFS 结合 GraphicsMagick&quot;&gt;&lt;/a&gt;FastDFS 结合 GraphicsMagick&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>Bash 常用命令</title>
    <link href="//zeroto.tech/2017/11/22/Bash/"/>
    <id>//zeroto.tech/2017/11/22/Bash/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:24:02.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Bash-常用命令"><a href="#Bash-常用命令" class="headerlink" title="Bash 常用命令"></a>Bash 常用命令</h1><a id="more"></a>
<h2 id="基础常用命令"><a href="#基础常用命令" class="headerlink" title="基础常用命令"></a>基础常用命令</h2><ul>
<li><code>某个命令 --h</code>，对这个命令进行解释</li>
<li><code>某个命令 --help</code>，解释这个命令(更详细)</li>
<li><code>man某个命令</code>，文档式解释这个命令(更更详细)(执行该命令后,还可以按/+关键字进行查询结果的搜索)</li>
<li><code>Ctrl + c</code>，结束命令</li>
<li><code>TAB键</code>，自动补全命令（按一次自动补全，连续按两次，提示所有以输入开头字母的所有命令）</li>
<li><code>键盘上下键</code>，输入临近的历史命令</li>
<li><code>history</code>，查看所有的历史命令</li>
<li><code>Ctrl + r</code>，进入历史命令的搜索功能模式</li>
<li><code>clear</code>，清除屏幕里面的所有命令</li>
<li><code>pwd</code>，显示当前目录路径（常用）</li>
<li><code>firefox&amp;</code>，最后后面的 <strong>&amp;</strong> 符号，表示使用后台方式打开 Firefox，然后显示该进程的 PID 值</li>
<li><code>jobs</code>，查看后台运行的程序列表</li>
<li><code>ifconfig</code>，查看 IP 等信息（常用）</li>
<li><code>locate 搜索关键字</code>，快速搜索系统文件/文件夹（类似 Windows 上的 everything 索引式搜索）（常用）<ul>
<li><code>updatedb</code>，配合上面的 locate，给 locate 的索引更新（locate 默认是一天更新一次索引）（常用）</li>
</ul>
</li>
<li><code>date</code>，查看系统时间（常用）<ul>
<li><code>date -s20080103</code>，设置日期（常用）</li>
<li><code>date -s18:24</code>，设置时间，如果要同时更改 BIOS 时间，再执行 <code>hwclock --systohc</code>（常用）</li>
</ul>
</li>
<li><code>cal</code>，在终端中查看日历，肯定没有农历显示的</li>
<li><code>uptime</code>，查看系统已经运行了多久，当前有几个用户等信息（常用）</li>
<li><code>echo &quot;字符串内容&quot;</code>，输出 “字符串内容”</li>
<li><code>cat 文件路名</code>，显示文件内容（属于打印语句）</li>
<li><code>cat -n 文件名</code>，显示文件，并每一行内容都编号</li>
<li><code>more 文件名</code>，用分页的方式查看文件内容（按 space 翻下一页，按 <em>Ctrl + B</em> 返回上页）</li>
<li><code>less</code>文件名，用分页的方式查看文件内容（带上下翻页）<ul>
<li>按 <strong>j</strong> 向下移动，按 <strong>k</strong> 向上移动</li>
<li>按 <strong>/</strong> 后，输入要查找的字符串内容，可以对文件进行向下查询，如果存在多个结果可以按 <strong>n</strong> 调到下一个结果出</li>
<li>按 <strong>？</strong> 后，输入要查找的字符串内容，可以对文件进行向上查询，如果存在多个结果可以按 <strong>n</strong> 调到下一个结果出</li>
</ul>
</li>
<li><code>tail -200f 文件名</code>，查看文件被更新的新内容尾 200 行，如果文件还有在新增可以动态查看到（一般用于查看日记文件）</li>
<li><code>shutdown</code><ul>
<li><code>shutdown -hnow</code>，立即关机</li>
<li><code>shutdown -h+10</code>，10 分钟后关机</li>
<li><code>shutdown -h23:30</code>，23:30 关机</li>
<li><code>shutdown -rnew</code>，立即重启</li>
</ul>
</li>
<li><code>poweroff</code>，立即关机（常用）</li>
<li><code>reboot</code>，立即重启（常用）</li>
<li><code>zip mytest.zip /opt/test/</code>，把 /opt 目录下的 test/ 目录进行压缩，压缩成一个名叫 mytest 的 zip 文件<ul>
<li><code>unzip mytest.zip</code>，对 mytest.zip 这个文件进行解压，解压到当前所在目录</li>
<li><code>unzip mytest.zip -d /opt/setups/</code>，对 mytest.zip 这个文件进行解压，解压到 /opt/setups/ 目录下</li>
</ul>
</li>
<li><code>tar -cvf mytest.tar mytest/</code>，对 mytest/ 目录进行归档处理（归档和压缩不一样）</li>
<li><code>tar -xvf mytest.tar</code>，释放 mytest.tar 这个归档文件，释放到当前目录<ul>
<li><code>tar -xvf mytest.tar -C /opt/setups/</code>，释放 mytest.tar 这个归档文件，释放到 /opt/setups/ 目录下</li>
</ul>
</li>
<li><code>last</code>，显示最近登录的帐户及时间</li>
<li><code>lastlog</code>，显示系统所有用户各自在最近登录的记录，如果没有登录过的用户会显示 <strong>从未登陆过</strong></li>
<li><p><code>ls</code>，列出当前目录下的所有没有隐藏的文件 / 文件夹。</p>
<ul>
<li><code>ls -a</code>，列出包括以．号开头的隐藏文件 / 文件夹（也就是所有文件）</li>
<li><code>ls -R</code>，显示出目录下以及其所有子目录的文件 / 文件夹（递归地方式，不显示隐藏的文件）</li>
<li><code>ls -a -R</code>，显示出目录下以及其所有子目录的文件 / 文件夹（递归地方式，显示隐藏的文件）</li>
<li><p><code>ls -l</code>，列出目录下所有文件的权限、所有者、文件大小、修改时间及名称（也就是显示详细信息，不显示隐藏文件）。显示出来的效果如下：</p>
<pre><code class="nginx">  -rwxr-xr-x. 1 root root 4096 3月 26 10:57，其中最前面的 - 表示这是一个普通文件
  lrwxrwxrwx. 1 root root 4096 3月 26 10:57，其中最前面的 l 表示这是一个链接文件，类似 Windows 的快捷方式
  drwxr-xr-x. 5 root root 4096 3月 26 10:57，其中最前面的 d 表示这是一个目录
</code></pre>
</li>
<li><p><code>ls -ld 目录名</code>，显示该目录的基本信息</p>
</li>
<li><code>ls -t</code>，依照文件最后修改时间的顺序列出文件名。</li>
<li><code>ls -F</code>，列出当前目录下的文件名及其类型。以 <strong>/</strong> 结尾表示为目录名，以 <strong>*</strong> 结尾表示为可执行文件，以 <strong>@</strong> 结尾表示为符号连接</li>
<li><code>ls -lg</code>，同上，并显示出文件的所有者工作组名。</li>
<li><code>ls -lh</code>，查看文件夹类文件详细信息，文件大小，文件修改时间</li>
<li><code>ls /opt | head -5</code>，显示 opt 目录下前 5 条记录</li>
<li><code>ls -l /opt |grep &quot;^-&quot;|wc -l</code>，统计 opt 目录下文件的个数，不会递归统计</li>
<li><code>ls -lR /opt |grep &quot;^-&quot;|wc -l</code>，统计 opt 目录下文件的个数，会递归统计</li>
<li><code>ls -l /opt |grep &quot;^d&quot;|wc -l</code>，统计 opt 目录下目录的个数，不会递归统计</li>
<li><code>ls -lR /opt |grep &quot;^d&quot;|wc -l</code>，统计 opt 目录下目录的个数，会递归统计</li>
<li><code>ls -lR /opt |grep &quot;js&quot;|wc -l</code>，统计 opt 目录下 js 文件的个数，会递归统计</li>
</ul>
</li>
<li><code>cd</code>，目录切换<ul>
<li><code>cd ..</code>，改变目录位置至当前目录的父目录(上级目录)。</li>
<li><code>cd ~</code>，改变目录位置至用户登录时的工作目录。</li>
<li><code>cd 回车</code>，回到家目录</li>
<li><code>cd -</code>，上一个工作目录</li>
<li><code>cd dir1/</code>，改变目录位置至 dir1 目录下。</li>
<li><code>cd ~user</code>，改变目录位置至用户的工作目录。</li>
<li><code>cd ../user</code>，改变目录位置至相对路径user的目录下。</li>
<li><code>cd /../..</code>，改变目录位置至绝对路径的目录位置下。</li>
</ul>
</li>
<li><code>cp 源文件 目标文件</code>，复制文件<ul>
<li><code>cp -r 源文件夹 目标文件夹</code>，复制文件夹</li>
<li><code>cp -r -v 源文件夹 目标文件夹</code>，复制文件夹(显示详细信息，一般用于文件夹很大，需要查看复制进度的时候)</li>
<li><code>cp /usr/share/easy-rsa/2.0/keys/{ca.crt,server.{crt,key},dh2048.pem,ta.key} /etc/openvpn/keys/</code>，复制同目录下花括号中的文件</li>
</ul>
</li>
<li><code>tar cpf - . | tar xpf - -C /opt</code>，复制当前所有文件到 /opt 目录下，一般如果文件夹文件多的情况下用这个更好，用 cp 比较容易出问题</li>
<li><code>mv 文件 目标文件夹</code>，移动文件到目标文件夹<ul>
<li><code>mv 文件</code>，不指定目录重命名后的名字，用来重命名文件</li>
</ul>
</li>
<li><code>touch 文件名</code>，创建一个空白文件/更新已有文件的时间(后者少用)</li>
<li><code>mkdir 文件夹名</code>，创建文件夹</li>
<li><code>mkdir -p /opt/setups/nginx/conf/</code>，创建一个名为 conf 文件夹，如果它的上级目录 nginx 没有也会跟着一起生成，如果有则跳过</li>
<li><code>rmdir 文件夹名</code>，删除文件夹(只能删除文件夹里面是没有东西的文件夹)</li>
<li><code>rm 文件</code>，删除文件<ul>
<li><code>rm -r 文件夹</code>，删除文件夹</li>
<li><code>rm -r -i 文件夹</code>，在删除文件夹里的文件会提示(要的话,在提示后面输入yes)</li>
<li><code>rm -r -f 文件夹</code>，强制删除</li>
<li><code>rm -r -f 文件夹1/ 文件夹2/ 文件夹3/</code>删除多个</li>
</ul>
</li>
<li><code>find</code>，高级查找<ul>
<li><code>find . -name *lin*</code>，其中 . 代表在当前目录找，-name 表示匹配文件名 / 文件夹名，*lin* 用通配符搜索含有lin的文件或是文件夹</li>
<li><code>find . -iname *lin*</code>，其中 . 代表在当前目录找，-iname 表示匹配文件名 / 文件夹名（忽略大小写差异），*lin* 用通配符搜索含有lin的文件或是文件夹</li>
<li><code>find / -name *.conf</code>，其中 / 代表根目录查找，*.conf代表搜索后缀会.conf的文件</li>
<li><code>find /opt -name .oh-my-zsh</code>，其中 /opt 代表目录名，.oh-my-zsh 代表搜索的是隐藏文件 / 文件夹名字为 oh-my-zsh 的</li>
<li><code>find /opt -type f -iname .oh-my-zsh</code>，其中 /opt 代表目录名，-type f 代表只找文件，.oh-my-zsh 代表搜索的是隐藏文件名字为 oh-my-zsh 的</li>
<li><code>find /opt -type d -iname .oh-my-zsh</code>，其中 /opt 代表目录名，-type d 代表只找目录，.oh-my-zsh 代表搜索的是隐藏文件夹名字为 oh-my-zsh 的</li>
<li><code>find . -name &quot;lin*&quot; -execls -l{}\;</code>，当前目录搜索lin开头的文件，然后用其搜索后的结果集，再执行ls -l的命令（这个命令可变，其他命令也可以），其中 -exec 和 {}\; 都是固定格式</li>
</ul>
</li>
<li><code>cat /etc/resolv.conf</code>，查看 DNS 设置</li>
</ul>
<h2 id="用户、权限-相关命令"><a href="#用户、权限-相关命令" class="headerlink" title="用户、权限-相关命令"></a>用户、权限-相关命令</h2><ul>
<li><code>hostname</code>，查看当前登陆用户全名</li>
<li><code>cat /etc/group</code>，查看所有组</li>
<li><code>cat /etc/passwd</code>，查看所有用户</li>
<li><code>useradd youmeek -p 123456</code>，添加一个名为 youmeek 的用户，还有一个同名的组</li>
<li><code>userdel -r youmeek</code>，删除名字为 youmeek 的用户<ul>
<li>参数：<code>-r</code>，表示删除用户的时候连同用户的家目录一起删除</li>
</ul>
</li>
<li><p>修改普通用户 youmeek 的权限跟 root 权限一样：</p>
<ul>
<li><p>常用方法（原理是把该用户加到可以直接使用 sudo 的一个权限状态而已）：</p>
<ul>
<li>编辑配置文件：``</li>
<li><p>找到 98 行（预估），有一个：<code>root    ALL=(ALL)   ALL</code>，在这一行下面再增加一行，效果如下：</p>
<pre><code class="nginx">root    ALL=(ALL)   ALL
youmeek    ALL=(ALL)   ALL
</code></pre>
</li>
</ul>
</li>
<li><p>另一种方法：</p>
<ul>
<li>编辑系统用户的配置文件：<code>vim /etc/passwd</code>，找到 <strong>root</strong> 和 <strong>youmeek</strong> 各自开头的那一行，比如 root 是：<code>root:x:0:0:root:/root:/bin/zsh</code>，这个代表的含义为：<em>用户名:密码:UserId:GroupId:描述:家目录:登录使用的 shell</em></li>
<li>通过这两行对比，我们可以直接修改 youmeek 所在行的 UserId 值 和 GroupId 值，都改为 0。</li>
</ul>
</li>
</ul>
</li>
<li><code>groupadd judasn</code>，添加一个名为 judasn 的用户组</li>
<li><code>groupdel judasn</code>，删除一个名为 judasn 的用户组（前提：先删除组下面的所有用户）</li>
<li><code>passwd youmeek</code>，修改 youmeek 用户的密码（前提：只有 root 用户才有修改其他用户的权限，其他用户只能修改自己的）</li>
<li><code>chmod 777 文件名/目录</code>，给指定文件增加最高权限，系统中的所有人都可以进行读写。<ul>
<li>linux 的权限分为 rwx。r 代表：可读，w 代表：可写，x 代表：可执行</li>
<li>这三个权限都可以转换成数值表示，r = 4，w = 2，x = 1，- = 0，所以总和是 7，也就是最大权限。第一个 7 是所属主（user）的权限，第二个 7 是所属组（group）的权限，最后一位 7 是非本群组用户（others）的权限。</li>
</ul>
</li>
<li><code>su</code>：切换到 root 用户，终端目录还是原来的地方（常用）<ul>
<li><code>su -</code>：切换到 root 用户，其中 <strong>-</strong> 号另起一个终端并切换账号</li>
<li><code>su 用户名</code>，切换指定用户帐号登陆，终端目录还是原来地方。</li>
<li><code>su - 用户名</code>，切换到指定用户帐号登陆，其中 <strong>-</strong> 号另起一个终端并切换账号</li>
</ul>
</li>
<li><code>exit</code>，注销当前用户（常用）</li>
<li><code>sudo 某个命令</code>，使用管理员权限使用命令，使用 sudo 回车之后需要输入当前登录账号的密码。（常用）</li>
<li><code>passwd</code>，修改当前用户密码（常用）</li>
</ul>
<h2 id="磁盘管理"><a href="#磁盘管理" class="headerlink" title="磁盘管理"></a>磁盘管理</h2><ul>
<li><code>df -h</code>，自动以合适的磁盘容量单位查看磁盘大小和使用空间<ul>
<li><code>df -k</code>，以磁盘容量单位 K 为数值结果查看磁盘使用情况</li>
<li><code>df -m</code>，以磁盘容量单位 M 为数值结果查看磁盘使用情况</li>
</ul>
</li>
<li><code>du -sh /opt</code>，查看 opt 这个文件夹大小 （h 的意思 human-readable 用人类可读性较好方式显示，系统会自动调节单位，显示合适大小的单位）</li>
<li><code>du -sh ./*</code>，查看当前目录下所有文件夹大小 （h 的意思 human-readable 用人类可读性较好方式显示，系统会自动调节单位，显示合适大小的单位）</li>
<li><code>du -sh /opt/setups/</code>，显示 /opt/setups/ 目录所占硬盘空间大小（s 表示 –summarize 仅显示总计，即当前目录的大小。h 表示 –human-readable 以 KB，MB，GB 为单位，提高信息的可读性）</li>
<li><code>mount /dev/sdb5 /newDir/</code>，把分区 sdb5 挂载在根目录下的一个名为 newDir 的空目录下，需要注意的是：这个目录最好为空，不然已有的那些文件将看不到，除非卸载挂载。<ul>
<li>挂载好之后，通过：<code>df -h</code>，查看挂载情况。</li>
</ul>
</li>
<li><code>umount /newDir/</code>，卸载挂载，用目录名<ul>
<li>如果这样卸载不了可以使用：<code>umount -l /newDir/</code></li>
</ul>
</li>
<li><code>umount /dev/sdb5</code>，卸载挂载，用分区名</li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://wenku.baidu.com/view/1ad19bd226fff705cc170af3.html" target="_blank" rel="external">http://wenku.baidu.com/view/1ad19bd226fff705cc170af3.html</a></li>
<li><a href="http://blog.csdn.net/nzing/article/details/9166057" target="_blank" rel="external">http://blog.csdn.net/nzing/article/details/9166057</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Bash-常用命令&quot;&gt;&lt;a href=&quot;#Bash-常用命令&quot; class=&quot;headerlink&quot; title=&quot;Bash 常用命令&quot;&gt;&lt;/a&gt;Bash 常用命令&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>Crontab</title>
    <link href="//zeroto.tech/2017/11/22/Crontab/"/>
    <id>//zeroto.tech/2017/11/22/Crontab/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:32:27.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Crontab-介绍"><a href="#Crontab-介绍" class="headerlink" title="Crontab 介绍"></a>Crontab 介绍</h1><a id="more"></a>
<h2 id="Crontab-安装"><a href="#Crontab-安装" class="headerlink" title="Crontab 安装"></a>Crontab 安装</h2><ul>
<li><p>查看是否已安装：</p>
<ul>
<li>CentOS：<code>rpm -qa | grep cron</code></li>
<li>Ubuntu：<code>dpkg -l | grep cron</code></li>
</ul>
</li>
<li><p>安装（一般系统是集成的）：</p>
<ul>
<li>CentOS 6：<code>sudo yum install -y vixie-cron crontabs</code></li>
<li>Ubuntu：<code>sudo apt-get install -y cron</code></li>
</ul>
</li>
</ul>
<h2 id="Crontab-服务器配置文件常用参数"><a href="#Crontab-服务器配置文件常用参数" class="headerlink" title="Crontab 服务器配置文件常用参数"></a>Crontab 服务器配置文件常用参数</h2><ul>
<li>配置文件介绍（记得先备份）：<code>sudo vim /etc/crontab</code><ul>
<li>该配置格式解释：<ul>
<li><img src="images/Crontab-a-1.jpg" alt="Crontab 服务器配置文件常用参数"></li>
</ul>
</li>
<li>常用例子介绍：<ul>
<li>30 21 <em> </em> * service httpd restart         #每晚的 21:30 重启 apache</li>
<li>45 4 1,10,22 <em> </em> service httpd restart    #每月的 1、10、22 日的 4:45 重启 apache</li>
<li>45 4 1-10 <em> </em> service httpd restart       #每月的 1 到 10 日的 4:45 重启 apache</li>
<li><em>/2 </em> <em> </em> * service httpd restart         #每隔两分钟重启 apache</li>
<li>1-59/2 <em> </em> <em> </em> service httpd restart      #每隔两分钟重启 apache（这个比较特殊：1-59/2 这个表示过掉0分，从 1 分开始算，每隔两分执行，所以 1 分执行了，3 分执行了，5 分执行了….都是奇数进行执行。默认的 */2 都是偶数执行。）</li>
<li>0 23-7/2 <em> </em> * service httpd restart      #晚上 11 点到早上 7 点之间，每隔 2 个小时重启 apache</li>
<li>0-59/30 18-23 <em> </em> * service httpd restart #每天 18:00 到 23：00 之间，每隔 30 分钟重启 apache（方法一）</li>
<li>0,30 18-23 <em> </em> * service httpd restart    #每天 18:00 到 23：00 之间，每隔 30 分钟重启 apache（方法二）</li>
</ul>
</li>
</ul>
</li>
<li>执行记录日志：<code>cd /var/log/cron</code></li>
</ul>
<h2 id="Crontab-资料"><a href="#Crontab-资料" class="headerlink" title="Crontab 资料"></a>Crontab 资料</h2><ul>
<li><a href="http://www.imooc.com/video/4498" target="_blank" rel="external">http://www.imooc.com/video/4498</a> </li>
<li><a href="http://www.centoscn.com/image-text/config/2015/0901/6096.html" target="_blank" rel="external">http://www.centoscn.com/image-text/config/2015/0901/6096.html</a> </li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Crontab-介绍&quot;&gt;&lt;a href=&quot;#Crontab-介绍&quot; class=&quot;headerlink&quot; title=&quot;Crontab 介绍&quot;&gt;&lt;/a&gt;Crontab 介绍&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>MySQL 安装和配置</title>
    <link href="//zeroto.tech/2017/11/22/Mysql-Install-And-Settings/"/>
    <id>//zeroto.tech/2017/11/22/Mysql-Install-And-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:47:02.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MySQL-安装和配置"><a href="#MySQL-安装和配置" class="headerlink" title="MySQL 安装和配置"></a>MySQL 安装和配置</h1><a id="more"></a>
<h2 id="MySQL-安装"><a href="#MySQL-安装" class="headerlink" title="MySQL 安装"></a>MySQL 安装</h2><ul>
<li>Mysql 安装<ul>
<li>官网：<a href="http://www.mysql.com/" target="_blank" rel="external">http://www.mysql.com/</a></li>
<li>官网下载：<a href="http://dev.mysql.com/downloads/mysql/" target="_blank" rel="external">http://dev.mysql.com/downloads/mysql/</a></li>
<li>官网 5.5 下载：<a href="http://dev.mysql.com/downloads/mysql/5.5.html#downloads" target="_blank" rel="external">http://dev.mysql.com/downloads/mysql/5.5.html#downloads</a></li>
<li>官网 5.6 下载：<a href="http://dev.mysql.com/downloads/mysql/5.6.html#downloads" target="_blank" rel="external">http://dev.mysql.com/downloads/mysql/5.6.html#downloads</a></li>
<li>官网 5.7 下载：<a href="http://dev.mysql.com/downloads/mysql/5.7.html#downloads" target="_blank" rel="external">http://dev.mysql.com/downloads/mysql/5.7.html#downloads</a></li>
<li>官网帮助中心：<a href="http://dev.mysql.com/doc/refman/5.6/en/source-installation.html" target="_blank" rel="external">http://dev.mysql.com/doc/refman/5.6/en/source-installation.html</a></li>
<li>此时（20160210） Mysql 5.5 最新版本为：<strong>5.5.48</strong></li>
<li>此时（20160210） Mysql 5.6 最新版本为：<strong>5.6.29</strong></li>
<li>此时（20160210） Mysql 5.7 最新版本为：<strong>5.7.11</strong></li>
<li>我个人习惯 <code>/opt</code> 目录下创建一个目录 <code>setups</code> 用来存放各种软件安装包；在 <code>/usr</code> 目录下创建一个 <code>program</code> 用来存放各种解压后的软件包，下面的讲解也都是基于此习惯</li>
<li>我个人已经使用了第三方源：<code>EPEL、RepoForge</code>，如果你出现 <code>yum install XXXXX</code> 安装不成功的话，很有可能就是你没有相关源，请查看我对源设置的文章</li>
<li>Mysql 5.6 下载：<code>wget http://dev.mysql.com/get/Downloads/MySQL-5.6/mysql-5.6.29.tar.gz</code> （大小：31 M）</li>
<li>Mysql 5.7 下载：<code>wget http://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.11.tar.gz</code> （大小：47 M）</li>
<li>我们这次安装以 5.6 为实例<ul>
<li>进入下载目录：<code>cd /opt/setups</code></li>
<li>解压压缩包：<code>tar zxvf mysql-5.6.29.tar.gz</code></li>
<li>移到解压包：<code>mv /opt/setups/mysql-5.6.29 /usr/program/</code></li>
<li>安装依赖包、编译包：<code>yum install -y make gcc-c++ cmake bison-devel  ncurses-devel</code></li>
<li>进入解压目录：<code>cd /usr/program/mysql-5.6.29/</code></li>
<li>生成安装目录：<code>mkdir -p /usr/program/mysql/data</code></li>
<li>生成配置（使用 InnoDB）：<code>sudo cmake -DCMAKE_INSTALL_PREFIX=/usr/program/mysql -DMYSQL_DATADIR=/usr/program/mysql/data -DMYSQL_UNIX_ADDR=/tmp/mysql.sock -DDEFAULT_CHARSET=utf8 -DDEFAULT_COLLATION=utf8_general_ci -DWITH_EXTRA_CHARSETS:STRING=utf8 -DWITH_MYISAM_STORAGE_ENGINE=1 -DWITH_INNOBASE_STORAGE_ENGINE=1 -DENABLED_LOCAL_INFILE=1</code><ul>
<li>更多参数说明可以查看：<a href="http://dev.mysql.com/doc/refman/5.6/en/source-configuration-options.html" target="_blank" rel="external">http://dev.mysql.com/doc/refman/5.6/en/source-configuration-options.html</a></li>
</ul>
</li>
<li>编译：<code>sudo make</code>，这个过程比较漫长，一般都在 30 分钟左右，具体还得看机子配置，如果最后结果有 error，建议删除整个 mysql 目录后重新解压一个出来继续处理</li>
<li>安装：<code>sudo make install</code></li>
<li>配置开机启动：<ul>
<li><code>sudo cp /usr/program/mysql-5.6.29/support-files/mysql.server  /etc/init.d/mysql</code></li>
<li><code>sudo chmod 755 /etc/init.d/mysql</code></li>
<li><code>sudo chkconfig mysql on</code></li>
</ul>
</li>
<li>复制一份配置文件： <code>sudo cp /usr/program/mysql-5.6.29/support-files/my-default.cnf /etc/my.cnf</code></li>
<li>删除安装的目录：<code>rm -rf /usr/program/mysql-5.6.29/</code></li>
<li>添加组和用户及安装目录权限<ul>
<li><code>sudo groupadd mysql</code> #添加组</li>
<li><code>sudo useradd -g mysql mysql -s /bin/false</code> #创建用户mysql并加入到mysql组，不允许mysql用户直接登录系统</li>
<li><code>sudo chown -R mysql:mysql /usr/program/mysql/data</code> #设置MySQL数据库目录权限</li>
</ul>
</li>
<li>初始化数据库：<code>sudo /usr/program/mysql/scripts/mysql_install_db --basedir=/usr/program/mysql --datadir=/usr/program/mysql/data --skip-name-resolve --user=mysql</code></li>
<li>开放防火墙端口：<ul>
<li><code>sudo iptables -I INPUT -p tcp -m tcp --dport 3306 -j ACCEPT</code></li>
<li><code>sudo service iptables save</code></li>
<li><code>sudo service iptables restart</code></li>
</ul>
</li>
<li>禁用 selinux<ul>
<li>编辑配置文件：<code>vim /etc/selinux/config</code></li>
<li>把 <code>SELINUX=enforcing</code> 改为 <code>SELINUX=disabled</code></li>
</ul>
</li>
<li>常用命令软连接，才可以在终端直接使用：mysql 和 mysqladmin 命令<ul>
<li><code>sudo ln -s /usr/program/mysql/bin/mysql /usr/bin</code></li>
<li><code>sudo ln -s /usr/program/mysql/bin/mysqladmin /usr/bin</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="MySQL-配置"><a href="#MySQL-配置" class="headerlink" title="MySQL 配置"></a>MySQL 配置</h2><ul>
<li>官网配置参数解释：<a href="http://dev.mysql.com/doc/refman/5.6/en/mysqld-option-tables.html" target="_blank" rel="external">http://dev.mysql.com/doc/refman/5.6/en/mysqld-option-tables.html</a></li>
<li>找一下当前系统中有多少个 my.cnf 文件：<code>find / -name &quot;my.cnf&quot;</code>，我查到的结果：</li>
</ul>
<pre><code class="nginx">/etc/my.cnf
/usr/program/mysql/my.cnf
/usr/program/mysql/mysql-test/suite/ndb/my.cnf
/usr/program/mysql/mysql-test/suite/ndb_big/my.cnf
.............
/usr/program/mysql/mysql-test/suite/ndb_rpl/my.cnf
</code></pre>
<ul>
<li>保留 <strong>/etc/my.cnf</strong> 和 <strong>/usr/program/mysql/mysql-test/</strong> 目录下配置文件，其他删除掉。</li>
<li>我整理的一个单机版配置说明（MySQL 5.6，适用于 1G 内存的服务器）：<ul>
<li><a href="MySQL-Settings/MySQL-5.6/1G-Memory-Machine/my-for-comprehensive.cnf">my.cnf</a></li>
</ul>
</li>
</ul>
<h2 id="修改-root-账号密码"><a href="#修改-root-账号密码" class="headerlink" title="修改 root 账号密码"></a>修改 root 账号密码</h2><ul>
<li>启动 Mysql 服务器：<code>service mysql start</code></li>
<li>查看是否已经启动了：<code>ps aux | grep mysql</code></li>
<li>默认安装情况下，root 的密码是空，所以为了方便我们可以设置一个密码，假设我设置为：123456</li>
<li>终端下执行：<code>mysql -uroot</code><ul>
<li>现在进入了 mysql 命令行管理界面，输入：<code>SET PASSWORD = PASSWORD(&#39;123456&#39;);</code></li>
</ul>
</li>
<li>修改密码后，终端下执行：<code>mysql -uroot -p</code><ul>
<li>根据提示，输入密码进度 mysql 命令行状态。</li>
</ul>
</li>
<li>如果你在其他机子上连接该数据库机子报：<strong>Access denied for user ‘root’@’localhost’ (using password: YES)</strong><ul>
<li>解决办法：</li>
<li>在终端中执行：<code>service mysql stop</code></li>
<li>在终端中执行：<code>/usr/program/mysql/bin/mysqld --skip-grant-tables</code><ul>
<li>此时 MySQL 服务会一直处于监听状态，你需要另起一个终端窗口来执行接下来的操作</li>
<li>在终端中执行：<code>mysql -u root mysql</code></li>
<li>进入 MySQL 命令后执行：<code>UPDATE user SET Password=PASSWORD(&#39;填写你要的新密码&#39;) where USER=&#39;root&#39;;FLUSH PRIVILEGES;</code></li>
<li>重启 MySQL 服务：<code>service mysql restart</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="MySQL-主从复制"><a href="#MySQL-主从复制" class="headerlink" title="MySQL 主从复制"></a>MySQL 主从复制</h2><h3 id="环境说明和注意点"><a href="#环境说明和注意点" class="headerlink" title="环境说明和注意点"></a>环境说明和注意点</h3><ul>
<li>假设有两台服务器，一台做主，一台做从<ul>
<li>MySQL 主信息：<ul>
<li>IP：<strong>12.168.1.113</strong></li>
<li>端口：<strong>3306</strong></li>
</ul>
</li>
<li>MySQL 从信息：<ul>
<li>IP：<strong>12.168.1.115</strong></li>
<li>端口：<strong>3306</strong></li>
</ul>
</li>
</ul>
</li>
<li>注意点<ul>
<li>主 DB server 和从 DB server 数据库的版本一致</li>
<li>主 DB server 和从 DB server 数据库数据一致</li>
<li>主 DB server 开启二进制日志，主 DB server 和从 DB server 的 server-id 都必须唯一</li>
</ul>
</li>
<li>优先操作：<ul>
<li><strong>把主库的数据库复制到从库并导入</strong></li>
</ul>
</li>
</ul>
<h3 id="主库机子操作"><a href="#主库机子操作" class="headerlink" title="主库机子操作"></a>主库机子操作</h3><ul>
<li><p>主库操作步骤</p>
<ul>
<li>创建一个目录：<code>mkdir -p /usr/program/mysql/data/mysql-bin</code></li>
<li>主 DB 开启二进制日志功能：<code>vim /etc/my.cnf</code>，<ul>
<li>添加一行：<code>log-bin = /usr/program/mysql/data/mysql-bin</code></li>
<li>指定同步的数据库，如果不指定则同步全部数据库，其中 ssm 是我的数据库名：<code>binlog-do-db=ssm</code></li>
</ul>
</li>
<li>主库关掉慢查询记录，用 SQL 语句查看当前是否开启：<code>SHOW VARIABLES LIKE &#39;%slow_query_log%&#39;;</code>，如果显示 OFF 则表示关闭，ON 表示开启</li>
<li>重启主库 MySQL 服务</li>
<li>进入 MySQL 命令行状态，执行 SQL 语句查询状态：<code>SHOW MASTER STATUS;</code><ul>
<li>在显示的结果中，我们需要记录下 <strong>File</strong> 和 <strong>Position</strong> 值，等下从库配置有用。</li>
</ul>
</li>
<li><p>设置授权用户 slave01 使用 123456 密码登录主库，这里 @ 后的 IP 为从库机子的 IP 地址，如果从库的机子有多个，我们需要多个这个 SQL 语句。</p>
<pre><code class="SQL">grant replication slave on *.* to &#39;slave01&#39;@&#39;192.168.1.135&#39; identified by &#39;123456&#39;;
flush privileges;
</code></pre>
</li>
</ul>
</li>
</ul>
<h3 id="从库机子操作"><a href="#从库机子操作" class="headerlink" title="从库机子操作"></a>从库机子操作</h3><ul>
<li><p>从库操作步骤</p>
<ul>
<li>从库开启慢查询记录，用 SQL 语句查看当前是否开启：<code>SHOW VARIABLES LIKE &#39;%slow_query_log%&#39;;</code>，如果显示 OFF 则表示关闭，ON 表示开启。</li>
<li>测试从库机子是否能连上主库机子：<code>sudo mysql -h 192.168.1.105 -u slave01 -p</code>，必须要连上下面的操作才有意义。<ul>
<li>由于不能排除是不是系统防火墙的问题，所以建议连不上临时关掉防火墙：<code>service iptables stop</code></li>
<li>或是添加防火墙规则：<ul>
<li>添加规则：<code>sudo iptables -I INPUT -p tcp -m tcp --dport 3306 -j ACCEPT</code></li>
<li>保存规则：<code>sudo service iptables save</code></li>
<li>重启 iptables：<code>sudo service iptables restart</code></li>
</ul>
</li>
</ul>
</li>
<li>修改配置文件：<code>vim /etc/my.cnf</code>，把 server-id 改为跟主库不一样</li>
<li><p>在进入 MySQL 的命令行状态下，输入下面 SQL：</p>
<pre><code class="SQL">CHANGE MASTER TO
master_host=&#39;192.168.1.113&#39;,
master_user=&#39;slave01&#39;,
master_password=&#39;123456&#39;,
master_port=3306,
master_log_file=&#39;mysql3306-bin.000006&#39;,&gt;&gt;&gt;这个值复制刚刚让你记录的值
master_log_pos=1120;&gt;&gt;&gt;这个值复制刚刚让你记录的值
</code></pre>
</li>
</ul>
</li>
<li><p>执行该 SQL 语句，启动 slave 同步：<code>START SLAVE;</code></p>
</li>
<li>执行该 SQL 语句，查看从库机子同步状态：<code>SHOW SLAVE STATUS;</code></li>
<li>在查看结果中必须下面两个值都是 Yes 才表示配置成功：<ul>
<li><code>Slave_IO_Running:Yes</code><ul>
<li>如果不是 Yes 也不是 No，而是 Connecting，那就表示从机连不上主库，需要你进一步排查连接问题。</li>
</ul>
</li>
<li><code>Slave_SQL_Running:Yes</code></li>
</ul>
</li>
<li>如果你的 Slave_IO_Running 是 No，一般如果你是在虚拟机上测试的话，从库的虚拟机是从主库的虚拟机上复制过来的，那一般都会这样的，因为两台的 MySQL 的 UUID 值一样。你可以检查从库下的错误日志：<code>cat /usr/program/mysql/data/mysql-error.log</code><ul>
<li>如果里面提示 uuid 错误，你可以编辑从库的这个配置文件：<code>vim /usr/program/mysql/data/auto.cnf</code>，把配置文件中的：server-uuid 值随便改一下，保证和主库是不一样即可。</li>
</ul>
</li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://www.cnblogs.com/xiongpq/p/3384681.html" target="_blank" rel="external">http://www.cnblogs.com/xiongpq/p/3384681.html</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;MySQL-安装和配置&quot;&gt;&lt;a href=&quot;#MySQL-安装和配置&quot; class=&quot;headerlink&quot; title=&quot;MySQL 安装和配置&quot;&gt;&lt;/a&gt;MySQL 安装和配置&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>Maven 安装和配置</title>
    <link href="//zeroto.tech/2017/11/22/Maven-Install-And-Settings/"/>
    <id>//zeroto.tech/2017/11/22/Maven-Install-And-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:46:13.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Maven-安装和配置"><a href="#Maven-安装和配置" class="headerlink" title="Maven 安装和配置"></a>Maven 安装和配置</h1><a id="more"></a>
<h2 id="Maven-安装"><a href="#Maven-安装" class="headerlink" title="Maven 安装"></a>Maven 安装</h2><ul>
<li><p>Maven 安装</p>
<ul>
<li>官网：<a href="http://maven.apache.org/" target="_blank" rel="external">http://maven.apache.org/</a></li>
<li>官网下载：<a href="http://maven.apache.org/download.cgi" target="_blank" rel="external">http://maven.apache.org/download.cgi</a></li>
<li>历史版本下载：<a href="https://archive.apache.org/dist/maven/binaries/" target="_blank" rel="external">https://archive.apache.org/dist/maven/binaries/</a></li>
<li>此时（20160208） Maven 最新版本为：<strong>3.3.9</strong></li>
<li>Maven 3.3 的 JDK 最低要求是 JDK 7</li>
<li>我个人习惯 <code>/opt</code> 目录下创建一个目录 <code>setups</code> 用来存放各种软件安装包；在 <code>/usr</code> 目录下创建一个 <code>program</code> 用来存放各种解压后的软件包，下面的讲解也都是基于此习惯</li>
<li>我个人已经使用了第三方源：<code>EPEL、RepoForge</code>，如果你出现 <code>yum install XXXXX</code> 安装不成功的话，很有可能就是你没有相关源，请查看我对源设置的文章</li>
<li>下载压缩包：<code>wget http://mirrors.cnnic.cn/apache/maven/maven-3/3.3.9/binaries/apache-maven-3.3.9-bin.tar.gz</code></li>
<li>解压：<code>tar zxvf apache-maven-3.3.9-bin.tar.gz</code></li>
<li>修改目录名，默认的太长了：<code>mv apache-maven-3.3.9/ maven3.3.9/</code></li>
<li>移到我个人习惯的安装目录下：<code>mv maven3.3.9/ /usr/program</code></li>
<li>环境变量设置：<code>vim /etc/profile</code></li>
<li><p>在文件最尾巴添加下面内容：</p>
<pre><code class="ini"># Maven
MAVEN_HOME=/usr/program/maven3.3.9
PATH=$PATH:$MAVEN_HOME/bin
MAVEN_OPTS=&quot;-Xms256m -Xmx356m&quot;
export MAVEN_HOME
export PATH
export MAVEN_OPTS
</code></pre>
</li>
<li><p>刷新配置文件：<code>source /etc/profile</code></p>
</li>
<li>测试是否安装成功：<code>mvn -version</code></li>
</ul>
</li>
</ul>
<h2 id="Maven-配置"><a href="#Maven-配置" class="headerlink" title="Maven 配置"></a>Maven 配置</h2><ul>
<li>配置项目连接上私服</li>
<li>全局方式配置：</li>
</ul>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;

&lt;settings xmlns=&quot;http://maven.apache.org/SETTINGS/1.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;&gt;

    &lt;!--本地仓库位置--&gt;
    &lt;localRepository&gt;D:/maven/my_local_repository&lt;/localRepository&gt;

    &lt;pluginGroups&gt;
    &lt;/pluginGroups&gt;

    &lt;proxies&gt;
    &lt;/proxies&gt;

    &lt;!--设置 Nexus 认证信息--&gt;
    &lt;servers&gt;
        &lt;server&gt;
            &lt;id&gt;nexus-releases&lt;/id&gt;
            &lt;username&gt;admin&lt;/username&gt;
            &lt;password&gt;admin123&lt;/password&gt;
        &lt;/server&gt;
        &lt;server&gt;
            &lt;id&gt;nexus-snapshots&lt;/id&gt;
            &lt;username&gt;admin&lt;/username&gt;
            &lt;password&gt;admin123&lt;/password&gt;
        &lt;/server&gt;
    &lt;/servers&gt;

    &lt;!--设置 Nexus 镜像，后面只要本地没对应的以来，则到 Nexus 去找--&gt;
    &lt;mirrors&gt;
        &lt;mirror&gt;
            &lt;id&gt;nexus-releases&lt;/id&gt;
            &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;
            &lt;url&gt;http://localhost:8081/nexus/content/groups/public&lt;/url&gt;
        &lt;/mirror&gt;
        &lt;mirror&gt;
            &lt;id&gt;nexus-snapshots&lt;/id&gt;
            &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;
            &lt;url&gt;http://localhost:8081/nexus/content/groups/public-snapshots&lt;/url&gt;
        &lt;/mirror&gt;
    &lt;/mirrors&gt;


    &lt;profiles&gt;
        &lt;profile&gt;
            &lt;id&gt;nexus&lt;/id&gt;
            &lt;repositories&gt;
                &lt;repository&gt;
                    &lt;id&gt;nexus-releases&lt;/id&gt;
                    &lt;url&gt;http://nexus-releases&lt;/url&gt;
                    &lt;releases&gt;
                        &lt;enabled&gt;true&lt;/enabled&gt;
                    &lt;/releases&gt;
                    &lt;snapshots&gt;
                        &lt;enabled&gt;true&lt;/enabled&gt;
                    &lt;/snapshots&gt;
                &lt;/repository&gt;
                &lt;repository&gt;
                    &lt;id&gt;nexus-snapshots&lt;/id&gt;
                    &lt;url&gt;http://nexus-snapshots&lt;/url&gt;
                    &lt;releases&gt;
                        &lt;enabled&gt;true&lt;/enabled&gt;
                    &lt;/releases&gt;
                    &lt;snapshots&gt;
                        &lt;enabled&gt;true&lt;/enabled&gt;
                    &lt;/snapshots&gt;
                &lt;/repository&gt;
            &lt;/repositories&gt;
            &lt;pluginRepositories&gt;
                &lt;pluginRepository&gt;
                    &lt;id&gt;nexus-releases&lt;/id&gt;
                    &lt;url&gt;http://nexus-releases&lt;/url&gt;
                    &lt;releases&gt;
                        &lt;enabled&gt;true&lt;/enabled&gt;
                    &lt;/releases&gt;
                    &lt;snapshots&gt;
                        &lt;enabled&gt;true&lt;/enabled&gt;
                    &lt;/snapshots&gt;
                &lt;/pluginRepository&gt;
                &lt;pluginRepository&gt;
                    &lt;id&gt;nexus-snapshots&lt;/id&gt;
                    &lt;url&gt;http://nexus-snapshots&lt;/url&gt;
                    &lt;releases&gt;
                        &lt;enabled&gt;true&lt;/enabled&gt;
                    &lt;/releases&gt;
                    &lt;snapshots&gt;
                        &lt;enabled&gt;true&lt;/enabled&gt;
                    &lt;/snapshots&gt;
                &lt;/pluginRepository&gt;
            &lt;/pluginRepositories&gt;
        &lt;/profile&gt;
    &lt;/profiles&gt;

    &lt;activeProfiles&gt;
        &lt;activeProfile&gt;nexus&lt;/activeProfile&gt;
    &lt;/activeProfiles&gt;

&lt;/settings&gt;
</code></pre>
<ul>
<li>项目级别：</li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://maven.apache.org/install.html" target="_blank" rel="external">http://maven.apache.org/install.html</a></li>
<li><a href="http://www.tutorialspoint.com/maven/index.htm" target="_blank" rel="external">http://www.tutorialspoint.com/maven/index.htm</a></li>
<li><a href="http://maven.apache.org/guides/getting-started/maven-in-five-minutes.html" target="_blank" rel="external">http://maven.apache.org/guides/getting-started/maven-in-five-minutes.html</a></li>
<li><a href="http://maven.apache.org/guides/getting-started/index.html" target="_blank" rel="external">http://maven.apache.org/guides/getting-started/index.html</a></li>
<li><a href="http://maven.apache.org/general.html" target="_blank" rel="external">http://maven.apache.org/general.html</a></li>
<li><a href="http://stackoverflow.com/questions/6950346/infrastructure-with-maven-jenkins-nexus" target="_blank" rel="external">http://stackoverflow.com/questions/6950346/infrastructure-with-maven-jenkins-nexus</a></li>
<li><a href="http://blog.csdn.net/sxyx2008/article/details/7975129" target="_blank" rel="external">http://blog.csdn.net/sxyx2008/article/details/7975129</a></li>
<li><a href="http://blog.csdn.net/xuke6677/article/details/8482472" target="_blank" rel="external">http://blog.csdn.net/xuke6677/article/details/8482472</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Maven-安装和配置&quot;&gt;&lt;a href=&quot;#Maven-安装和配置&quot; class=&quot;headerlink&quot; title=&quot;Maven 安装和配置&quot;&gt;&lt;/a&gt;Maven 安装和配置&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>NTP</title>
    <link href="//zeroto.tech/2017/11/22/NTP/"/>
    <id>//zeroto.tech/2017/11/22/NTP/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:52:40.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NTP（Network-Time-Protocol）介绍"><a href="#NTP（Network-Time-Protocol）介绍" class="headerlink" title="NTP（Network Time Protocol）介绍"></a>NTP（Network Time Protocol）介绍</h1><a id="more"></a>
<h2 id="NTP-安装"><a href="#NTP-安装" class="headerlink" title="NTP 安装"></a>NTP 安装</h2><ul>
<li><p>查看是否已安装：</p>
<ul>
<li>CentOS：<code>rpm -qa | grep ntp-*</code></li>
<li>Ubuntu：<code>dpkg -l | grep ntp-*</code></li>
</ul>
</li>
<li><p>安装：</p>
<ul>
<li>CentOS 6：<code>sudo yum install -y ntp</code></li>
<li>Ubuntu：<code>sudo apt-get install -y ntp</code></li>
</ul>
</li>
</ul>
<h2 id="NTP-服务器配置文件常用参数"><a href="#NTP-服务器配置文件常用参数" class="headerlink" title="NTP 服务器配置文件常用参数"></a>NTP 服务器配置文件常用参数</h2><ul>
<li>世界上可以校对时间节点：<a href="http://www.pool.ntp.org/zh" target="_blank" rel="external">http://www.pool.ntp.org/zh</a> </li>
<li>中国时间校对服务器节点：<a href="http://www.pool.ntp.org/zone/cn" target="_blank" rel="external">http://www.pool.ntp.org/zone/cn</a> </li>
<li>配置文件介绍（记得先备份）：<code>sudo vim /etc/ntp.conf</code><ul>
<li><img src="images/NTP-a-1.jpg" alt="NTP 服务器配置文件常用参数"></li>
<li>该配置解释：<ul>
<li>标注 1 是默认内容，我们这里进行了注释。</li>
<li>标注 2 是新增内容，表示使用中国时间校对服务器节点地址。<pre><code class="nginx">server 0.asia.pool.ntp.org
server 1.asia.pool.ntp.org
server 2.asia.pool.ntp.org
server 3.asia.pool.ntp.org
</code></pre>
</li>
</ul>
</li>
</ul>
</li>
<li>启动服务：<ul>
<li><code>sudo service ntpd start</code></li>
</ul>
</li>
<li>服务加到启动项<ul>
<li>CentOS 系统<ul>
<li><code>sudo chkconfig ntpd on</code></li>
</ul>
</li>
<li>Ubuntu 系统<ul>
<li><code>sudo apt-get install -y sysv-rc-conf</code></li>
<li><code>sudo sysv-rc-conf ntpd on</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="NTP-资料"><a href="#NTP-资料" class="headerlink" title="NTP 资料"></a>NTP 资料</h2><ul>
<li><a href="http://www.jikexueyuan.com/course/1710.html" target="_blank" rel="external">http://www.jikexueyuan.com/course/1710.html</a> </li>
<li><a href="http://www.pool.ntp.org/zh" target="_blank" rel="external">http://www.pool.ntp.org/zh</a> </li>
<li><a href="http://blog.kissdata.com/2014/10/28/ubuntu-ntp.html" target="_blank" rel="external">http://blog.kissdata.com/2014/10/28/ubuntu-ntp.html</a> </li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;NTP（Network-Time-Protocol）介绍&quot;&gt;&lt;a href=&quot;#NTP（Network-Time-Protocol）介绍&quot; class=&quot;headerlink&quot; title=&quot;NTP（Network Time Protocol）介绍&quot;&gt;&lt;/a&gt;NTP（Network Time Protocol）介绍&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="//zeroto.tech/2017/11/22/centos-settings/Clear-Tmp-Directory/"/>
    <id>//zeroto.tech/2017/11/22/centos-settings/Clear-Tmp-Directory/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2017-11-22T09:32:19.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="修改定时清理-tmp-目录下的文件"><a href="#修改定时清理-tmp-目录下的文件" class="headerlink" title="修改定时清理 /tmp 目录下的文件"></a>修改定时清理 /tmp 目录下的文件</h2><h2 id="初衷"><a href="#初衷" class="headerlink" title="初衷"></a>初衷</h2><ul>
<li>默认系统是超过 30 天不访问的文件自动清除的，但是有时候硬盘用得紧可以考虑修改周期</li>
</ul>
<h2 id="设置方法"><a href="#设置方法" class="headerlink" title="设置方法"></a>设置方法</h2><ul>
<li>编辑配置文件：<code>vim /etc/cron.daily/tmpwatch</code></li>
</ul>
<pre><code class="nginx">#! /bin/sh
flags=-umc
/usr/sbin/tmpwatch &quot;$flags&quot; -x /tmp/.X11-unix -x /tmp/.XIM-unix \
        -x /tmp/.font-unix -x /tmp/.ICE-unix -x /tmp/.Test-unix \
        -X &#39;/tmp/hsperfdata_*&#39; 10d /tmp
/usr/sbin/tmpwatch &quot;$flags&quot; 30d /var/tmp
for d in /var/{cache/man,catman}/{cat?,X11R6/cat?,local/cat?}; do
    if [ -d &quot;$d&quot; ]; then
        /usr/sbin/tmpwatch &quot;$flags&quot; -f 30d &quot;$d&quot;
    fi
done
</code></pre>
<ul>
<li>上面这句话：<code>/usr/sbin/tmpwatch &quot;$flags&quot; -f 30d &quot;$d&quot;</code>，其中 <strong>30d</strong> 表示 30 天表示要备删除的周期文件，该值最低为 1。</li>
<li>一般数据建议不要放在这个目录下，以免被系统误删</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;修改定时清理-tmp-目录下的文件&quot;&gt;&lt;a href=&quot;#修改定时清理-tmp-目录下的文件&quot; class=&quot;headerlink&quot; title=&quot;修改定时清理 /tmp 目录下的文件&quot;&gt;&lt;/a&gt;修改定时清理 /tmp 目录下的文件&lt;/h2&gt;&lt;h2 id=&quot;初衷&quot;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Nexus 安装和配置</title>
    <link href="//zeroto.tech/2017/11/22/Nexus-Install-And-Settings/"/>
    <id>//zeroto.tech/2017/11/22/Nexus-Install-And-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T07:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Nexus-安装和配置"><a href="#Nexus-安装和配置" class="headerlink" title="Nexus 安装和配置"></a>Nexus 安装和配置</h1><a id="more"></a>
<h2 id="Nexus-安装"><a href="#Nexus-安装" class="headerlink" title="Nexus 安装"></a>Nexus 安装</h2><ul>
<li><p>Nexus 安装</p>
<ul>
<li>官网：<a href="http://www.sonatype.org/nexus/" target="_blank" rel="external">http://www.sonatype.org/nexus/</a></li>
<li>官网下载：<a href="http://www.sonatype.org/nexus/archived/" target="_blank" rel="external">http://www.sonatype.org/nexus/archived/</a></li>
<li>此时（20160207） Nexus 最新版本为：<strong>2.12.0-01</strong></li>
<li>JDK 要求是 JDK 7，官网要求 7u6 或之后版本，包括 JDK 8</li>
<li>官网帮助说明 1：<a href="http://books.sonatype.com/nexus-book/2.11/reference/install.html" target="_blank" rel="external">http://books.sonatype.com/nexus-book/2.11/reference/install.html</a></li>
<li>官网帮助说明 2：<a href="http://books.sonatype.com/sonatype-clm-book/html/clm-book/installation-configuration.html" target="_blank" rel="external">http://books.sonatype.com/sonatype-clm-book/html/clm-book/installation-configuration.html</a></li>
<li>我个人习惯 <code>/opt</code> 目录下创建一个目录 <code>setups</code> 用来存放各种软件安装包；在 <code>/usr</code> 目录下创建一个 <code>program</code> 用来存放各种解压后的软件包，下面的讲解也都是基于此习惯</li>
<li>我个人已经使用了第三方源：<code>EPEL、RepoForge</code>，如果你出现 <code>yum install XXXXX</code> 安装不成功的话，很有可能就是你没有相关源，请查看我对源设置的文章</li>
<li>压缩包下载（由于国内网络的原因不排除你下载不了）：<code>wget http://download.sonatype.com/nexus/oss/nexus-2.12.0-01-bundle.tar.gz</code></li>
<li><p>如果地址下载不了，那是因为你需要开 VPN，你也可以选择降低要求下载 2.11.4-01 版本：<a href="http://pan.baidu.com/s/1mgSNJtA" target="_blank" rel="external">http://pan.baidu.com/s/1mgSNJtA</a></p>
<ul>
<li>解压压缩包：<code>tar zxvf nexus-2.11.4-01-bundle.tar.gz</code><ul>
<li>解压出来有两个文件夹：</li>
<li>这是程序目录：<code>nexus-2.11.4-01</code></li>
<li>这是仓库目录：<code>sonatype-work</code></li>
</ul>
</li>
<li>移到目录到我的安装目录下：<code>mv nexus-2.11.4-01/ /usr/program/</code></li>
<li>进入安装目录：<code>cd /usr/program/</code></li>
<li>把目录名字改为更好看点：<code>mv nexus-2.11.4-01/ nexus2.11.4/</code></li>
<li>编辑系统配置文件：<code>vim /etc/profile</code></li>
<li><p>在文件的尾巴增加下面内容：</p>
<pre><code class="ini"># Nexus
NEXUS_HOME=/usr/program/nexus2.11.4
export NEXUS_HOME
RUN_AS_USER=root
export RUN_AS_USER
</code></pre>
</li>
<li><p>刷新配置：<code>source /etc/profile</code></p>
</li>
<li>由于目录 <code>sonatype-work</code> 以后是做仓库用的，会存储很多 jar，所以这个目录一定要放在磁盘空间大的区内，目前我们还没第一次启动 Nexus，所以这里还是空文件<ul>
<li>我个人习惯把这类目录放在 <code>/opt</code> 下，所以你要特别注意，下面有内容对这个文件夹进行操作的都是基于 opt 目录的：<code>mv /opt/setup/sonatype-work/ /opt/</code></li>
<li>设置配置文件：<code>vim /usr/program/nexus2.11.4/conf/nexus.properties</code><ul>
<li>把文件中该值：<code>nexus-work=${bundleBasedir}/../sonatype-work/nexus</code></li>
<li>改为：<code>nexus-work=/opt/sonatype-work/nexus</code></li>
</ul>
</li>
</ul>
</li>
<li>默认情况下如果你的 JDK 等系统变量设置好的是无需编辑 Nexus 的配置文件，但是这里还是给大家一下配置文件路径：<code>vim /usr/program/nexus2.11.4/bin/jsw/conf/wrapper.conf</code></li>
<li>开放防火墙端口：<ul>
<li>添加规则：<code>sudo iptables -I INPUT -p tcp -m tcp --dport 8081 -j ACCEPT</code></li>
<li>保存规则：<code>sudo /etc/rc.d/init.d/iptables save</code></li>
<li>重启 iptables：<code>sudo service iptables restart</code></li>
</ul>
</li>
</ul>
</li>
<li>测试安装结果：<ul>
<li>启动 Nexus：<code>/usr/program/nexus2.11.4/bin/nexus start</code></li>
<li>查看启动日志：<code>tail -200f /usr/program/nexus2.11.4/logs/wrapper.log</code></li>
<li>关闭 Nexus：<code>/usr/program/nexus2.11.4/bin/nexus stop</code></li>
<li>访问：<a href="http://192.168.0.110:8081/nexus" target="_blank" rel="external">http://192.168.0.110:8081/nexus</a></li>
<li>登录账号密码：<ul>
<li>账号密码：<strong>admin</strong></li>
<li>密码：<strong>admin123</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Nexus-配置"><a href="#Nexus-配置" class="headerlink" title="Nexus 配置"></a>Nexus 配置</h2><ul>
<li>修改默认端口：<code>vim /usr/program/nexus2.11.4/conf/nexus.properties</code>，修改该值：application-port=8081</li>
<li>下载远程中央库的索引到服务器<ul>
<li><img src="images/Nexus-Install-And-Settings-a-1.jpg" alt="Nexus 配置"></li>
<li>如上图标注 4 所示，把默认是 <code>False</code> 改为 <code>True</code></li>
<li><img src="images/Nexus-Install-And-Settings-a-2.gif" alt="Nexus 配置"></li>
<li>如上图 gif 所示，创建任务开始进行索引下载。需要特别提醒的是，如果你的私服是虚拟机，那得保证你分配的硬盘足够大，别像我一样吝啬只给 10 G（现在还剩下 1.9 G），结果报：<strong>设备上没有空间</strong></li>
</ul>
</li>
<li>项目上配置链接连接私服（下面内容涉及到 maven 的基础知识，请自行私下学习）：<ul>
<li>对项目独立设置：<ul>
<li>打开项目的 pom.xml 文件：</li>
<li>添加下面内容：<pre><code class="xml">&lt;repositories&gt;
  &lt;repository&gt;
      &lt;id&gt;Nexus&lt;/id&gt;
      &lt;name&gt;虚拟机-192.168.0.110-Nexus&lt;/name&gt;
      &lt;url&gt;http://192.168.0.110:8081/nexus/content/groups/public/&lt;/url&gt;
  &lt;/repository&gt;
&lt;/repositories&gt;
</code></pre>
</li>
</ul>
</li>
<li>对全局配置进行设置：<ul>
<li>打开 maven 的 settings.xml 文件：</li>
<li>添加下面内容：<pre><code class="xml">&lt;mirrors&gt;
  &lt;mirror&gt;
      &lt;id&gt;YouMeekNexus&lt;/id&gt;
      &lt;name&gt;YouMeek Nexus&lt;/name&gt;
      &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;
      &lt;url&gt;http://192.168.0.110:8081/nexus/content/groups/public/&lt;/url&gt;
  &lt;/mirror&gt;
&lt;/mirrors&gt;
</code></pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="持续集成自动构建后发布到-Nexus-上"><a href="#持续集成自动构建后发布到-Nexus-上" class="headerlink" title="持续集成自动构建后发布到 Nexus 上"></a>持续集成自动构建后发布到 Nexus 上</h2><ul>
<li>在 Maven 的 settings.xml 加上连接服务器信息：</li>
</ul>
<pre><code class="xml">&lt;!--设置私库认证信息，用户名和密码我就用默认的，如果你们有权限控制的需求可以创建对应的一些账号--&gt;  
&lt;servers&gt;  
    &lt;server&gt;  
        &lt;id&gt;nexus-releases&lt;/id&gt;  
        &lt;username&gt;admin&lt;/username&gt;  
        &lt;password&gt;admin123&lt;/password&gt;  
    &lt;/server&gt;  
    &lt;server&gt;  
        &lt;id&gt;nexus-snapshots&lt;/id&gt;  
        &lt;username&gt;admin&lt;/username&gt;  
        &lt;password&gt;admin123&lt;/password&gt;  
    &lt;/server&gt;  
&lt;/servers&gt;
</code></pre>
<ul>
<li>在项目的 pom.xml 文件加上：</li>
</ul>
<pre><code class="xml">&lt;!-- nexus-releases nexus-snapshots 与 Maven 的配置文件 settings.xml 中 server 下的 id 对应 --&gt;  
&lt;distributionManagement&gt;  
    &lt;repository&gt;  
        &lt;id&gt;nexus-releases&lt;/id&gt;  
        &lt;name&gt;Nexus Releases Repository&lt;/name&gt;  
        &lt;url&gt;http://192.168.0.110:8081/nexus/content/repositories/releases/&lt;/url&gt;  
    &lt;/repository&gt;  
    &lt;snapshotRepository&gt;  
        &lt;id&gt;nexus-snapshots&lt;/id&gt;  
        &lt;name&gt;Nexus Snapshots Repository&lt;/name&gt;  
        &lt;url&gt;http://192.168.0.110:8081/nexus/content/repositories/snapshots/&lt;/url&gt;  
    &lt;/snapshotRepository&gt;  
&lt;/distributionManagement&gt;
</code></pre>
<h2 id="Nexus-手动更新索引文件"><a href="#Nexus-手动更新索引文件" class="headerlink" title="Nexus 手动更新索引文件"></a>Nexus 手动更新索引文件</h2><ul>
<li>手动更新索引<ul>
<li>关闭 Nexus：<code>/usr/program/nexus2.11.4/bin/nexus stop</code></li>
<li>命令：<code>cd  /opt/sonatype-work/nexus/indexer/central-ctx</code><ul>
<li>删除里面默认的文件：<code>rm -rf *</code></li>
</ul>
</li>
<li>访问官网索引：<a href="http://repo.maven.apache.org/maven2/.index/" target="_blank" rel="external">http://repo.maven.apache.org/maven2/.index/</a><ul>
<li>下载文件：<strong>nexus-maven-repository-index.gz</strong>：<code>wget http://repo.maven.apache.org/maven2/.index/nexus-maven-repository-index.gz</code></li>
<li>下载文件：<strong>nexus-maven-repository-index.properties</strong>：<code>wget http://repo.maven.apache.org/maven2/.index/nexus-maven-repository-index.properties</code></li>
<li>下载索引解压工具：<code>wget https://repo1.maven.org/maven2/org/apache/maven/indexer/indexer-cli/5.1.1/indexer-cli-5.1.1.jar</code></li>
<li>执行解压命令（该命令执行需要4分钟左右）：<code>java -jar indexer-cli-5.1.0.jar -u nexus-maven-repository-index.gz -d ./</code></li>
<li>删除解压前文件：<code>rm -rf indexer-cli-5.1.0.jar nexus-maven-repository-index.gz nexus-maven-repository-index.properties</code></li>
<li>重启服务：<code>/usr/program/nexus2.11.4/bin/nexus start</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://www.cnblogs.com/leefreeman/p/4211530.html" target="_blank" rel="external">http://www.cnblogs.com/leefreeman/p/4211530.html</a></li>
<li><a href="http://www.itdadao.com/article/89071/" target="_blank" rel="external">http://www.itdadao.com/article/89071/</a></li>
<li><a href="http://blog.zhaojunling.me/p/17" target="_blank" rel="external">http://blog.zhaojunling.me/p/17</a></li>
<li><a href="http://m.blog.csdn.net/article/details?id=49228873" target="_blank" rel="external">http://m.blog.csdn.net/article/details?id=49228873</a></li>
<li><a href="http://mritd.me/2015/12/29/Nexus-2-11-CentOS%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B/" target="_blank" rel="external">http://mritd.me/2015/12/29/Nexus-2-11-CentOS%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B/</a></li>
<li><a href="http://mritd.me/2015/12/28/Nexus-%E7%A7%81%E6%9C%8D%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/" target="_blank" rel="external">http://mritd.me/2015/12/28/Nexus-%E7%A7%81%E6%9C%8D%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</a></li>
<li><a href="http://my.oschina.net/liangbo/blog/195739" target="_blank" rel="external">http://my.oschina.net/liangbo/blog/195739</a></li>
<li><a href="http://www.mamicode.com/info-detail-1016489.html" target="_blank" rel="external">http://www.mamicode.com/info-detail-1016489.html</a></li>
<li><a href="http://blog.csdn.net/shawyeok/article/details/23564681" target="_blank" rel="external">http://blog.csdn.net/shawyeok/article/details/23564681</a></li>
<li><a href="http://zyjustin9.iteye.com/blog/2017321" target="_blank" rel="external">http://zyjustin9.iteye.com/blog/2017321</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Nexus-安装和配置&quot;&gt;&lt;a href=&quot;#Nexus-安装和配置&quot; class=&quot;headerlink&quot; title=&quot;Nexus 安装和配置&quot;&gt;&lt;/a&gt;Nexus 安装和配置&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>NFS</title>
    <link href="//zeroto.tech/2017/11/22/NFS/"/>
    <id>//zeroto.tech/2017/11/22/NFS/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:49:09.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NFS（Network-FileSystem）介绍"><a href="#NFS（Network-FileSystem）介绍" class="headerlink" title="NFS（Network FileSystem）介绍"></a>NFS（Network FileSystem）介绍</h1><a id="more"></a>
<h2 id="NFS-安装"><a href="#NFS-安装" class="headerlink" title="NFS 安装"></a>NFS 安装</h2><ul>
<li><p>查看是否已安装：</p>
<ul>
<li>CentOS：<code>rpm -qa | grep nfs-*</code></li>
<li>Ubuntu：<code>dpkg -l | grep nfs-*</code></li>
</ul>
</li>
<li><p>安装：</p>
<ul>
<li>CentOS 5：<code>sudo yum install -y nfs-utils portmap</code></li>
<li>CentOS 6：<code>sudo yum install -y nfs-utils rpcbind</code></li>
<li>Ubuntu：<code>sudo apt-get install -y nfs-common nfs-kernel-server</code></li>
</ul>
</li>
</ul>
<h2 id="NFS-服务器配置文件常用参数"><a href="#NFS-服务器配置文件常用参数" class="headerlink" title="NFS 服务器配置文件常用参数"></a>NFS 服务器配置文件常用参数</h2><ul>
<li><p>配置文件介绍（记得先备份）：<code>sudo vim /etc/exports</code></p>
<ul>
<li>默认配置文件里面是没啥内容的，我们需要自己加上配置内容，一行表示共享一个目录。为了方便使用，共享的目录最好将权限设置为 777（<code>chmod 777 folderName</code>）。</li>
<li>假设在配置文件里面加上：<code>/opt/mytest 192.168.0.0/55(rw,sync,all_squash,anonuid=501,anongid=501,no_subtree_check)</code></li>
<li>该配置解释：<ul>
<li>/opt/mytest 表示我们要共享的目录</li>
<li>192.168.0.0/55 表示内网中这个网段区间的IP是可以进行访问的，如果要任意网段都可以访问，可以用 <code>*</code> 号表示</li>
<li>(rw,sync,all_squash,anonuid=501,anongid=501,no_subtree_check) 表示权限<ul>
<li>rw：是可读写（ro是只读）</li>
<li>sync：同步模式，表示内存中的数据时时刻刻写入磁盘（async：非同步模式，内存中数据定期存入磁盘）</li>
<li>all_squash：表示不管使用NFS的用户是谁，其身份都会被限定为一个指定的普通用户身份。（no_root_squash：其他客户端主机的root用户对该目录有至高权限控制。root_squash：表示其他客户端主机的root用户对该目录有普通用户权限控制）</li>
<li>anonuid/anongid：要和root_squash或all_squash选项一同使用，表示指定使用NFS的用户被限定后的uid和gid，前提是本图片服务器的/etc/passwd中存在这一的uid和gid</li>
<li>no_subtree_check：不检查父目录的权限</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>启动服务：</p>
<ul>
<li><code>/etc/init.d/rpcbind restart</code></li>
<li><code>/etc/init.d/nfs-kernel-server restart</code></li>
</ul>
</li>
</ul>
<h2 id="NFS-客户端访问"><a href="#NFS-客户端访问" class="headerlink" title="NFS 客户端访问"></a>NFS 客户端访问</h2><ul>
<li>客户端要访问服务端的共享目录需要对其共享的目录进行挂载，在挂载之前先检查下：<code>showmount -e 192.168.1.25</code>（这个 IP 是 NFS 的服务器端 IP）<ul>
<li>如果显示：/opt/mytest 相关信息表示成功了。</li>
</ul>
</li>
<li>现在开始对其进行挂载：<code>mount -t nfs 192.168.1.25:/opt/mytest/ /mytest/</code><ul>
<li>在客户端机器上输入命令：<code>df -h</code> 可以看到多了一个 mytest 分区。然后我们可以再创建一个软链接，把软链接放在 war 包的目录下，这样上传的图片都会跑到另外一台服务器上了。软链接相关内容请自行搜索。</li>
</ul>
</li>
</ul>
<h2 id="NFS-资料"><a href="#NFS-资料" class="headerlink" title="NFS 资料"></a>NFS 资料</h2><ul>
<li><a href="http://wiki.jikexueyuan.com/project/linux/nfs.html" target="_blank" rel="external">http://wiki.jikexueyuan.com/project/linux/nfs.html</a> </li>
<li><a href="http://www.jb51.net/os/RedHat/77993.html" target="_blank" rel="external">http://www.jb51.net/os/RedHat/77993.html</a> </li>
<li><a href="http://www.cnblogs.com/Charles-Zhang-Blog/archive/2013/02/05/2892879.html" target="_blank" rel="external">http://www.cnblogs.com/Charles-Zhang-Blog/archive/2013/02/05/2892879.html</a> </li>
<li><a href="http://www.linuxidc.com/Linux/2013-08/89154.htm" target="_blank" rel="external">http://www.linuxidc.com/Linux/2013-08/89154.htm</a> </li>
<li><a href="http://www.centoscn.com/image-text/config/2015/0111/4475.html" target="_blank" rel="external">http://www.centoscn.com/image-text/config/2015/0111/4475.html</a> </li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;NFS（Network-FileSystem）介绍&quot;&gt;&lt;a href=&quot;#NFS（Network-FileSystem）介绍&quot; class=&quot;headerlink&quot; title=&quot;NFS（Network FileSystem）介绍&quot;&gt;&lt;/a&gt;NFS（Network FileSystem）介绍&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>Nginx 安装和配置</title>
    <link href="//zeroto.tech/2017/11/22/Nginx-Install-And-Settings/"/>
    <id>//zeroto.tech/2017/11/22/Nginx-Install-And-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:49:54.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Nginx-安装和配置"><a href="#Nginx-安装和配置" class="headerlink" title="Nginx 安装和配置"></a>Nginx 安装和配置</h1><a id="more"></a>
<h2 id="Nginx-说明"><a href="#Nginx-说明" class="headerlink" title="Nginx 说明"></a>Nginx 说明</h2><ul>
<li>Nginx 是一个很强大的高性能 Web 和反向代理服务器，常被我们用作负载均衡服务器，也可以作为邮件代理服务器</li>
<li>Nginx WIKI：<a href="https://zh.wikipedia.org/zh/Nginx" target="_blank" rel="external">https://zh.wikipedia.org/zh/Nginx</a></li>
<li>Nginx 百科：<a href="http://baike.baidu.com/item/nginx" target="_blank" rel="external">http://baike.baidu.com/item/nginx</a></li>
<li>Nginx 官网：<a href="http://nginx.org/en/" target="_blank" rel="external">http://nginx.org/en/</a></li>
<li>Nginx 官网下载：<a href="http://nginx.org/en/download.html" target="_blank" rel="external">http://nginx.org/en/download.html</a><ul>
<li>源码包方式下载：<a href="http://nginx.org/en/download.html" target="_blank" rel="external">http://nginx.org/en/download.html</a>，注意该页面的：<code>Stable version</code>，这个表示稳定版本，2016-03-22 最新版本是：<code>nginx-1.8.1</code>，这是一个  <strong>tar.gz</strong> 的文件链接。</li>
<li>构建包方式下载：<a href="http://nginx.org/en/linux_packages.html#stable" target="_blank" rel="external">http://nginx.org/en/linux_packages.html#stable</a></li>
</ul>
</li>
<li>Nginx 文档：<ul>
<li>优先：<a href="https://www.nginx.com/resources/wiki/" target="_blank" rel="external">https://www.nginx.com/resources/wiki/</a></li>
<li>次要：<a href="http://nginx.org/en/docs/" target="_blank" rel="external">http://nginx.org/en/docs/</a></li>
</ul>
</li>
<li>Nginx 模块地址：<a href="https://www.nginx.com/resources/wiki/modules/" target="_blank" rel="external">https://www.nginx.com/resources/wiki/modules/</a></li>
</ul>
<h2 id="来自网络上的一个好介绍"><a href="#来自网络上的一个好介绍" class="headerlink" title="来自网络上的一个好介绍"></a>来自网络上的一个好介绍</h2><ul>
<li>来源：<a href="https://help.aliyun.com/knowledge_detail/6703521.html?spm=5176.788314854.2.2.CdMGlB" target="_blank" rel="external">https://help.aliyun.com/knowledge_detail/6703521.html?spm=5176.788314854.2.2.CdMGlB</a></li>
</ul>
<blockquote>
<ul>
<li>传统上基于进程或线程模型架构的 Web 服务通过每进程或每线程处理并发连接请求，这势必会在网络和 I/O 操作时产生阻塞，其另一个必然结果则是对内存或 CPU 的利用率低下。生成一个新的进程/线程需要事先备好其运行时环境，这包括为其分配堆内存和栈内存，以及为其创建新的执行上下文等。这些操作都需要占用 CPU，而且过多的进程/线程还会带来线程抖动或频繁的上下文切换，系统性能也会由此进一步下降。</li>
<li>在设计的最初阶段，Nginx 的主要着眼点就是其高性能以及对物理计算资源的高密度利用，因此其采用了不同的架构模型。受启发于多种操作系统设计中基于“事件”的高级处理机制，nginx采用了模块化、事件驱动、异步、单线程及非阻塞的架构，并大量采用了多路复用及事件通知机制。在 Nginx 中，连接请求由为数不多的几个仅包含一个线程的进程 Worker 以高效的回环(run-loop)机制进行处理，而每个 Worker 可以并行处理数千个的并发连接及请求。</li>
<li>如果负载以 CPU 密集型应用为主，如 SSL 或压缩应用，则 Worker 数应与 CPU 数相同；如果负载以 IO 密集型为主，如响应大量内容给客户端，则 Worker 数应该为 CPU 个数的 1.5 或 2 倍。</li>
<li>Nginx会按需同时运行多个进程：一个主进程(Master)和几个工作进程(Worker)，配置了缓存时还会有缓存加载器进程(Cache Loader)和缓存管理器进程(Cache Manager)等。所有进程均是仅含有一个线程，并主要通过“共享内存”的机制实现进程间通信。主进程以root用户身份运行，而 Worker、Cache Loader 和 Cache manager 均应以非特权用户身份运行。</li>
<li>主进程主要完成如下工作：<ul>
<li>1.读取并验正配置信息；</li>
<li>2.创建、绑定及关闭套接字；</li>
<li>3.启动、终止及维护worker进程的个数；</li>
<li>4.无须中止服务而重新配置工作特性；</li>
<li>5.控制非中断式程序升级，启用新的二进制程序并在需要时回滚至老版本；</li>
<li>6.重新打开日志文件，实现日志滚动；</li>
<li>7.编译嵌入式perl脚本；</li>
</ul>
</li>
<li>Worker 进程主要完成的任务包括：<ul>
<li>1.接收、传入并处理来自客户端的连接；</li>
<li>2.提供反向代理及过滤功能；</li>
<li>3.nginx任何能完成的其它任务；</li>
</ul>
</li>
<li>Cache Loader 进程主要完成的任务包括：<ul>
<li>1.检查缓存存储中的缓存对象；</li>
<li>2.使用缓存元数据建立内存数据库；</li>
</ul>
</li>
<li>Cache Manager 进程的主要任务：<ul>
<li>1.缓存的失效及过期检验；</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="Nginx-源码编译安装"><a href="#Nginx-源码编译安装" class="headerlink" title="Nginx 源码编译安装"></a>Nginx 源码编译安装</h2><ul>
<li>官网下载最新稳定版本 <strong>1.8.1</strong>，大小：814K</li>
<li>官网安装说明：<a href="https://www.nginx.com/resources/wiki/start/topics/tutorials/install/" target="_blank" rel="external">https://www.nginx.com/resources/wiki/start/topics/tutorials/install/</a></li>
<li>源码编译配置参数说明：<ul>
<li><a href="https://www.nginx.com/resources/wiki/start/topics/tutorials/installoptions/" target="_blank" rel="external">https://www.nginx.com/resources/wiki/start/topics/tutorials/installoptions/</a></li>
<li><a href="http://nginx.org/en/docs/configure.html" target="_blank" rel="external">http://nginx.org/en/docs/configure.html</a></li>
</ul>
</li>
<li><p>开始安装：</p>
<ul>
<li>安装依赖包：<code>yum install -y gcc gcc-c++ pcre pcre-devel zlib zlib-devel openssl openssl-devel</code></li>
<li>预设几个文件夹，方便等下安装的时候有些文件可以进行存放：<ul>
<li><code>mkdir -p /usr/local/nginx /var/log/nginx /var/temp/nginx /var/lock/nginx</code></li>
</ul>
</li>
<li>下载源码包：<code>`wget http://nginx.org/download/nginx-1.8.1.tar.gz</code></li>
<li>解压：<code>tar zxvf nginx-1.8.1.tar.gz</code></li>
<li>进入解压后目录：<code>cd nginx-1.8.1/</code></li>
<li><p>编译配置：</p>
<pre><code class="ini">./configure \
--prefix=/usr/local/nginx \
--pid-path=/var/local/nginx/nginx.pid \
--lock-path=/var/lock/nginx/nginx.lock \
--error-log-path=/var/log/nginx/error.log \
--http-log-path=/var/log/nginx/access.log \
--with-http_gzip_static_module \
--http-client-body-temp-path=/var/temp/nginx/client \
--http-proxy-temp-path=/var/temp/nginx/proxy \
--http-fastcgi-temp-path=/var/temp/nginx/fastcgi \
--http-uwsgi-temp-path=/var/temp/nginx/uwsgi \
--http-scgi-temp-path=/var/temp/nginx/scgi
</code></pre>
</li>
<li><p>编译：<code>make</code></p>
</li>
<li>安装：<code>make install</code></li>
</ul>
</li>
<li><p>启动 Nginx</p>
<ul>
<li><p>先检查是否在 /usr/local 目录下生成了 Nginx 等相关文件：<code>cd /usr/local/nginx;ll</code>，正常的效果应该是显示这样的：</p>
<pre><code class="nginx">drwxr-xr-x. 2 root root 4096 3月  22 16:21 conf
drwxr-xr-x. 2 root root 4096 3月  22 16:21 html
drwxr-xr-x. 2 root root 4096 3月  22 16:21 sbin
</code></pre>
</li>
<li><p>停止防火墙：<code>service iptables stop</code></p>
<ul>
<li>或是把 80 端口加入到的排除列表：</li>
<li><code>sudo iptables -A INPUT -p tcp -m tcp --dport 80 -j ACCEPT</code></li>
<li><code>sudo service iptables save</code></li>
<li><code>sudo service iptables restart</code></li>
</ul>
</li>
<li>启动：<code>/usr/local/nginx/sbin/nginx</code>，启动完成 shell 是不会有输出的</li>
<li>检查 时候有 Nginx 进程：<code>ps aux | grep nginx</code>，正常是显示 3 个结果出来 </li>
<li>检查 Nginx 是否启动并监听了 80 端口：<code>netstat -ntulp | grep 80</code> </li>
<li>访问：<code>192.168.1.114</code>，如果能看到：<code>Welcome to nginx!</code>，即可表示安装成功</li>
<li>检查 Nginx 启用的配置文件是哪个：<code>/usr/local/nginx/sbin/nginx -t</code></li>
<li>刷新 Nginx 配置后重启：<code>/usr/local/nginx/sbin/nginx -s reload</code></li>
<li>停止 Nginx：<code>/usr/local/nginx/sbin/nginx -s stop</code></li>
<li>如果访问不了，或是出现其他信息看下错误立即：<code>vim /var/log/nginx/error.log</code></li>
</ul>
</li>
</ul>
<h2 id="把-Nginx-添加到系统服务中"><a href="#把-Nginx-添加到系统服务中" class="headerlink" title="把 Nginx 添加到系统服务中"></a>把 Nginx 添加到系统服务中</h2><ul>
<li>新建文件：<code>vim /etc/init.d/nginx</code></li>
<li>添加如下内容：</li>
</ul>
<pre><code class="nginx">#!/bin/bash


#nginx执行程序路径需要修改
nginxd=/usr/local/nginx/sbin/nginx

# nginx配置文件路径需要修改
nginx_config=/usr/local/nginx/conf/nginx.conf

# pid 地址需要修改
nginx_pid=/var/local/nginx/nginx.pid


RETVAL=0
prog=&quot;nginx&quot;

# Source function library.
. /etc/rc.d/init.d/functions
# Source networking configuration.
. /etc/sysconfig/network
# Check that networking is up.
[ ${NETWORKING} = &quot;no&quot; ] &amp;&amp; exit 0
[ -x $nginxd ] || exit 0

# Start nginx daemons functions.
start() {
if [ -e $nginx_pid ];then
   echo &quot;nginx already running....&quot;
   exit 1
fi

echo -n $&quot;Starting $prog: &quot;
daemon $nginxd -c ${nginx_config}
RETVAL=$?
echo
[ $RETVAL = 0 ] &amp;&amp; touch /var/lock/subsys/nginx
return $RETVAL
}

# Stop nginx daemons functions.
# pid 地址需要修改
stop() {
    echo -n $&quot;Stopping $prog: &quot;
    killproc $nginxd
    RETVAL=$?
    echo
    [ $RETVAL = 0 ] &amp;&amp; rm -f /var/lock/subsys/nginx /var/local/nginx/nginx.pid
}

# reload nginx service functions.
reload() {
    echo -n $&quot;Reloading $prog: &quot;
    #kill -HUP `cat ${nginx_pid}`
    killproc $nginxd -HUP
    RETVAL=$?
    echo
}

# See how we were called.
case &quot;$1&quot; in
    start)
        start
        ;;
    stop)
        stop
        ;;
    reload)
        reload
        ;;
    restart)
        stop
        start
        ;;
    status)
        status $prog
        RETVAL=$?
        ;;
    *)

    echo $&quot;Usage: $prog {start|stop|restart|reload|status|help}&quot;
    exit 1

esac
exit $RETVAL
</code></pre>
<ul>
<li>修改权限：<code>chmod 755 /etc/init.d/nginx</code></li>
<li>启动服务：<code>service nginx start</code></li>
<li>停止服务：<code>service nginx stop</code></li>
<li>重启服务：<code>service nginx restart</code></li>
</ul>
<h2 id="Nginx-配置"><a href="#Nginx-配置" class="headerlink" title="Nginx 配置"></a>Nginx 配置</h2><ul>
<li>Nginx 默认配置文件：<code>vim /usr/local/nginx/conf/nginx.conf</code></li>
</ul>
<h3 id="Nginx-在-1-8-1-版本下的默认配置（去掉注释）"><a href="#Nginx-在-1-8-1-版本下的默认配置（去掉注释）" class="headerlink" title="Nginx 在 1.8.1 版本下的默认配置（去掉注释）"></a>Nginx 在 1.8.1 版本下的默认配置（去掉注释）</h3><pre><code class="nginx">worker_processes  1;

events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;
    keepalive_timeout  65;

    server {
        listen       80;
        server_name  localhost;

        location / {
            root   html;
            index  index.html index.htm;
        }

        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
    }
}
</code></pre>
<h3 id="HTTP-服务，虚拟主机"><a href="#HTTP-服务，虚拟主机" class="headerlink" title="HTTP 服务，虚拟主机"></a>HTTP 服务，虚拟主机</h3><ul>
<li>停止防火墙：<code>service iptables stop</code>，防止出现特别干扰</li>
<li>编辑默认的配置文件：<code>vim /usr/local/nginx/conf/nginx.conf</code></li>
<li>设置两个虚拟主机（通过<strong>端口</strong>来区分开）</li>
</ul>
<pre><code class="nginx">worker_processes  1;

events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;
    keepalive_timeout  65;

    # 一个 server 代表一个虚拟主机
    server {
        listen       80;
        server_name  localhost;

        location / {
            # 虚拟机根目录是 /usr/local/nginx/html 目录
            root   html;
            # 虚拟机首页是 /usr/local/nginx/html 目录下这两个文件
            index  index.html index.htm;
        }

        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
    }

    server {
        # 第二个虚拟机的端口是 90，服务地址还是本地
        listen       90;
        server_name  localhost;

        location / {
            root   html90;
            index  index.html index.htm;
        }

        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
    }
}
</code></pre>
<ul>
<li>设置两个虚拟主机（通过<strong>域名</strong>来区分开）</li>
</ul>
<pre><code class="nginx">worker_processes  1;

events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;
    keepalive_timeout  65;

    # 一个 server 代表一个虚拟主机
    server {
        listen       80;
        # 两个虚拟主机都使用 80 端口，设置不同域名
        server_name  code.youmeek.com;

        location / {
            # 虚拟机根目录是 /usr/local/nginx/html 目录
            root   html;
            # 虚拟机首页是 /usr/local/nginx/html 目录下这两个文件
            index  index.html index.htm;
        }

        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
    }

    server {
        listen       80;
        # 两个虚拟主机都使用 80 端口，设置不同域名
        server_name  i.youmeek.com;

        location / {
            root   html-i;
            index  index.html index.htm;
        }

        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
    }
}
</code></pre>
<h3 id="反向代理和负载均衡"><a href="#反向代理和负载均衡" class="headerlink" title="反向代理和负载均衡"></a>反向代理和负载均衡</h3><ul>
<li><p>最精简的环境：一台虚拟机</p>
<ul>
<li>1 个 JDK</li>
<li>1 个 Nginx</li>
<li>2 个 Tomcat</li>
</ul>
</li>
<li><p>Nginx 配置：</p>
</li>
</ul>
<pre><code class="nginx">worker_processes  1;

events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;
    keepalive_timeout  65;

    # 自己定义的两个 tomcat 请求地址和端口
    # 也就是当浏览器请求：tomcat.youmeek.com 的时候从下面这两个 tomcat 中去找一个进行转发
    upstream tomcatCluster {
        server 192.168.1.114:8080;
        server 192.168.1.114:8081;

        # 添加 weight 字段可以表示权重，值越高权重越大，默认值是 1，最大值官网没说，一般如果设置也就设置 3,5,7 这样的数
        # 官网：https://www.nginx.com/resources/admin-guide/load-balancer/#weight
        # server 192.168.1.114:8080 weight=2;
        # server 192.168.1.114:8081 weight=1;
    }

    server {
        listen       80;
        server_name  tomcat.youmeek.com;

        location / {
            proxy_pass   http://tomcatCluster;
            index  index.html index.htm;
        }
    }
}
</code></pre>
<h3 id="HTTP-服务，绑定多个域名"><a href="#HTTP-服务，绑定多个域名" class="headerlink" title="HTTP 服务，绑定多个域名"></a>HTTP 服务，绑定多个域名</h3><ul>
<li><a href="https://www.ttlsa.com/nginx/use-nginx-proxy/" target="_blank" rel="external">https://www.ttlsa.com/nginx/use-nginx-proxy/</a></li>
</ul>
<h3 id="安装第三方模块"><a href="#安装第三方模块" class="headerlink" title="安装第三方模块"></a>安装第三方模块</h3><h3 id="生成规格图"><a href="#生成规格图" class="headerlink" title="生成规格图"></a>生成规格图</h3><h3 id="启用-Gzip-压缩"><a href="#启用-Gzip-压缩" class="headerlink" title="启用 Gzip 压缩"></a>启用 Gzip 压缩</h3><h3 id="防盗链"><a href="#防盗链" class="headerlink" title="防盗链"></a>防盗链</h3><ul>
<li><a href="https://help.aliyun.com/knowledge_detail/5974693.html?spm=5176.788314853.2.18.s4z1ra" target="_blank" rel="external">https://help.aliyun.com/knowledge_detail/5974693.html?spm=5176.788314853.2.18.s4z1ra</a></li>
</ul>
<h3 id="Nginx-禁止特定用户代理（User-Agents）访问，静止指定-IP-访问"><a href="#Nginx-禁止特定用户代理（User-Agents）访问，静止指定-IP-访问" class="headerlink" title="Nginx 禁止特定用户代理（User Agents）访问，静止指定 IP 访问"></a>Nginx 禁止特定用户代理（User Agents）访问，静止指定 IP 访问</h3><ul>
<li><a href="https://www.ttlsa.com/nginx/how-to-block-user-agents-using-nginx/" target="_blank" rel="external">https://www.ttlsa.com/nginx/how-to-block-user-agents-using-nginx/</a></li>
<li><a href="https://help.aliyun.com/knowledge_detail/5974693.html?spm=5176.788314853.2.18.s4z1ra" target="_blank" rel="external">https://help.aliyun.com/knowledge_detail/5974693.html?spm=5176.788314853.2.18.s4z1ra</a></li>
<li>&lt;&gt;</li>
<li>&lt;&gt;</li>
<li>&lt;&gt;</li>
</ul>
<h3 id="Nginx-缓存"><a href="#Nginx-缓存" class="headerlink" title="Nginx 缓存"></a>Nginx 缓存</h3><h3 id="Nginx-自动分割日志文件"><a href="#Nginx-自动分割日志文件" class="headerlink" title="Nginx 自动分割日志文件"></a>Nginx 自动分割日志文件</h3><h3 id="Nginx-处理跨域请求"><a href="#Nginx-处理跨域请求" class="headerlink" title="Nginx 处理跨域请求"></a>Nginx 处理跨域请求</h3><h3 id="安全相预防"><a href="#安全相预防" class="headerlink" title="安全相预防"></a>安全相预防</h3><p>在配置文件中设置自定义缓存以限制缓冲区溢出攻击的可能性<br>client_body_buffer_size 1K;<br>client_header_buffer_size 1k;<br>client_max_body_size 1k;<br>large_client_header_buffers 2 1k;</p>
<ol>
<li>将timeout设低来防止DOS攻击<br>所有这些声明都可以放到主配置文件中。<br>client_body_timeout 10;<br>client_header_timeout 10;<br>keepalive_timeout 5 5;<br>send_timeout 10;</li>
</ol>
<ol>
<li>限制用户连接数来预防DOS攻击<br>limit_zone slimits $binary_remote_addr 5m;<br>limit_conn slimits 5;</li>
</ol>
<h3 id="杂七杂八"><a href="#杂七杂八" class="headerlink" title="杂七杂八"></a>杂七杂八</h3><ul>
<li><a href="https://www.ttlsa.com/nginx/nginx-modules-ngx_set_cconv/" target="_blank" rel="external">nginx实现简体繁体字互转以及中文转拼音</a></li>
<li><a href="https://www.ttlsa.com/nginx/nginx-modules-ngx_http_log_request_speed/" target="_blank" rel="external">nginx记录分析网站响应慢的请求(ngx_http_log_request_speed)</a></li>
<li><a href="https://www.ttlsa.com/nginx/nginx-modules-empty_gif/" target="_blank" rel="external">nginx空白图片(empty_gif模块)</a></li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="https://help.aliyun.com/knowledge_detail/5974693.html?spm=5176.788314853.2.18.s4z1ra" target="_blank" rel="external">https://help.aliyun.com/knowledge_detail/5974693.html?spm=5176.788314853.2.18.s4z1ra</a></li>
<li><a href="http://www.ydcss.com/archives/466" target="_blank" rel="external">http://www.ydcss.com/archives/466</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Nginx-安装和配置&quot;&gt;&lt;a href=&quot;#Nginx-安装和配置&quot; class=&quot;headerlink&quot; title=&quot;Nginx 安装和配置&quot;&gt;&lt;/a&gt;Nginx 安装和配置&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>MySQL 优化</title>
    <link href="//zeroto.tech/2017/11/22/Mysql-Optimize/"/>
    <id>//zeroto.tech/2017/11/22/Mysql-Optimize/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:47:52.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MySQL-优化"><a href="#MySQL-优化" class="headerlink" title="MySQL 优化"></a>MySQL 优化</h1><ul>
<li>下面说的优化基于 MySQL 5.6，理论上 5.5 之后的都算试用，具体还是要看官网</li>
</ul>
<h2 id="服务状态查询"><a href="#服务状态查询" class="headerlink" title="服务状态查询"></a>服务状态查询</h2><a id="more"></a>
<ul>
<li>查看当前数据库的状态，常用的有：<ul>
<li>查看当前MySQL中已经记录了多少条慢查询，前提是配置文件中开启慢查询记录了.<ul>
<li><code>SHOW STATUS LIKE &#39;%slow_queries%&#39;;</code></li>
</ul>
</li>
<li>查询当前MySQL中查询、更新、删除执行多少条了，可以通过这个来判断系统是侧重于读还是侧重于写，如果是写要考虑使用读写分离。<ul>
<li><code>SHOW STATUS LIKE &#39;%Com_select%&#39;;</code></li>
<li><code>SHOW STATUS LIKE &#39;%Com_update%&#39;;</code></li>
<li><code>SHOW STATUS LIKE &#39;%Com_delete%&#39;;</code></li>
</ul>
</li>
<li>显示MySQL服务启动运行了多少时间，如果MySQL服务重启，该时间重新计算，单位秒<ul>
<li><code>SHOW STATUS LIKE &#39;uptime&#39;;</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="查询优化"><a href="#查询优化" class="headerlink" title="查询优化"></a>查询优化</h2><ul>
<li>使用 EXPLAIN 进行 SQL 语句分析：<code>EXPLAIN SELECT * FROM sys_user;</code></li>
<li>得到的结果有下面几列：<ul>
<li>id，该列表示当前结果序号，无特殊意义，不重要</li>
<li>select_type，表示 SELECT 语句的类型，有下面几种<ul>
<li>SIMPLE，表示简单查询，其中不包括连接查询和子查询</li>
<li>PRIMARY，表示主查询，或者是最外面的查询语句。比如你使用一个子查询语句，比如这条 SQL：<code>EXPLAIN SELECT * FROM (SELECT sys_user_id FROM sys_user WHERE sys_user_id = 1) AS temp_table;</code><ul>
<li>这条 SQL 有两个结果，其中有一个结果的类型就是 PRIMARY</li>
</ul>
</li>
<li>UNION，使用 UNION 的SQL是这个类型</li>
<li>DERIVED，在 SQL 中 From 后面子查询</li>
<li>SUBQUERY，子查询</li>
<li>还有其他一些</li>
</ul>
</li>
<li>table，表名或者是子查询的一个结果集</li>
<li>type，表示表的链接类型，分别有（以下的连接类型的顺序是从最佳类型到最差类型）<strong>（这个属性重要）</strong>：<ul>
<li>性能好：<ul>
<li>system，表仅有一行，这是const类型的特列，平时不会出现，这个也可以忽略不计。</li>
<li>const，数据表最多只有一个匹配行，因为只匹配一行数据，所以很快，常用于PRIMARY KEY或者UNIQUE索引的查询，可理解为const是最优化的。</li>
<li>eq_ref，mysql手册是这样说的:”对于每个来自于前面的表的行组合，从该表中读取一行。这可能是最好的联接类型，除了const类型。它用在一个索引的所有部分被联接使用并且索引是UNIQUE(唯一键)也不是PRIMARY KEY(主键)”。eq_ref可以用于使用=比较带索引的列。</li>
<li>ref，查询条件索引既不是UNIQUE(唯一键)也不是PRIMARY KEY(主键)的情况。ref可用于=或&lt;或&gt;操作符的带索引的列。</li>
<li>ref_or_null，该联接类型如同ref，但是添加了MySQL可以专门搜索包含NULL值的行。在解决子查询中经常使用该联接类型的优化。</li>
</ul>
</li>
<li>性能较差：<ul>
<li>index_merge，该联接类型表示使用了索引合并优化方法。在这种情况下，key列包含了使用的索引的清单，key_len包含了使用的索引的最长的关键元素。</li>
<li>unique_subquery，该类型替换了下面形式的IN子查询的ref: <code>value IN (SELECT primary_key FROM single_table WHERE some_expr)</code>。unique_subquery 是一个索引查找函数,可以完全替换子查询,效率更高。</li>
<li>index_subquery，该联接类型类似于unique_subquery。可以替换IN子查询,但只适合下列形式的子查询中的非唯一索引: <code>value IN (SELECT key_column FROM single_table WHERE some_expr)</code></li>
<li>range，只检索给定范围的行,使用一个索引来选择行。</li>
<li>index，该联接类型与ALL相同,除了只有索引树被扫描。这通常比ALL快,因为索引文件通常比数据文件小。</li>
</ul>
</li>
<li>性能最差：<ul>
<li>ALL，对于每个来自于先前的表的行组合,进行完整的表扫描。（性能最差）</li>
</ul>
</li>
</ul>
</li>
<li>possible_keys，指出MySQL能使用哪个索引在该表中找到行。如果该列为NULL，说明没有使用索引，可以对该列创建索引来提供性能。<strong>（这个属性重要）</strong></li>
<li>key，显示MySQL实际决定使用的键(索引)。如果没有选择索引,键是NULL。<strong>（这个属性重要）</strong></li>
<li>key_len，显示MySQL决定使用的键长度。如果键是NULL,则长度为NULL。注意：key_len是确定了MySQL将实际使用的索引长度。</li>
<li>ref，显示使用哪个列或常数与key一起从表中选择行。</li>
<li>rows，显示MySQL认为它执行查询时必须检查的行数。<strong>（这个属性重要）</strong></li>
<li>Extra，该列包含MySQL解决查询的详细信息：<ul>
<li>Distinct:MySQL发现第1个匹配行后,停止为当前的行组合搜索更多的行。</li>
<li>Not exists:MySQL能够对查询进行LEFT JOIN优化,发现1个匹配LEFT JOIN标准的行后,不再为前面的的行组合在该表内检查更多的行。</li>
<li>range checked for each record (index map: #):MySQL没有发现好的可以使用的索引,但发现如果来自前面的表的列值已知,可能部分索引可以使用。</li>
<li>Using filesort:MySQL需要额外的一次传递,以找出如何按排序顺序检索行。</li>
<li>Using index:从只使用索引树中的信息而不需要进一步搜索读取实际的行来检索表中的列信息。</li>
<li>Using temporary:为了解决查询,MySQL需要创建一个临时表来容纳结果。</li>
<li>Using where:WHERE 子句用于限制哪一个行匹配下一个表或发送到客户。</li>
<li>Using sort_union(…), Using union(…), Using intersect(…):这些函数说明如何为index_merge联接类型合并索引扫描。</li>
<li>Using index for group-by:类似于访问表的Using index方式,Using index for group-by表示MySQL发现了一个索引,可以用来查 询GROUP BY或DISTINCT查询的所有列,而不要额外搜索硬盘访问实际的表。</li>
</ul>
</li>
</ul>
</li>
<li>了解对索引不生效的查询情况 <strong>（这个属性重要）</strong><ul>
<li>使用LIKE关键字的查询，在使用LIKE关键字进行查询的查询语句中，如果匹配字符串的第一个字符为“%”，索引不起作用。只有“%”不在第一个位置，索引才会生效。</li>
<li>使用联合索引的查询，MySQL可以为多个字段创建索引，一个索引可以包括16个字段。对于联合索引，只有查询条件中使用了这些字段中第一个字段时，索引才会生效。</li>
<li>使用OR关键字的查询，查询语句的查询条件中只有OR关键字，且OR前后的两个条件中的列都是索引列时，索引才会生效，否则，索引不生效。</li>
</ul>
</li>
<li>子查询优化<ul>
<li>MySQL从4.1版本开始支持子查询，使用子查询进行SELECT语句嵌套查询，可以一次完成很多逻辑上需要多个步骤才能完成的SQL操作。</li>
<li>子查询虽然很灵活，但是执行效率并不高。</li>
<li>执行子查询时，MYSQL需要创建临时表，查询完毕后再删除这些临时表，所以，子查询的速度会受到一定的影响。</li>
<li>优化：<ul>
<li>可以使用连接查询（JOIN）代替子查询，连接查询时不需要建立临时表，其速度比子查询快。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="数据库结构优化"><a href="#数据库结构优化" class="headerlink" title="数据库结构优化"></a>数据库结构优化</h2><ul>
<li>将字段很多的表分解成多个表<ul>
<li>对于字段较多的表，如果有些字段的使用频率很低，可以将这些字段分离出来形成新表。</li>
<li>因为当一个表的数据量很大时，会由于使用频率低的字段的存在而变慢。</li>
</ul>
</li>
<li>增加中间表<ul>
<li>对于需要经常联合查询的表，可以建立中间表以提高查询效率。</li>
<li>通过建立中间表，将需要通过联合查询的数据插入到中间表中，然后将原来的联合查询改为对中间表的查询。</li>
</ul>
</li>
<li>增加冗余字段<ul>
<li>设计数据表时应尽量遵循范式理论的规约，尽可能的减少冗余字段，让数据库设计看起来精致、优雅。但是，合理的加入冗余字段可以提高查询速度。</li>
</ul>
</li>
</ul>
<h2 id="插入数据的优化（适用于-InnoDB）"><a href="#插入数据的优化（适用于-InnoDB）" class="headerlink" title="插入数据的优化（适用于 InnoDB）"></a>插入数据的优化（适用于 InnoDB）</h2><ul>
<li>插入数据时，影响插入速度的主要是索引、唯一性校验、一次插入的数据条数等。</li>
<li>开发环境情况下的考虑：<ul>
<li>开发场景中，如果需要初始化数据，导入数据等一些操作，而且是开发人员进行处理的，可以考虑在插入数据之前，先禁用整张表的索引，<ul>
<li>禁用索引使用 SQL：<code>ALTER TABLE table_name DISABLE KEYS;</code></li>
<li>当导入完数据之后，重新让MySQL创建索引，并开启索引：<code>ALTER TABLE table_name ENABLE KEYS;</code></li>
</ul>
</li>
<li>如果表中有字段是有唯一性约束的，可以先禁用，然后在开启：<ul>
<li>禁用唯一性检查的语句：<code>SET UNIQUE_CHECKS = 0;</code></li>
<li>开启唯一性检查的语句：<code>SET UNIQUE_CHECKS = 1;</code></li>
</ul>
</li>
<li>禁用外键检查（建议还是少量用外键，而是采用代码逻辑来处理）<ul>
<li>插入数据之前执行禁止对外键的检查，数据插入完成后再恢复，可以提供插入速度。</li>
<li>禁用：<code>SET foreign_key_checks = 0;</code></li>
<li>开启：<code>SET foreign_key_checks = 1;</code></li>
</ul>
</li>
<li>使用批量插入数据</li>
<li>禁止自动提交<ul>
<li>插入数据之前执行禁止事务的自动提交，数据插入完成后再恢复，可以提供插入速度。</li>
<li>禁用：<code>SET autocommit = 0;</code></li>
<li>开启：<code>SET autocommit = 1;</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="服务器优化"><a href="#服务器优化" class="headerlink" title="服务器优化"></a>服务器优化</h2><ul>
<li>好硬件大家都知道，这里没啥好说</li>
<li>通过优化 MySQL 的参数可以提高资源利用率，从而达到提高 MySQL 服务器性能的目的。<ul>
<li>可以看我整理的这篇文章：<a href="https://github.com/judasn/Linux-Tutorial/blob/master/MySQL-Settings/MySQL-5.6/1G-Memory-Machine/my-for-comprehensive.cnf" target="_blank" rel="external">https://github.com/judasn/Linux-Tutorial/blob/master/MySQL-Settings/MySQL-5.6/1G-Memory-Machine/my-for-comprehensive.cnf</a></li>
</ul>
</li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;MySQL-优化&quot;&gt;&lt;a href=&quot;#MySQL-优化&quot; class=&quot;headerlink&quot; title=&quot;MySQL 优化&quot;&gt;&lt;/a&gt;MySQL 优化&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;下面说的优化基于 MySQL 5.6，理论上 5.5 之后的都算试用，具体还是要看官网&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;服务状态查询&quot;&gt;&lt;a href=&quot;#服务状态查询&quot; class=&quot;headerlink&quot; title=&quot;服务状态查询&quot;&gt;&lt;/a&gt;服务状态查询&lt;/h2&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>Yum 下载安装包及对应依赖包</title>
    <link href="//zeroto.tech/2017/11/22/Off-line-Yum-Install/"/>
    <id>//zeroto.tech/2017/11/22/Off-line-Yum-Install/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:54:04.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Yum-下载安装包及对应依赖包"><a href="#Yum-下载安装包及对应依赖包" class="headerlink" title="Yum 下载安装包及对应依赖包"></a>Yum 下载安装包及对应依赖包</h1><a id="more"></a>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ul>
<li><p>安装该软件：<code>yum install -y yum-plugin-downloadonly</code></p>
</li>
<li><p>以下载 openssh-server 为例：</p>
<ul>
<li><code>yum install -y openssh-server --downloadonly --downloaddir=/opt/ssh</code></li>
<li>在 /opt/ssh 目录下有如下内容：</li>
</ul>
</li>
</ul>
<pre><code class="nginx">-rw-r--r--. 1 root root 280524 Aug 13  2015 openssh-5.3p1-112.el6_7.x86_64.rpm
-rw-r--r--. 1 root root 448872 Aug 13  2015 openssh-clients-5.3p1-112.el6_7.x86_64.rpm
-rw-r--r--. 1 root root 331544 Aug 13  2015 openssh-server-5.3p1-112.el6_7.x86_64.rpm
</code></pre>
<ul>
<li>安装下载的 rpm 文件：<code>sudo rpm -ivh *.rpm</code></li>
<li>利用 yum 安装 rpm 文件，并自动满足依赖的 rpm 文件：<code>sudo yum localinstall *.rpm</code></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Yum-下载安装包及对应依赖包&quot;&gt;&lt;a href=&quot;#Yum-下载安装包及对应依赖包&quot; class=&quot;headerlink&quot; title=&quot;Yum 下载安装包及对应依赖包&quot;&gt;&lt;/a&gt;Yum 下载安装包及对应依赖包&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>RabbitMQ 安装和配置</title>
    <link href="//zeroto.tech/2017/11/22/RabbitMQ-Install-And-Settings/"/>
    <id>//zeroto.tech/2017/11/22/RabbitMQ-Install-And-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:58:18.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="RabbitMQ-安装和配置"><a href="#RabbitMQ-安装和配置" class="headerlink" title="RabbitMQ 安装和配置"></a>RabbitMQ 安装和配置</h1><a id="more"></a>
<h2 id="RabbitMQ-说明"><a href="#RabbitMQ-说明" class="headerlink" title="RabbitMQ 说明"></a>RabbitMQ 说明</h2><ul>
<li>MQ 全称为 Message Queue, 消息队列（MQ）是一种应用程序对应用程序的通信方法。应用程序通过读写出入队列的消息（针对应用程序的数据）来通信，而无需专用连接来链接它们。<ul>
<li>RabbitMQ 是一个在 AMQP 基础上完整的，可复用的企业消息系统。他遵循 Mozilla Public License 开源协议。</li>
</ul>
</li>
<li>RabbitMQ WIKI：<a href="https://zh.wikipedia.org/zh/RabbitMQ" target="_blank" rel="external">https://zh.wikipedia.org/zh/RabbitMQ</a></li>
<li>RabbitMQ 百科：<a href="http://baike.baidu.com/view/4095865.htm" target="_blank" rel="external">http://baike.baidu.com/view/4095865.htm</a></li>
<li>RabbitMQ 官网：<a href="http://www.rabbitmq.com/" target="_blank" rel="external">http://www.rabbitmq.com/</a></li>
<li>RabbitMQ 官网下载：<a href="http://www.rabbitmq.com/download.html" target="_blank" rel="external">http://www.rabbitmq.com/download.html</a></li>
<li>RabbitMQ 官网安装文档：<a href="http://www.rabbitmq.com/install-rpm.html" target="_blank" rel="external">http://www.rabbitmq.com/install-rpm.html</a></li>
<li>RabbitMQ 文档：<ul>
<li>优先：<a href="http://www.rabbitmq.com/getstarted.html" target="_blank" rel="external">http://www.rabbitmq.com/getstarted.html</a></li>
<li>次要：<a href="http://www.rabbitmq.com/documentation.html" target="_blank" rel="external">http://www.rabbitmq.com/documentation.html</a></li>
</ul>
</li>
</ul>
<h2 id="先安装-Erlang"><a href="#先安装-Erlang" class="headerlink" title="先安装 Erlang"></a>先安装 Erlang</h2><ul>
<li>有 EPEL 源的情况（需要安装的内容较多，宽带要能跟上）：<code>sudo yum install erlang</code></li>
<li>RabbitMQ 官网提供 Erlang 安装包：<ul>
<li>下载地址：<a href="http://www.rabbitmq.com/releases/erlang/" target="_blank" rel="external">http://www.rabbitmq.com/releases/erlang/</a></li>
<li>下载好之后，安装下面两个文件：<ul>
<li><code>sudo yum localinstall -y esl-erlang_18.1-1~centos~6_amd64.rpm</code></li>
<li><code>sudo yum localinstall -y esl-erlang-compat-18.1-1.noarch.rpm</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="安装-RabbitMQ"><a href="#安装-RabbitMQ" class="headerlink" title="安装 RabbitMQ"></a>安装 RabbitMQ</h2><ul>
<li>此时（2016-04），最新版：<strong>3.6.1</strong></li>
<li>安装：<code>rpm --import https://www.rabbitmq.com/rabbitmq-signing-key-public.asc</code></li>
<li>安装：<code>sudo yum install -y rabbitmq-server-3.6.1-1.noarch.rpm</code></li>
<li>启动服务：<ul>
<li>先看下自己的主机名：<code>hostname</code>，我的主机名是：<strong>judasnHost2</strong></li>
<li>先修改一下 host 文件：<code>vim /etc/hosts</code>，添加一行：<code>127.0.0.1 judasnHost2</code>（必须这样做）</li>
<li>启动：<code>service rabbitmq-server start</code>，启动一般都比较慢，所以别急</li>
<li>停止：<code>service rabbitmq-server stop</code></li>
<li>重启：<code>service rabbitmq-server restart</code></li>
<li>设置开机启动：<code>chkconfig rabbitmq-server on</code></li>
</ul>
</li>
</ul>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><ul>
<li>查找默认配置位置：<code>find / -name &quot;rabbitmq.config.example&quot;</code>，我这边搜索结果是：<code>/usr/share/doc/rabbitmq-server-3.6.1/rabbitmq.config.example</code></li>
<li>复制默认配置：<code>cp /usr/share/doc/rabbitmq-server-3.6.1/rabbitmq.config.example /etc/rabbitmq/</code></li>
<li>修改配置文件名：<code>cd /etc/rabbitmq ; mv rabbitmq.config.example rabbitmq.config</code></li>
<li>编辑配置文件，开启用户远程访问：<code>vim rabbitmq.config</code><ul>
<li>在 64 行，默认有这样一句话：<code>%% {loopback_users, []},</code>，注意，该语句最后有一个逗号，等下是要去掉的</li>
<li>我们需要改为：<code>{loopback_users, []}</code>，</li>
</ul>
</li>
<li>开启 Web 界面管理：<code>rabbitmq-plugins enable rabbitmq_management</code></li>
<li>重启 RabbitMQ 服务：<code>service rabbitmq-server restart</code></li>
<li>开放防火墙端口：<ul>
<li><code>sudo iptables -I INPUT -p tcp -m tcp --dport 15672 -j ACCEPT</code></li>
<li><code>sudo iptables -I INPUT -p tcp -m tcp --dport 5672 -j ACCEPT</code></li>
<li><code>sudo service iptables save</code></li>
<li><code>sudo service iptables restart</code></li>
</ul>
</li>
<li>浏览器访问：<code>http://192.168.1.114:15672</code><br>  默认管理员账号：<strong>guest</strong><br>  默认管理员密码：<strong>guest</strong></li>
<li>添加新授权用户（如下图所示）：<ul>
<li><img src="images/RabbitMQ-Add-User-a-1.jpg" alt="RabbitMQ-Add-User"></li>
</ul>
</li>
<li>添加 Host（如下图所示）：<ul>
<li><img src="images/RabbitMQ-Add-User-a-2.jpg" alt="RabbitMQ-Add-User"></li>
</ul>
</li>
<li>给添加的 Host 设置权限（如下图所示）：<ul>
<li><img src="images/RabbitMQ-Add-User-a-3.gif" alt="RabbitMQ-Add-User"></li>
</ul>
</li>
<li>交换机绑定队列（如下图所示）：<ul>
<li><img src="images/RabbitMQ-Bindings-Queue-a-1.gif" alt="RabbitMQ-Bindings-Queue"></li>
</ul>
</li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;RabbitMQ-安装和配置&quot;&gt;&lt;a href=&quot;#RabbitMQ-安装和配置&quot; class=&quot;headerlink&quot; title=&quot;RabbitMQ 安装和配置&quot;&gt;&lt;/a&gt;RabbitMQ 安装和配置&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>Rap 安装和配置</title>
    <link href="//zeroto.tech/2017/11/22/Rap-Install-And-Settings/"/>
    <id>//zeroto.tech/2017/11/22/Rap-Install-And-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:59:05.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Rap-安装和配置"><a href="#Rap-安装和配置" class="headerlink" title="Rap 安装和配置"></a>Rap 安装和配置</h1><h2 id="本机环境"><a href="#本机环境" class="headerlink" title="本机环境"></a>本机环境</h2><ul>
<li>系统：CentOS 6.7 64 位</li>
<li>MySQL 5.6</li>
<li>JDK 1.8</li>
<li>Tomcat 8</li>
<li>Redis 3.0.7</li>
<li>Rap 0.14.1</li>
</ul>
<h2 id="Rap-说明"><a href="#Rap-说明" class="headerlink" title="Rap 说明"></a>Rap 说明</h2><ul>
<li>官网：<a href="https://github.com/thx/RAP" target="_blank" rel="external">https://github.com/thx/RAP</a></li>
<li>在线版：<a href="http://rap.taobao.org/" target="_blank" rel="external">http://rap.taobao.org/</a></li>
<li>官网 Wiki：<a href="https://github.com/thx/RAP/wiki/home_cn" target="_blank" rel="external">https://github.com/thx/RAP/wiki/home_cn</a></li>
<li>官网部署手册：<a href="https://github.com/thx/RAP/wiki/deploy_manual_cn" target="_blank" rel="external">https://github.com/thx/RAP/wiki/deploy_manual_cn</a></li>
<li>用户手册：<a href="https://github.com/thx/RAP/wiki/user_manual_cn" target="_blank" rel="external">https://github.com/thx/RAP/wiki/user_manual_cn</a></li>
</ul>
<h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><ul>
<li>官网下载：<a href="https://github.com/thx/RAP/releases" target="_blank" rel="external">https://github.com/thx/RAP/releases</a></li>
<li>当前最新版本：<strong>0.14.1</strong></li>
<li>下载 war 部署包：<a href="https://github.com/thx/RAP/releases" target="_blank" rel="external">https://github.com/thx/RAP/releases</a></li>
</ul>
<h2 id="安装-MySQL、JDK、Tomcat、Redis"><a href="#安装-MySQL、JDK、Tomcat、Redis" class="headerlink" title="安装 MySQL、JDK、Tomcat、Redis"></a>安装 MySQL、JDK、Tomcat、Redis</h2><ul>
<li><a href="Mysql-Install-And-Settings.md">MySQL 安装和配置</a></li>
<li><a href="JDK-Install.md">JDK 安装</a></li>
<li><a href="Tomcat-Install-And-Settings.md">Tomcat 安装和配置、优化</a></li>
<li><a href="Redis-Install-And-Settings.md">Redis 安装和配置</a></li>
</ul>
<h2 id="安装-Rap"><a href="#安装-Rap" class="headerlink" title="安装 Rap"></a>安装 Rap</h2><ul>
<li>创建数据库，并创建权限用户</li>
</ul>
<pre><code class="sql">CREATE DATABASE `rap_db` CHARACTER SET utf8;
CREATE USER &#39;rap&#39;@&#39;%&#39; IDENTIFIED BY &#39;123456&#39;;
GRANT ALL PRIVILEGES ON rap_db.* TO &#39;rap&#39;@&#39;%&#39;;
FLUSH PRIVILEGES;
</code></pre>
<ul>
<li>把 RAP-0.14.1-SNAPSHOT.war 移动到 tomcat 的 webapp 目录下，删除其他多余的文件夹</li>
<li>解压：<code>unzip -x RAP-0.14.1-SNAPSHOT.war -d ROOT</code></li>
<li>初始化数据库：<code>mysql -u rap -p rap_db &lt; /usr/program/tomcat8/webapps/ROOT/WEB-INF/classes/database/initialize.sql</code></li>
<li>修改连接数据库的配置信息：<code>vim /usr/program/tomcat8/webapps/ROOT/WEB-INF/classes/config.properties</code></li>
<li>停掉防火墙：<code>service iptables stop</code></li>
<li>启动 Redis：<code>/usr/local/bin/redis-server /etc/redis.conf</code></li>
<li>启动 Tomcat：<code>sh /usr/program/tomcat8/bin/startup.sh ; tail -200f /usr/program/tomcat8/logs/catalina.out</code></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Rap-安装和配置&quot;&gt;&lt;a href=&quot;#Rap-安装和配置&quot; class=&quot;headerlink&quot; title=&quot;Rap 安装和配置&quot;&gt;&lt;/a&gt;Rap 安装和配置&lt;/h1&gt;&lt;h2 id=&quot;本机环境&quot;&gt;&lt;a href=&quot;#本机环境&quot; class=&quot;headerli
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>nmon</title>
    <link href="//zeroto.tech/2017/11/22/Nmon/"/>
    <id>//zeroto.tech/2017/11/22/Nmon/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:51:47.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="nmon-系统性能监控工具的使用"><a href="#nmon-系统性能监控工具的使用" class="headerlink" title="nmon 系统性能监控工具的使用"></a>nmon 系统性能监控工具的使用</h1><a id="more"></a>
<h2 id="nmon-说明"><a href="#nmon-说明" class="headerlink" title="nmon 说明"></a>nmon 说明</h2><ul>
<li>官网：<a href="http://nmon.sourceforge.net/pmwiki.php" target="_blank" rel="external">http://nmon.sourceforge.net/pmwiki.php</a></li>
<li>分析工具 nmon analyser：<a href="https://www.ibm.com/developerworks/community/wikis/home?lang=en#!/wiki/Power+Systems/page/nmon_analyser" target="_blank" rel="external">https://www.ibm.com/developerworks/community/wikis/home?lang=en#!/wiki/Power+Systems/page/nmon_analyser</a></li>
<li><blockquote>
<p>nmon是一种在AIX与各种Linux操作系统上广泛使用的监控与分析工具， nmon所记录的信息是比较全面的，它能在系统运行过程中实时地捕捉系统资源的使用情况，并且能输出结果到文件中。</p>
</blockquote>
</li>
</ul>
<h2 id="下载-安装"><a href="#下载-安装" class="headerlink" title="下载/安装"></a>下载/安装</h2><ul>
<li>Ubuntu：<code>sudo apt-get install -y nmon</code></li>
<li>CentOS：<code>sudo yum install -y nmon</code>，前提是你已经有安装 epel 源<ul>
<li>或者使用 RPM 包：<a href="http://pan.baidu.com/s/1hsFEoeg" target="_blank" rel="external">http://pan.baidu.com/s/1hsFEoeg</a><ul>
<li>安装命令：<code>rpm -ivh nmon-14i-8.el6.x86_64.rpm</code></li>
</ul>
</li>
</ul>
</li>
<li>分析工具 nmon analyser：<a href="http://pan.baidu.com/s/1pKBLXrX" target="_blank" rel="external">http://pan.baidu.com/s/1pKBLXrX</a></li>
</ul>
<h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><ul>
<li>实时监控：<code>nmon</code></li>
<li>后台监控：<code>cd /opt ; nmon -f -s 10 -c 360</code><ul>
<li>前面的 cd /opt 表示，进入 opt 目录，nmon 生成的文件是在当前目录下。</li>
<li>-f ：按标准格式输出文件名称：<hostname>_YYYYMMDD_HHMM.nmon</hostname></li>
<li>-s ：每隔n秒抽样一次，这里为10秒</li>
<li>-c ：取出多少个抽样数量，这里为360，即监控=10*360/3600=1小时</li>
<li>该命令启动后，nmon 会在当前目录下生成监控文件，并持续写入资源数据，直至360个监控点收集完成——即监控1小时，这些操作均自动完成，无需手工干预，测试人员可以继续完成其他操作。如果想停止该监控，需要通过 <code>ps –ef|grep nmon</code> 查询进程号，然后杀掉该进程以停止监控。</li>
</ul>
</li>
<li>定期监控：本质是 crontab 加上后台监控命令</li>
</ul>
<h2 id="解析监控文件"><a href="#解析监控文件" class="headerlink" title="解析监控文件"></a>解析监控文件</h2><ul>
<li>把 nmon 文件转换成 csv 文件：<code>sort localhost_120427_0922.nmon &gt; localhost_120427_0922.csv</code></li>
<li>把 csv 转换成 Excel 图表文件：<ul>
<li>打开 nmon analyser 分析工具：nmon analyser v50_2.xlsm<ul>
<li>点击 Analyse nmon data 会弹出一个弹出框，选择刚刚转换的 csv 文件，然后就会自动再转化成 excel 文件</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://os.51cto.com/art/201406/442795.htm" target="_blank" rel="external">Nmon命令行：Linux系统性能的监测利器</a></li>
<li><a href="http://kumu1988.blog.51cto.com/4075018/1086256" target="_blank" rel="external">性能监控和分析工具–nmon</a></li>
<li><a href="http://www.xuebuyuan.com/1439800.html" target="_blank" rel="external">nmon以及nmon analyser 教程</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;nmon-系统性能监控工具的使用&quot;&gt;&lt;a href=&quot;#nmon-系统性能监控工具的使用&quot; class=&quot;headerlink&quot; title=&quot;nmon 系统性能监控工具的使用&quot;&gt;&lt;/a&gt;nmon 系统性能监控工具的使用&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>SSH</title>
    <link href="//zeroto.tech/2017/11/22/SSH/"/>
    <id>//zeroto.tech/2017/11/22/SSH/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T07:03:22.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SSH（Secure-Shell）介绍"><a href="#SSH（Secure-Shell）介绍" class="headerlink" title="SSH（Secure Shell）介绍"></a>SSH（Secure Shell）介绍</h1><a id="more"></a>
<h2 id="SSH-安装"><a href="#SSH-安装" class="headerlink" title="SSH 安装"></a>SSH 安装</h2><ul>
<li><p>查看是否已安装：</p>
<ul>
<li>CentOS：<code>rpm -qa | grep openssh</code></li>
<li>Ubuntu：<code>dpkg -l | grep openssh</code></li>
</ul>
</li>
<li><p>安装：</p>
<ul>
<li>CentOS 6：<code>sudo yum install -y openssh-server openssh-clients</code></li>
<li>Ubuntu：<code>sudo apt-get install -y openssh-server openssh-client</code></li>
</ul>
</li>
</ul>
<h2 id="SSH-配置文件常用参数"><a href="#SSH-配置文件常用参数" class="headerlink" title="SSH 配置文件常用参数"></a>SSH 配置文件常用参数</h2><ul>
<li>配置文件介绍（记得先备份）：<code>sudo vim /etc/ssh/sshd_config</code><ul>
<li>Port 22 #默认指定 22 端口，可以自己修改</li>
<li>Protocol 2,1 #指定了 SSH 协议版本，目前 SSH 只有两个版本 2 和 1</li>
<li>PasswordAuthentication yes #是否开启密码验证，因为 SSH 也可以设置秘钥类授权登录的方式，如果用这种方式我们可以考虑关掉密码登录的方式。</li>
<li>PermitEmptyPasswords no #是否允许密码为空，与上面参数配合用。</li>
</ul>
</li>
</ul>
<h2 id="SSH-允许-root-账户登录"><a href="#SSH-允许-root-账户登录" class="headerlink" title="SSH 允许 root 账户登录"></a>SSH 允许 root 账户登录</h2><ul>
<li>编辑配置文件（记得先备份）：<code>sudo vim /etc/ssh/sshd_config</code><ul>
<li>允许 root 账号登录<ul>
<li>注释掉：<code>PermitRootLogin without-password</code></li>
<li>新增一行：<code>PermitRootLogin yes</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="SSH-密钥登录"><a href="#SSH-密钥登录" class="headerlink" title="SSH 密钥登录"></a>SSH 密钥登录</h2><ul>
<li>生成秘钥和公钥文件，命令：<code>sudo ssh-keygen</code>，在交互提示中连续按三次回车，如果看得懂交互的表达，那就根据你自己需求来。默认生成密钥和公钥文件是在：/root/.ssh。</li>
<li>进入生成目录：<code>cd /root/.ssh</code>，可以看到有两个文件：id_rsa (私钥) 和 id_rsa.pub (公钥)</li>
<li>在 .ssh 目录下创建 SSH 认证文件，命令：<code>touch /root/.ssh/authorized_keys</code></li>
<li>将公钥内容写到SSH认证文件里面，命令：<code>cat /root/.ssh/id_rsa.pub &gt;&gt; /root/.ssh/authorized_keys</code></li>
<li>修改SSH认证文件权限，命令：<ul>
<li><code>sudo chmod 700 /root/.ssh</code></li>
<li><code>sudo chmod 600 /root/.ssh/authorized_keys</code></li>
</ul>
</li>
<li>重启服务：<code>sudo service ssh restart</code></li>
<li>设置 SSH 服务默认启动：<code>sudo sysv-rc-conf ssh on</code></li>
</ul>
<p>现在 SSH 客户端可以去拿着 SSH 服务器端上的 id_rsa，在客户端指定秘钥文件地址即可，这个一般由于你使用的客户端决定的，我这里推荐的是 Xshell 软件。</p>
<h2 id="SSH-资料"><a href="#SSH-资料" class="headerlink" title="SSH 资料"></a>SSH 资料</h2><ul>
<li><a href="http://www.jikexueyuan.com/course/861_1.html?ss=1" target="_blank" rel="external">http://www.jikexueyuan.com/course/861_1.html?ss=1</a> </li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;SSH（Secure-Shell）介绍&quot;&gt;&lt;a href=&quot;#SSH（Secure-Shell）介绍&quot; class=&quot;headerlink&quot; title=&quot;SSH（Secure Shell）介绍&quot;&gt;&lt;/a&gt;SSH（Secure Shell）介绍&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>iptables</title>
    <link href="//zeroto.tech/2017/11/22/CentOS-Install/"/>
    <id>//zeroto.tech/2017/11/22/CentOS-Install/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:28:20.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CentOS-安装"><a href="#CentOS-安装" class="headerlink" title="CentOS 安装"></a>CentOS 安装</h1><h2 id="概括"><a href="#概括" class="headerlink" title="概括"></a>概括</h2><ul>
<li>本教程中主要演示了 VirtualBox 和 VMware Workstation 下安装 <code>CentOS 6.6</code> 的过程。</li>
<li>VirtualBox 是免费开源，我个人在使用经历中遇到过很多次崩溃、安装有问题等，所以它不是我主推的虚拟机</li>
<li>VMware Workstation 是商业软件，很好用，一些辅助功能也很到位，主推该虚拟机。</li>
</ul>
<a id="more"></a>
<h2 id="VirtualBox-下安装-CentOS-过程"><a href="#VirtualBox-下安装-CentOS-过程" class="headerlink" title="VirtualBox 下安装 CentOS 过程"></a>VirtualBox 下安装 CentOS 过程</h2><ul>
<li>VirtualBox 的介绍和下载<ul>
<li>官网：<a href="https://www.virtualbox.org/" target="_blank" rel="external">https://www.virtualbox.org/</a></li>
<li>wiki：<a href="https://zh.wikipedia.org/zh/VirtualBox" target="_blank" rel="external">https://zh.wikipedia.org/zh/VirtualBox</a></li>
<li>百度 wiki：<a href="http://baike.baidu.com/view/1047853.htm" target="_blank" rel="external">http://baike.baidu.com/view/1047853.htm</a></li>
<li>百度云下载（32 位和 64 位一体）：<a href="http://pan.baidu.com/s/1kTR3hOj" target="_blank" rel="external">http://pan.baidu.com/s/1kTR3hOj</a></li>
<li>官网下载：<a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" rel="external">https://www.virtualbox.org/wiki/Downloads</a></li>
</ul>
</li>
</ul>
<ul>
<li>安装细节开始：<ul>
<li><img src="images/CentOS-Install-VirtualBox-a-1.jpg" alt="VirtualBox 下安装"><ul>
<li>如上图标注 1 所示：点击 <code>新建</code> 一个虚拟机。</li>
<li>如上图标注 2 所示：在填写 <code>名称</code> 的时候，输入 <code>CentOS</code> 相关字眼的时候，下面的版本类型会跟着变化，自动识别为 <code>Red Hat</code></li>
</ul>
</li>
<li><img src="images/CentOS-Install-VirtualBox-a-2.jpg" alt="VirtualBox 下安装"><ul>
<li>如上图标注 1 所示：我们装的是 64 位系统，如果你本机内存足够大，建议可以给 2 ~ 4 G 的容量</li>
</ul>
</li>
<li><img src="images/CentOS-Install-VirtualBox-a-3.jpg" alt="VirtualBox 下安装"></li>
<li><img src="images/CentOS-Install-VirtualBox-a-4.jpg" alt="VirtualBox 下安装"></li>
<li><img src="images/CentOS-Install-VirtualBox-a-5.jpg" alt="VirtualBox 下安装"></li>
<li><img src="images/CentOS-Install-VirtualBox-a-6.jpg" alt="VirtualBox 下安装"><ul>
<li>如上图所示，命名最好规范，最好要带上系统版本号，硬盘大小建议在 8 ~ 20 G</li>
</ul>
</li>
<li><img src="images/CentOS-Install-VirtualBox-b-1.gif" alt="VirtualBox 下安装"><ul>
<li>如上图 gif 演示，当我们创建好虚拟机之后，需要选择模拟光驱进行系统镜像安装</li>
</ul>
</li>
<li><img src="images/CentOS-Install-VirtualBox-a-7.jpg" alt="VirtualBox 下安装"></li>
<li><img src="images/CentOS-Install-VirtualBox-a-8.jpg" alt="VirtualBox 下安装"><ul>
<li>如上图箭头所示，我们这里选择 <code>Skip</code>，跳过对镜像的检查，这个一般需要检查很久，而且我们用 iso 文件安装的，一般没这个必要</li>
</ul>
</li>
<li><img src="images/CentOS-Install-VirtualBox-a-9.jpg" alt="VirtualBox 下安装"></li>
<li><img src="images/CentOS-Install-VirtualBox-a-12.jpg" alt="VirtualBox 下安装"><ul>
<li>如上图标注 1 所示，建议 Linux 纯新手使用简体中文环境</li>
</ul>
</li>
<li><img src="images/CentOS-Install-VirtualBox-a-13.jpg" alt="VirtualBox 下安装"></li>
<li><img src="images/CentOS-Install-VirtualBox-a-14.jpg" alt="VirtualBox 下安装"></li>
<li><img src="images/CentOS-Install-VirtualBox-a-15.jpg" alt="VirtualBox 下安装"><ul>
<li>如上图标注 1 所示，因为我们是用全新的虚拟机，虚拟出来的硬盘都是空的，所以这里可以忽略所有数据</li>
</ul>
</li>
<li><img src="images/CentOS-Install-VirtualBox-a-16.jpg" alt="VirtualBox 下安装"></li>
<li><img src="images/CentOS-Install-VirtualBox-a-17.jpg" alt="VirtualBox 下安装"></li>
<li><img src="images/CentOS-Install-VirtualBox-a-18.jpg" alt="VirtualBox 下安装"><ul>
<li>再次强调下，root 账号也就是图上所说的 <code>根账号</code>，它是最顶级账号，密码最好别忘记了</li>
</ul>
</li>
<li><img src="images/CentOS-Install-VirtualBox-a-19.jpg" alt="VirtualBox 下安装"></li>
<li><img src="images/CentOS-Install-VirtualBox-a-20.jpg" alt="VirtualBox 下安装"><ul>
<li>如上图标注 1 所示，因为我们是用全新的虚拟机，所以这里选择 <code>使用所有空间</code> ，然后 CentOS 会按它默认的方式进行分区</li>
</ul>
</li>
<li><img src="images/CentOS-Install-VirtualBox-a-21.jpg" alt="VirtualBox 下安装"></li>
<li><img src="images/CentOS-Install-VirtualBox-a-22.jpg" alt="VirtualBox 下安装"><ul>
<li><code>Desktop</code> 代表：图形界面版，会默认安装很多软件，建议新手选择此模式，我后面其他文章的讲解都是基于此系统下，如果你不是此模式的系统可能在安装某些软件的时候会出现某些依赖包没有安装的情况</li>
<li><code>basic sever</code> 代表：命令行界面，有良好基础的基本都会喜欢这个 </li>
</ul>
</li>
<li><img src="images/CentOS-Install-VirtualBox-a-23.jpg" alt="VirtualBox 下安装"><ul>
<li>上一步我选择的是 <code>Desktop</code> 所以有很多软件需要安装，这个过程大概需要 5 ~ 10 分钟</li>
</ul>
</li>
<li><img src="images/CentOS-Install-VirtualBox-a-24.jpg" alt="VirtualBox 下安装"><ul>
<li>安装完成</li>
</ul>
</li>
<li><img src="images/CentOS-Install-VirtualBox-a-25.jpg" alt="VirtualBox 下安装"> <ul>
<li>安装完成后一定要把盘片删除，防止系统启动的时候去读盘，重新进入安装系统模式</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="VMware-下安装-CentOS-过程"><a href="#VMware-下安装-CentOS-过程" class="headerlink" title="VMware 下安装 CentOS 过程"></a>VMware 下安装 CentOS 过程</h2><ul>
<li>VMware Workstation 的介绍和下载<ul>
<li>官网：<a href="https://www.vmware.com/products/workstation" target="_blank" rel="external">https://www.vmware.com/products/workstation</a></li>
<li>wiki：<a href="https://zh.wikipedia.org/wiki/VMware_Workstation" target="_blank" rel="external">https://zh.wikipedia.org/wiki/VMware_Workstation</a></li>
<li>百度 wiki：<a href="http://baike.baidu.com/view/555554.htm" target="_blank" rel="external">http://baike.baidu.com/view/555554.htm</a></li>
<li>百度云下载（64 位）：<a href="http://pan.baidu.com/s/1eRuJAFK" target="_blank" rel="external">http://pan.baidu.com/s/1eRuJAFK</a></li>
<li>官网下载：<a href="http://www.vmware.com/products/workstation/workstation-evaluation" target="_blank" rel="external">http://www.vmware.com/products/workstation/workstation-evaluation</a></li>
</ul>
</li>
</ul>
<ul>
<li>安装细节开始：<ul>
<li><img src="images/CentOS-install-VMware-a-1.jpg" alt="VMware 下安装"> </li>
<li><img src="images/CentOS-install-VMware-a-2.jpg" alt="VMware 下安装"><ul>
<li>默认 VMware 选择的是 <code>典型</code> 我不推荐，我下面的步骤是选择 <code>自定义（高级）</code>。如果你非常了解 Linux 系统倒是可以考虑选择 <code>典型</code>，在它默认安装完的系统上可以很好地按你的需求进行修改</li>
</ul>
</li>
<li><img src="images/CentOS-install-VMware-a-3.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-a-4.jpg" alt="VMware 下安装"><ul>
<li>牢记：不要在这一步就选择镜像文件，不然也会直接进入 <code>典型</code> 模式，直接按它的规则进行系统安装</li>
</ul>
</li>
<li><img src="images/CentOS-install-VMware-a-5.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-a-6.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-a-7.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-a-8.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-a-9.jpg" alt="VMware 下安装"><ul>
<li>桥接模式：（建议选择此模式）创建一个独立的虚拟主机，在桥接模式下的虚拟主机网络一般要为其配 IP 地址、子网掩码、默认网关（虚拟机ip地址要与主机ip地址处于同网段）</li>
<li>NAT 模式：把物理主机作为路由器进行访问互联网，优势:联网简单，劣势:虚拟主机无法与物理主机通讯</li>
<li>主机模式：把虚拟主机网络与真实网络隔开，但是各个虚拟机之间可以互相连接，虚拟机和物理机也可以连接</li>
<li><blockquote>
<p>上面解释来源：<a href="http://jingyan.baidu.com/article/3f16e003cd0a0d2591c103b4.html" target="_blank" rel="external">http://jingyan.baidu.com/article/3f16e003cd0a0d2591c103b4.html</a></p>
</blockquote>
</li>
</ul>
</li>
<li><img src="images/CentOS-install-VMware-a-10.jpg" alt="VMware 下安装"><ul>
<li>Buslogic 和 LSIlogic 都是虚拟硬盘 SCSI 设备的类型，旧版本的 OS 默认的是 Buslogic，LSIlogic 类型的硬盘改进了性能，对于小文件的读取速度有提高，支持非 SCSI 硬盘比较好。</li>
<li><blockquote>
<p>上面解释来源：<a href="http://www.cnblogs.com/R-zqiang/archive/2012/11/23/2785134.html" target="_blank" rel="external">http://www.cnblogs.com/R-zqiang/archive/2012/11/23/2785134.html</a></p>
</blockquote>
</li>
</ul>
</li>
<li><img src="images/CentOS-install-VMware-a-11.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-a-12.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-a-13.jpg" alt="VMware 下安装"><ul>
<li>强烈建议至少要给 20 G，不然装不了多少软件的</li>
</ul>
</li>
<li><img src="images/CentOS-install-VMware-a-14.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-a-15.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-b-1.gif" alt="VMware 下安装"><ul>
<li>如上图 gif 所示，在创建完虚拟机之后，我们要加载系统镜像，然后启动虚拟机进行安装，接下来的安装步骤跟上面使用 VirtualBox 安装细节基本一样，不一样的地方是我这里选择的是自定义分区，不再是选择默认分区方式</li>
</ul>
</li>
<li><img src="images/CentOS-install-VMware-a-16.jpg" alt="VMware 下安装"><ul>
<li>如上图箭头所示，这里我们选择自定义分区方式</li>
</ul>
</li>
<li><img src="images/CentOS-install-VMware-b-2.gif" alt="VMware 下安装"><ul>
<li>如上图 gif 所示，我只把最基本的区分出来，如果你有自己的需求可以自己设置</li>
<li>简单分区方案：<ul>
<li><code>/boot</code> == 500 M（主分区）</li>
<li><code>/swap</code> == 2 G（逻辑分区）一般大家的说法这个大小是跟你机子的内存大小相关的，也有说法内存大不需要这个，但是还是建议分，虚拟机内存 2 G，所以我分 2 G</li>
<li><code>/</code> == 剩余容量（逻辑分区）剩余的空间都给了根分区</li>
</ul>
</li>
</ul>
</li>
<li><img src="images/CentOS-install-VMware-a-17.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-a-18.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-a-19.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-a-20.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-a-21.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-a-22.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-a-23.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-a-24.jpg" alt="VMware 下安装"></li>
<li><img src="images/CentOS-install-VMware-a-25.jpg" alt="VMware 下安装"></li>
</ul>
</li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;CentOS-安装&quot;&gt;&lt;a href=&quot;#CentOS-安装&quot; class=&quot;headerlink&quot; title=&quot;CentOS 安装&quot;&gt;&lt;/a&gt;CentOS 安装&lt;/h1&gt;&lt;h2 id=&quot;概括&quot;&gt;&lt;a href=&quot;#概括&quot; class=&quot;headerlink&quot; title=&quot;概括&quot;&gt;&lt;/a&gt;概括&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;本教程中主要演示了 VirtualBox 和 VMware Workstation 下安装 &lt;code&gt;CentOS 6.6&lt;/code&gt; 的过程。&lt;/li&gt;
&lt;li&gt;VirtualBox 是免费开源，我个人在使用经历中遇到过很多次崩溃、安装有问题等，所以它不是我主推的虚拟机&lt;/li&gt;
&lt;li&gt;VMware Workstation 是商业软件，很好用，一些辅助功能也很到位，主推该虚拟机。&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>VMware 克隆 CentOS 后网卡信息修改</title>
    <link href="//zeroto.tech/2017/11/22/CentOS-Virtual-Machine-Copy-Settings/"/>
    <id>//zeroto.tech/2017/11/22/CentOS-Virtual-Machine-Copy-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:30:49.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="VMware-克隆-CentOS-后网卡信息修改"><a href="#VMware-克隆-CentOS-后网卡信息修改" class="headerlink" title="VMware 克隆 CentOS 后网卡信息修改"></a>VMware 克隆 CentOS 后网卡信息修改</h1><a id="more"></a>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><ul>
<li>在我们需要多台 CentOS 虚拟机的时候，对已有虚拟机的系统进行克隆或是复制。但是这样做又有一个问题，克隆出来的虚拟机启动的时候你输入命令：<code>ifconfig</code>，eth0 网卡信息没了，只有一个 eth1。 对于处女座的人来讲这是不允许的。所以我们需要改动下。</li>
<li>复制虚拟机后，首次打开该会提示如下内容，一般选择 copy 这个配置。<ul>
<li><img src="images/CentOS-Virtual-Machine-Copy-Settings-a-1.png" alt="vim"></li>
</ul>
</li>
</ul>
<h2 id="修改方法"><a href="#修改方法" class="headerlink" title="修改方法"></a>修改方法</h2><ul>
<li><p>命令：<code>sudo vim /etc/udev/rules.d/70-persistent-net.rules</code></p>
<ul>
<li>该文件中正常此时应该有两行信息</li>
<li>在文件中把 NAME=”eth0″ 的这一行注释掉</li>
<li>对于另一行，把 NAME=”eth1″ 的这一行，把 NAME=”eth1″ 改为 NAME=”eth0″，并且把该行：ATTRS{address}==”00:0c:29:4c:46:01″ 这个属性信息记下来，每台机子都不一样，我这段信息只是例子，你不要直接复制我的。</li>
</ul>
</li>
<li><p>命令：<code>sudo vim /etc/sysconfig/network-scripts/ifcfg-eth0</code></p>
<ul>
<li>修改 IP 地址</li>
<li>把 HWADDR 的值改为上面要求记下来的：00:0c:29:4c:46:01</li>
</ul>
</li>
<li><p>命令：<code>nmcli con</code></p>
<ul>
<li>如果显示两行 UUID 的信息的话，复制不是 System eth0 的那个 UUID 值，下面有用。</li>
<li>编辑：<code>sudo vim /etc/sysconfig/network-scripts/ifcfg-eth0</code></li>
<li>把文件中的 UUID 值 改为上面要求复制的 UUID 值。</li>
<li>保存配置文件，重启系统，正常应该是可以了。</li>
</ul>
</li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;VMware-克隆-CentOS-后网卡信息修改&quot;&gt;&lt;a href=&quot;#VMware-克隆-CentOS-后网卡信息修改&quot; class=&quot;headerlink&quot; title=&quot;VMware 克隆 CentOS 后网卡信息修改&quot;&gt;&lt;/a&gt;VMware 克隆 CentOS 后网卡信息修改&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>iptables</title>
    <link href="//zeroto.tech/2017/11/22/Samba/"/>
    <id>//zeroto.tech/2017/11/22/Samba/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T07:01:27.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Samba-介绍"><a href="#Samba-介绍" class="headerlink" title="Samba 介绍"></a>Samba 介绍</h1><a id="more"></a>
<h2 id="Samba-安装"><a href="#Samba-安装" class="headerlink" title="Samba 安装"></a>Samba 安装</h2><ul>
<li><p>查看是否已安装：</p>
<ul>
<li>CentOS：<code>rpm -qa | grep samba</code></li>
<li>Ubuntu：<code>dpkg -l | grep samba</code></li>
</ul>
</li>
<li><p>安装：</p>
<ul>
<li>CentOS 6：<code>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</code></li>
<li>Ubuntu：<code>sudo apt-get install -y samba samba-client</code></li>
</ul>
</li>
</ul>
<h2 id="Samba-服务器配置文件常用参数"><a href="#Samba-服务器配置文件常用参数" class="headerlink" title="Samba 服务器配置文件常用参数"></a>Samba 服务器配置文件常用参数</h2><ul>
<li>配置文件介绍（记得先备份）：<code>sudo vim /etc/samba/smb.conf</code><ul>
<li>该配置解释：<ul>
<li>在 [globle] 区域<ul>
<li>workgroup = WORKGROUP #WORKGROUP表示Windows默认的工作组名称，一般共享给windows是设置为WORKGROUP</li>
<li>security = user #ubuntu下配置文件默认没有这句,这个是自己填上去的。表示指定samba的安全等级，安全等级分别有四种：share（其他人不需要账号密码即可访问共享目录）、user（检查账号密码）、server（表示检查密码由另外一台服务器负责）、domain（指定Windows域控制服务器来验证用户的账号和密码）</li>
</ul>
</li>
<li>在新区域区域<ul>
<li>当 security = share 使用下面这段，这段自己添加的，其中myshare这个名字表示其他机子访问该分享地址时用：file://该服务机IP/myshare<pre><code>[myshare]
comment = share all
path = /opt/mysamba #分享的目录，其中这个目录需要chmod 777 /opt/mysamba权限
browseable = yes
writable = yes
public =yes
</code></pre></li>
<li>当 security = user 使用下面这段，这段自己添加的，其中 myshare2 这个名字表示其他机子访问该分享地址时用：file://该服务机IP/myshare2</li>
<li>可以返回的账号必须是系统已经存在的账号。先给系统添加账号：<code>useradd user1</code>，再用samba的设置添加账号：<code>pdbedit -a user1</code>，会让你设立该samba账号密码。列出账号：<code>pdbedit -L</code><pre><code>[myshare2]
comment = share for users
path = /opt/mysamba2  #分享的目录，其中这个目录需要chmod 777 /opt/mysamba权限
browseable = yes
writable = yes
public = no
</code></pre></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>启动服务：<ul>
<li><code>sudo service samba restart</code></li>
</ul>
</li>
</ul>
<h2 id="Samba-资料"><a href="#Samba-资料" class="headerlink" title="Samba 资料"></a>Samba 资料</h2><ul>
<li><a href="http://www.lvtao.net/linux/555.html" target="_blank" rel="external">http://www.lvtao.net/linux/555.html</a> </li>
<li><a href="https://www.centos.bz/2011/07/centos5-install-samba-windows-linux-fileshare/" target="_blank" rel="external">https://www.centos.bz/2011/07/centos5-install-samba-windows-linux-fileshare/</a> </li>
<li><a href="https://wsgzao.github.io/post/samba/" target="_blank" rel="external">https://wsgzao.github.io/post/samba/</a> </li>
<li><a href="http://linux.vbird.org/linux_server/0370samba.php" target="_blank" rel="external">http://linux.vbird.org/linux_server/0370samba.php</a> </li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Samba-介绍&quot;&gt;&lt;a href=&quot;#Samba-介绍&quot; class=&quot;headerlink&quot; title=&quot;Samba 介绍&quot;&gt;&lt;/a&gt;Samba 介绍&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>Redis 安装和配置</title>
    <link href="//zeroto.tech/2017/11/22/Redis-Install-And-Settings/"/>
    <id>//zeroto.tech/2017/11/22/Redis-Install-And-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T07:00:44.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Redis-安装和配置"><a href="#Redis-安装和配置" class="headerlink" title="Redis 安装和配置"></a>Redis 安装和配置</h1><a id="more"></a>
<h2 id="Redis-安装"><a href="#Redis-安装" class="headerlink" title="Redis 安装"></a>Redis 安装</h2><ul>
<li>Redis 安装<ul>
<li>官网：<a href="http://redis.io/" target="_blank" rel="external">http://redis.io/</a></li>
<li>官网下载：<a href="http://redis.io/download" target="_blank" rel="external">http://redis.io/download</a></li>
<li>官网 Github 地址：<a href="https://github.com/redis" target="_blank" rel="external">https://github.com/redis</a></li>
<li>此时（20160212） Redis 最新稳定版本为：<strong>3.0.7</strong></li>
<li>官网帮助中心：<a href="http://redis.io/documentation" target="_blank" rel="external">http://redis.io/documentation</a></li>
<li>我个人习惯 <code>/opt</code> 目录下创建一个目录 <code>setups</code> 用来存放各种软件安装包；在 <code>/usr</code> 目录下创建一个 <code>program</code> 用来存放各种解压后的软件包，下面的讲解也都是基于此习惯</li>
<li>我个人已经使用了第三方源：<code>EPEL、RepoForge</code>，如果你出现 <code>yum install XXXXX</code> 安装不成功的话，很有可能就是你没有相关源，请查看我对源设置的文章</li>
<li>Redis 下载：<code>wget http://download.redis.io/releases/redis-3.0.7.tar.gz</code> （大小：1.4 M）<ul>
<li>安装依赖包：<code>yum install -y gcc-c++ tcl</code></li>
<li>解压：<code>tar zxvf redis-3.0.7.tar.gz</code></li>
<li>移动到我个人安装目录：<code>mv redis-3.0.7/ /usr/program/</code></li>
<li>进入解压后目录：<code>cd /usr/program/redis-3.0.7/</code></li>
<li>编译：<code>make</code></li>
<li>编译安装：<code>make install</code><ul>
<li>安装完之后会在：<code>/usr/local/bin</code> 目录下生成好几个 redis 相关的文件</li>
</ul>
</li>
<li>复制配置文件：<code>cp /usr/program/redis-3.0.7/redis.conf /etc/</code></li>
<li>修改配置：<code>vim /etc/redis.conf</code><ul>
<li>把旧值：<code>daemonize no</code> </li>
<li>改为新值：<code>daemonize yes</code> </li>
</ul>
</li>
<li>启动：<code>/usr/local/bin/redis-server /etc/redis.conf</code></li>
<li>查看是否启动：<code>ps -ef | grep redis</code></li>
<li>进入客户端：<code>redis-cli</code></li>
<li>关闭客户端：<code>redis-cli shutdown</code></li>
<li>开机启动配置：<code>echo &quot;/usr/local/bin/redis-server /etc/redis.conf&quot; &gt;&gt; /etc/rc.local</code></li>
<li>开放防火墙端口：<ul>
<li>添加规则：<code>sudo iptables -I INPUT -p tcp -m tcp --dport 6379 -j ACCEPT</code></li>
<li>保存规则：<code>sudo /etc/rc.d/init.d/iptables save</code></li>
<li>重启 iptables：<code>sudo service iptables restart</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Redis-配置"><a href="#Redis-配置" class="headerlink" title="Redis 配置"></a>Redis 配置</h2><ul>
<li>编辑配置文件：<code>vim /usr/program/redis-3.0.7/redis.conf</code></li>
<li>Redis 默认的配置文件内容：</li>
</ul>
<pre><code class="ini"># 是否以后台daemon方式运行，默认是 no，一般我们会改为 yes
daemonize no
pidfile /var/run/redis.pid
port 6379
tcp-backlog 511
timeout 0
tcp-keepalive 0
loglevel notice
logfile &quot;&quot;
# 开启数据库的数量，Redis 是有数据库概念的，默认是 16 个，数字从 0 ~ 15
databases 16
save 900 1
save 300 10
save 60 10000
stop-writes-on-bgsave-error yes
rdbcompression yes
rdbchecksum yes
dbfilename dump.rdb
dir ./
slave-serve-stale-data yes
slave-read-only yes
repl-diskless-sync no
repl-diskless-sync-delay 5
repl-disable-tcp-nodelay no
slave-priority 100
appendonly no
appendfilename &quot;appendonly.aof&quot;
appendfsync everysec
no-appendfsync-on-rewrite no
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb
aof-load-truncated yes
lua-time-limit 5000
slowlog-log-slower-than 10000
slowlog-max-len 128
latency-monitor-threshold 0
notify-keyspace-events &quot;&quot;
hash-max-ziplist-entries 512
hash-max-ziplist-value 64
list-max-ziplist-entries 512
list-max-ziplist-value 64
set-max-intset-entries 512
zset-max-ziplist-entries 128
zset-max-ziplist-value 64
hll-sparse-max-bytes 3000
activerehashing yes
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit slave 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60
hz 10
aof-rewrite-incremental-fsync yes
</code></pre>
<h2 id="Redis-常用命令"><a href="#Redis-常用命令" class="headerlink" title="Redis 常用命令"></a>Redis 常用命令</h2><ul>
<li>命令是不区分大小写的，但是这里为了方便和后面的 key value 进行区分所以我全部写大写，你也可以用小写。<ul>
<li>但是需要注意的是：key 是完全区分大小写的，比如 key=codeBlog 和 key=codeblog 是两个键值</li>
</ul>
</li>
<li>官网命令列表：<a href="http://redis.io/commands" target="_blank" rel="external">http://redis.io/commands</a></li>
<li><code>SET key value</code>，设值。eg：<code>SET myblog www.youmeek.com</code></li>
<li><code>GET key</code>，取值</li>
<li><code>INCR key</code>，递增数字</li>
<li><code>DECR key</code>，递减数字</li>
<li><code>KEYS *</code>，查看当前数据库下所有的 key</li>
<li><code>APPEND key value</code>，给尾部追加内容，如果要追加的 key 不存在，则相当于 SET key value</li>
<li><code>STRLEN key</code>，返回键值的长度，如果键不存在则返回 0</li>
<li><code>MSET key1 value1 key2 value2</code>，同时设置多值</li>
<li><code>MGET key1 value1 key2 value2</code>，同时取多值</li>
<li><code>EXPIRE key 27</code>，设置指定键的生存时间，27 的单位是秒</li>
<li><code>TTL key</code>，查看键的剩余生存时间<ul>
<li>返回 -2，表示不存在，过了生存时间后被删除</li>
<li>返回 -1，表示没有生存时间，永久存储</li>
<li>返回正整数，表示还剩下对应的生存时间</li>
</ul>
</li>
<li><code>PERSIST key</code>，清除生成时间，重新变成永久存储（重新设置 key 的值也可以起到清除生存时间的效果）</li>
<li><code>FLUSHDB</code>，清空当前数据库所有键值</li>
<li><code>FLUSHALL</code>，清空所有数据库的所有键值</li>
</ul>
<h2 id="Redis-客户端"><a href="#Redis-客户端" class="headerlink" title="Redis 客户端"></a>Redis 客户端</h2><ul>
<li>Java：<a href="http://redis.io/clients#java" target="_blank" rel="external">http://redis.io/clients#java</a></li>
<li>Jedis 官网：<a href="https://github.com/xetorthio/jedis" target="_blank" rel="external">https://github.com/xetorthio/jedis</a></li>
</ul>
<h2 id="Redis-GUI-管理工具"><a href="#Redis-GUI-管理工具" class="headerlink" title="Redis GUI 管理工具"></a>Redis GUI 管理工具</h2><ul>
<li>Redis Desktop Manager<ul>
<li>官网：<a href="http://redisdesktop.com/" target="_blank" rel="external">http://redisdesktop.com/</a></li>
<li>官网下载：<a href="http://redisdesktop.com/download" target="_blank" rel="external">http://redisdesktop.com/download</a></li>
<li>效果如下图：</li>
<li><img src="images/Redis-GUI-a-1.jpg" alt="Redis Desktop Manager"></li>
</ul>
</li>
</ul>
<h2 id="Redis-主从（主从从）配置"><a href="#Redis-主从（主从从）配置" class="headerlink" title="Redis 主从（主从从）配置"></a>Redis 主从（主从从）配置</h2><h3 id="Redis-主从架构"><a href="#Redis-主从架构" class="headerlink" title="Redis 主从架构"></a>Redis 主从架构</h3><ul>
<li>假设有两台服务器，一台做主，一台做从<ul>
<li>Redis 主信息：<ul>
<li>IP：<strong>12.168.1.114</strong>=</li>
<li>端口：<strong>6379</strong></li>
</ul>
</li>
<li>Redis 从信息：<ul>
<li>IP：<strong>12.168.1.115</strong></li>
<li>端口：<strong>6379</strong></li>
</ul>
</li>
</ul>
</li>
<li>编辑从机的 Redis 配置文件，找到 210 行（大概），默认这一行应该是注释的：<code># slaveof &lt;masterip&gt; &lt;masterport&gt;</code></li>
<li>我们需要去掉该注释，并且填写我们自己的主机的 IP 和 端口，比如：<code>slaveof 192.168.1.114 6379</code></li>
<li>配置完成后重启从机 Redis 服务</li>
<li>重启完之后，进入主机的 redis-cli 状态下，输入：<code>INFO replication</code><ul>
<li>可以查询到当前主机的 redis 处于什么角色，有哪些从机已经连上主机。</li>
</ul>
</li>
<li>此时已经完成了主从配置，我们可以测试下：<ul>
<li>我们进入主机的 redis-cli 状态，然后 set 某个值，比如：<code>set myblog YouMeek.com</code></li>
</ul>
</li>
<li>我们切换进入从机的 redis-cli 的状态下，获取刚刚设置的值看是否存在：<code>get myblog</code>，此时，我们可以发现是可以获取到值的。</li>
<li>但是有一个需要注意的：从库不具备写入数据能力，不然会报错。 从库只有只读能力。</li>
</ul>
<h3 id="Redis主从从架构"><a href="#Redis主从从架构" class="headerlink" title="Redis主从从架构"></a>Redis主从从架构</h3><ul>
<li>Redis 主从从的意思：看桌面上的截图。</li>
<li>优点，除了减少主库连接的压力，还有可以关掉主库的持久化功能，把持久化的功能交给从库进行处理。</li>
<li>第一个从库配置的信息是连上主库，后面的第二个从库配置的连接信息是连上第一个从库， 假如还有第三个从库的话，我们可以把第三个从库的配置信息连上第二个从库上，以此类推。</li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://yanshisan.blog.51cto.com/7879234/1377992" target="_blank" rel="external">http://yanshisan.blog.51cto.com/7879234/1377992</a></li>
<li><a href="https://segmentfault.com/a/1190000002685224" target="_blank" rel="external">https://segmentfault.com/a/1190000002685224</a></li>
<li><a href="http://itbilu.com/linux/management/4kB2ninp.html" target="_blank" rel="external">http://itbilu.com/linux/management/4kB2ninp.html</a></li>
<li><a href="http://keenwon.com/1335.html" target="_blank" rel="external">http://keenwon.com/1335.html</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Redis-安装和配置&quot;&gt;&lt;a href=&quot;#Redis-安装和配置&quot; class=&quot;headerlink&quot; title=&quot;Redis 安装和配置&quot;&gt;&lt;/a&gt;Redis 安装和配置&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>Subversion 1.8 安装</title>
    <link href="//zeroto.tech/2017/11/22/SVN-Install-And-Settings/"/>
    <id>//zeroto.tech/2017/11/22/SVN-Install-And-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T07:04:18.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Subversion-1-8-安装"><a href="#Subversion-1-8-安装" class="headerlink" title="Subversion 1.8 安装"></a>Subversion 1.8 安装</h1><a id="more"></a>
<h2 id="RPM-安装（推荐）"><a href="#RPM-安装（推荐）" class="headerlink" title="RPM 安装（推荐）"></a>RPM 安装（推荐）</h2><ul>
<li>wandisco 整理的 RPM 文件官网：<a href="http://opensource.wandisco.com/centos/6/svn-1.8/RPMS/x86_64/" target="_blank" rel="external">http://opensource.wandisco.com/centos/6/svn-1.8/RPMS/x86_64/</a></li>
<li>下载下面几个 RPM 文件：<ul>
<li>创建目录来保存下载的 RPM：<code>sudo mkdir -p /opt/setups/subversion/ ; cd /opt/setups/subversion/</code></li>
<li><code>wget http://opensource.wandisco.com/centos/6/svn-1.8/RPMS/x86_64/mod_dav_svn-1.8.15-1.x86_64.rpm</code></li>
<li><code>wget http://opensource.wandisco.com/centos/6/svn-1.8/RPMS/x86_64/serf-1.3.7-1.x86_64.rpm</code></li>
<li><code>wget http://opensource.wandisco.com/centos/6/svn-1.8/RPMS/x86_64/subversion-1.8.15-1.x86_64.rpm</code></li>
<li><code>wget http://opensource.wandisco.com/centos/6/svn-1.8/RPMS/x86_64/subversion-gnome-1.8.15-1.x86_64.rpm</code></li>
<li><code>wget http://opensource.wandisco.com/centos/6/svn-1.8/RPMS/x86_64/subversion-javahl-1.8.15-1.x86_64.rpm</code></li>
<li><code>wget http://opensource.wandisco.com/centos/6/svn-1.8/RPMS/x86_64/subversion-perl-1.8.15-1.x86_64.rpm</code></li>
<li><code>wget http://opensource.wandisco.com/centos/6/svn-1.8/RPMS/x86_64/subversion-python-1.8.15-1.x86_64.rpm</code></li>
<li><code>wget http://opensource.wandisco.com/centos/6/svn-1.8/RPMS/x86_64/subversion-tools-1.8.15-1.x86_64.rpm</code></li>
<li>如果上面的 RPM 链接失效，你也可以考虑下载我提供的百度云盘地址：<a href="http://pan.baidu.com/s/1pKnGia3" target="_blank" rel="external">http://pan.baidu.com/s/1pKnGia3</a></li>
</ul>
</li>
</ul>
<ul>
<li>安装下载的 RPM 文件：<ul>
<li><code>sudo rpm -ivh *.rpm</code></li>
</ul>
</li>
</ul>
<ul>
<li>检查安装后的版本：<ul>
<li><code>svn --version</code></li>
</ul>
</li>
</ul>
<h2 id="编译安装（不推荐）"><a href="#编译安装（不推荐）" class="headerlink" title="编译安装（不推荐）"></a>编译安装（不推荐）</h2><ul>
<li>subversion 1.8 编译安装（本人没有尝试成功，所以不推荐，下面内容只供参考）<ul>
<li>官网安装说明（查找关键字 <code>Dependency Overview</code>）：<a href="http://svn.apache.org/repos/asf/subversion/trunk/INSTALL" target="_blank" rel="external">http://svn.apache.org/repos/asf/subversion/trunk/INSTALL</a></li>
<li>此时 1.8 最新版本为：<code>subversion-1.8.15.tar.gz</code></li>
<li>我个人习惯 <code>/opt</code> 目录下创建一个目录 <code>setups</code> 用来存放各种软件安装包；在 <code>/usr</code> 目录下创建一个 <code>program</code> 用来存放各种解压后的软件包，下面的讲解也都是基于此习惯</li>
<li>我个人已经使用了第三方源：<code>EPEL、RepoForge</code>，如果你出现 <code>yum install XXXXX</code> 安装不成功的话，很有可能就是你没有相关源，请查看我对源设置的文章</li>
<li>安装编译所需工具：<ul>
<li><code>sudo yum install -y gcc gcc-c++ autoconf libtool</code></li>
</ul>
</li>
<li>所需依赖包说明：<ul>
<li>（必要包）apr 和 apr-util 官网地址：<a href="http://archive.apache.org/dist/apr/" target="_blank" rel="external">http://archive.apache.org/dist/apr/</a></li>
<li>（必要包）zlib 官网地址：<a href="ttp://www.zlib.net/" target="_blank" rel="external">ttp://www.zlib.net/</a></li>
<li>（必要包）SQLite 官网地址：<a href="http://www.sqlite.org/download.html" target="_blank" rel="external">http://www.sqlite.org/download.html</a></li>
<li>（必要包）Subversion 官网地址：<a href="https://subversion.apache.org/download.cgi" target="_blank" rel="external">https://subversion.apache.org/download.cgi</a></li>
</ul>
</li>
<li>所需依赖包下载：<ul>
<li>apr 下载：<code>wget http://archive.apache.org/dist/apr/apr-1.5.2.tar.gz</code></li>
<li>apr-util 下载：<code>wget http://archive.apache.org/dist/apr/apr-util-1.5.4.tar.gz</code></li>
<li>zlib 下载：<code>wget http://zlib.net/zlib-1.2.8.tar.gz</code></li>
<li>SQLite 下载：<code>wget http://www.sqlite.org/2016/sqlite-amalgamation-3100200.zip</code></li>
<li>Subversion 下载：<code>wget http://apache.fayea.com/subversion/subversion-1.8.15.tar.gz</code></li>
</ul>
</li>
<li>安装依赖包：    <ul>
<li>apr 安装：<ul>
<li>解压：<code>tar -zxvf apr-1.5.2.tar.gz</code></li>
<li>移动到我个人习惯的安装目录下：<code>mv apr-1.5.2/ /usr/program/</code></li>
<li>标准的 GNU 源码安装方式：<ul>
<li><code>cd /usr/program/apr-1.5.2</code></li>
<li><code>./configure</code></li>
<li><code>make</code></li>
<li><code>make install</code></li>
</ul>
</li>
<li>安装完得到安装的配置路径：<code>/usr/local/apr/bin/apr-1-config</code>，这个需要记下来，下面会用到</li>
</ul>
</li>
<li>apr-util 安装：<ul>
<li>解压：<code>tar -zxvf apr-util-1.5.4.tar.gz</code></li>
<li>移动到我个人习惯的安装目录下：<code>mv apr-util-1.5.4/ /usr/program/</code></li>
<li>标准的 GNU 源码安装方式：<ul>
<li><code>cd /usr/program/apr-util-1.5.4/</code></li>
<li><code>./configure  --with-apr=/usr/local/apr/bin/apr-1-config</code></li>
<li><code>make</code></li>
<li><code>make install</code></li>
</ul>
</li>
<li>安装完得到安装的配置路径：<code>/usr/local/apr/bin/apu-1-config</code>，这个需要记下来，下面会用到</li>
</ul>
</li>
<li>zlib 安装：<ul>
<li>解压：<code>tar -zxvf zlib-1.2.8.tar.gz</code></li>
<li>移动到我个人习惯的安装目录下：<code>mv zlib-1.2.8/ /usr/program/</code></li>
<li>标准的 GNU 源码安装方式：<ul>
<li><code>cd /usr/program/zlib-1.2.8/</code></li>
<li><code>./configure</code></li>
<li><code>make</code></li>
<li><code>make install</code></li>
</ul>
</li>
</ul>
</li>
<li>Subversion 解压：<ul>
<li>解压：<code>tar -zxvf subversion-1.8.15.tar.gz</code></li>
<li>移动到我个人习惯的安装目录下：<code>mv subversion-1.8.15/ /usr/program/</code></li>
</ul>
</li>
<li>SQLite 安装：<ul>
<li>解压：<code>unzip sqlite-amalgamation-3100200.zip</code></li>
<li>移动到 subversion 目录下：<code>mv sqlite-amalgamation-3100200/ /usr/program/subversion-1.8.15/</code></li>
</ul>
</li>
<li>Subversion 安装：<ul>
<li>标准的 GNU 源码安装方式：<ul>
<li><code>cd /usr/program/subversion-1.8.15/</code></li>
<li><code>./configure --prefix=/usr/local/subversion --with-apr=/usr/local/apr/bin/apr-1-config  --with-apr-util=/usr/local/apr/bin/apu-1-config</code></li>
<li><code>make</code></li>
<li><code>make install</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="SVN-配置"><a href="#SVN-配置" class="headerlink" title="SVN 配置"></a>SVN 配置</h2><ul>
<li>在系统上创建一个目录用来存储所有的 SVN 文件：<code>mkdir -p /opt/svn/repo/</code></li>
<li>新建一个版本仓库：<code>svnadmin create /opt/svn/repo/</code><ul>
<li>生成如下目录和文件：<ul>
<li>目录：<code>locks</code></li>
<li>目录：<code>hooks</code></li>
<li>目录：<code>db</code></li>
<li>目录：<code>conf</code></li>
<li>文件：<code>format</code></li>
<li>文件：<code>README.txt</code></li>
</ul>
</li>
<li>其中，目录 <code>conf</code> 最为重要，常用的配置文件都在里面<ul>
<li><code>svnserve.conf</code> 是 svn 服务综合配置文件</li>
<li><code>passwd</code> 是用户名和密码配置文件</li>
<li><code>authz</code> 是权限配置文件</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>设置配置文件<ul>
<li>编辑配置文件：<code>vim /opt/svn/repo/conf/svnserve.conf</code></li>
<li><img src="images/SVN-Install-And-Settings-a-1.jpg" alt="设置配置文件"></li>
<li>配置文件中下面几个参数（默认是注释的）：<ul>
<li><code>anon-access</code>： 对不在授权名单中的用户访问仓库的权限控制，有三个可选性：<code>write、read、none</code><ul>
<li><code>none</code> 表示没有任何权限</li>
<li><code>read</code> 表示只有只读权限</li>
<li><code>write</code> 表示有读写权限</li>
</ul>
</li>
<li><code>auth-access</code>：对在授权名单中的用户访问仓库的权限控制，有三个可选性：<code>write、read、none</code><ul>
<li><code>none</code> 表示没有任何权限</li>
<li><code>read</code> 表示只有只读权限</li>
<li><code>write</code> 表示有读写权限</li>
</ul>
</li>
<li><code>password-db</code>：指定用户数据配置文件</li>
<li><code>authz-db</code>：指定用户权限配置文件</li>
<li><code>realm</code>：指定版本库的认证域，即在登录时提示的认证域名称。若两个版本库的认证域相同，建议使用相同的用户名口令数据文件<ul>
<li>当前实例的配置内容：<code>realm = myrepo</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>添加用户<ul>
<li>编辑配置文件：<code>vim /opt/svn/repo/conf/passwd</code></li>
<li><img src="images/SVN-Install-And-Settings-a-2.jpg" alt="添加用户"></li>
<li>添加用户很简答，如上图所示在配置文中添加一个格式为：<code>用户名 = 密码</code>  的即可</li>
</ul>
</li>
</ul>
<ul>
<li>设置用户权限<ul>
<li>编辑配置文件：<code>vim /opt/svn/repo/conf/authz</code></li>
<li><img src="images/SVN-Install-And-Settings-a-3.jpg" alt="设置用户权限"></li>
<li>配置文件中几个参数解释：<ul>
<li><code>r</code> 表示可写</li>
<li><code>w</code> 表示可读</li>
<li><code>rw</code> 表示可读可写</li>
<li><code>* =</code> 表示除了上面设置的权限用户组以外，其他所有用户都设置空权限，空权限表示禁止访问本目录，这很重要一定要加上</li>
<li><code>[groups]</code> 表示下面创建的是用户组，实际应用中一般我们对使用者都是进行分组的，然后把权限控制在组上，这样比较方便。使用组权限方式：<code>@组名 = rw</code> </li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>启动服务</p>
<ul>
<li><code>svnserve -d -r /opt/svn/repo/ --listen-port 3690</code><ul>
<li><code>-d</code> 表示后台运行</li>
<li><code>-r /opt/svn/repo/</code> 表示指定根目录</li>
<li><code>--listen-port 3690</code> 表示指定端口，默认就是 3690，所以如果要用默认端口这个也是可以省略掉的</li>
</ul>
</li>
</ul>
</li>
<li><p>停止服务</p>
<ul>
<li><code>killall svnserve</code></li>
</ul>
</li>
</ul>
<ul>
<li>测试<ul>
<li>iptables 处理<ul>
<li>一种方式：先关闭 iptables，防止出现拦截问题而测试不了：<code>service iptables stop</code></li>
<li>一种方式：在 iptables 中添加允许规则（svn 默认端口是 3690）：<ul>
<li>添加规则：<code>sudo iptables -I INPUT -p tcp -m tcp --dport 3690 -j ACCEPT</code></li>
<li>保存规则：<code>sudo /etc/rc.d/init.d/iptables save</code></li>
<li>重启 iptables：<code>sudo service iptables restart</code></li>
</ul>
</li>
</ul>
</li>
<li>在 Windows 的 svn 客户端上访问:<code>svn://192.168.0.110</code></li>
</ul>
</li>
</ul>
<h2 id="SVN-设置提交之后可修改提交的-Message-信息"><a href="#SVN-设置提交之后可修改提交的-Message-信息" class="headerlink" title="SVN 设置提交之后可修改提交的 Message 信息"></a>SVN 设置提交之后可修改提交的 Message 信息</h2><ul>
<li>默认的 SVN 是无法修改提交后的 Message 信息的，修改会报如下错误：</li>
<li><img src="images/SVN-Install-And-Settings-a-4.jpg" alt="SVN 设置提交之后可修改提交的 Message 信息"></li>
<li>解决办法：<ul>
<li>下载我 hooks 文件：<a href="http://pan.baidu.com/s/1c1jtlmw" target="_blank" rel="external">http://pan.baidu.com/s/1c1jtlmw</a></li>
<li>把 pre-revprop-change 文件放在你的仓库下，比如我仓库地址是：<code>/opt/svn/repo/hooks</code><ul>
<li>编辑该文件：<code>vim /opt/svn/repo/hooks/pre-revprop-change</code></li>
<li>把文件尾巴的这句脚本：<code>echo &quot;$1 $2 $3 $4 $5&quot; &gt;&gt; /opt/svn/repo/logchanges.log</code>，改为：<code>echo &quot;$1 $2 $3 $4 $5&quot; &gt;&gt; /你的仓库地址/logchanges.log</code></li>
<li>你在该目录下也可以看到一个文件 <code>pre-revprop-change.tmpl</code>，这个其实就是 svn 提供给你模板，其他的那些你有兴趣也可以研究下</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://tecadmin.net/install-subversion-1-8-on-centos-rhel/" target="_blank" rel="external">http://tecadmin.net/install-subversion-1-8-on-centos-rhel/</a></li>
<li><a href="http://svn.apache.org/repos/asf/subversion/trunk/INSTALL" target="_blank" rel="external">http://svn.apache.org/repos/asf/subversion/trunk/INSTALL</a></li>
<li><a href="http://chenpipi.blog.51cto.com/8563610/1613007" target="_blank" rel="external">http://chenpipi.blog.51cto.com/8563610/1613007</a></li>
<li><a href="https://blog.linuxeye.com/348.html" target="_blank" rel="external">https://blog.linuxeye.com/348.html</a></li>
<li><a href="http://jingyan.baidu.com/article/046a7b3efb6a5df9c27fa991.html" target="_blank" rel="external">http://jingyan.baidu.com/article/046a7b3efb6a5df9c27fa991.html</a></li>
<li><a href="http://www.ha97.com/4467.html" target="_blank" rel="external">http://www.ha97.com/4467.html</a></li>
<li><a href="http://blog.feehi.com/linux/7.html" target="_blank" rel="external">http://blog.feehi.com/linux/7.html</a></li>
<li><a href="http://my.oschina.net/lionel45/blog/298305?fromerr=1NdIndN0" target="_blank" rel="external">http://my.oschina.net/lionel45/blog/298305?fromerr=1NdIndN0</a></li>
<li><a href="http://www.centoscn.com/CentosServer/ftp/2015/0622/5708.html" target="_blank" rel="external">http://www.centoscn.com/CentosServer/ftp/2015/0622/5708.html</a></li>
<li><a href="http://blog.csdn.net/tianlesoftware/article/details/6119231" target="_blank" rel="external">http://blog.csdn.net/tianlesoftware/article/details/6119231</a></li>
<li><a href="http://www.scmeye.com/thread-419-1-1.html" target="_blank" rel="external">http://www.scmeye.com/thread-419-1-1.html</a></li>
<li><a href="http://m.blog.csdn.net/article/details?id=7908907" target="_blank" rel="external">http://m.blog.csdn.net/article/details?id=7908907</a></li>
<li>设置可编辑提交信息：<a href="http://stackoverflow.com/questions/692851/can-i-go-back-and-edit-comments-on-an-svn-checkin" target="_blank" rel="external">http://stackoverflow.com/questions/692851/can-i-go-back-and-edit-comments-on-an-svn-checkin</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Subversion-1-8-安装&quot;&gt;&lt;a href=&quot;#Subversion-1-8-安装&quot; class=&quot;headerlink&quot; title=&quot;Subversion 1.8 安装&quot;&gt;&lt;/a&gt;Subversion 1.8 安装&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>FTP</title>
    <link href="//zeroto.tech/2017/11/22/FTP/"/>
    <id>//zeroto.tech/2017/11/22/FTP/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:37:03.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="FTP（File-Transfer-Protocol）介绍"><a href="#FTP（File-Transfer-Protocol）介绍" class="headerlink" title="FTP（File Transfer Protocol）介绍"></a>FTP（File Transfer Protocol）介绍</h1><a id="more"></a>
<h2 id="FTP-安装"><a href="#FTP-安装" class="headerlink" title="FTP 安装"></a>FTP 安装</h2><ul>
<li><p>查看是否已安装：</p>
<ul>
<li>CentOS：<code>rpm -qa | grep vsftpd</code></li>
<li>Ubuntu：<code>dpkg -l | grep vsftpd</code></li>
</ul>
</li>
<li><p>安装：</p>
<ul>
<li>CentOS 6：<code>sudo yum install -y vsftpd</code></li>
<li>Ubuntu：<code>sudo apt-get install -y vsftpd</code></li>
</ul>
</li>
</ul>
<h2 id="FTP-使用之前要点"><a href="#FTP-使用之前要点" class="headerlink" title="FTP 使用之前要点"></a>FTP 使用之前要点</h2><ul>
<li>关闭 CentOS 上的 SELinux 组件（Ubuntu 体系是没有这东西的）。<ul>
<li>查看 SELinux 开启状态：<code>sudo getenforce</code><ul>
<li>有如下三种状态，默认是 Enforcing<ul>
<li>Enforcing（开启）</li>
<li>Permissive（开启，但是只起到警告作用，属于比较轻的开启）</li>
<li>Disabled（关闭）</li>
</ul>
</li>
<li>临时关闭：<ul>
<li>命令：<code>sudo setenforce 0</code></li>
</ul>
</li>
<li>临时开启：<ul>
<li>命令：<code>sudo setenforce 1</code></li>
</ul>
</li>
<li>永久关闭：<ul>
<li>命令：<code>sudo vim /etc/selinux/config</code></li>
<li>将：<code>SELINUX=enforcing</code> 改为 <code>SELINUX=disbaled</code>，配置好之后需要重启系统。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="FTP-服务器配置文件常用参数"><a href="#FTP-服务器配置文件常用参数" class="headerlink" title="FTP 服务器配置文件常用参数"></a>FTP 服务器配置文件常用参数</h2><ul>
<li>vsftpd 默认是支持使用 Linux 系统里的账号进行登录的（登录上去可以看到自己的 home 目录内容），权限跟 Linux 的账号权限一样。但是建议使用软件提供的虚拟账号管理体系功能，用虚拟账号登录。</li>
<li>配置文件介绍（记得先备份）：<code>sudo vim /etc/vsftpd/vsftpd.conf</code>，比较旧的系统版本是：<code>vim /etc/vsftpd.conf</code><ul>
<li>该配置主要参数解释：<ul>
<li>anonymous_enable=NO           #不允许匿名访问，改为YES即表示可以匿名登录</li>
<li>anon_upload_enable=YES        #是否允许匿名用户上传</li>
<li>anon_mkdir_write_enable=YES   #是否允许匿名用户创建目录</li>
<li>local_enable=YES              #是否允许本地用户，也就是linux系统的已有账号，如果你要FTP的虚拟账号，那可以改为NO</li>
<li>write_enable=YES              #是否允许本地用户具有写权限</li>
<li>local_umask=022               #本地用户掩码</li>
<li>chroot_list_enable=YES        #不锁定用户在自己的家目录，默认是注释，建议这个一定要开，比如本地用户judasn，我们只能看到/home/judasn，没办法看到/home目录</li>
<li>chroot_list_file=/etc/vsftpd/chroot_list   #该选项是配合上面选项使用的。此文件中的用户将启用 chroot，如果上面的功能开启是不够的还要把用户名加到这个文件里面。配置好后，登录的用户，默认登录上去看到的根目录就是自己的home目录。</li>
<li>listen=YES                    #独立模式</li>
<li>userlist_enable=YES           #用户访问控制，如果是YES，则表示启用vsftp的虚拟账号功能，虚拟账号配置文件是/etc/vsftpd/user_list</li>
<li>userlist_deny=NO              #这个属性在配置文件是没有的，当userlist_enable=YES，这个值也为YES，则user_list文件中的用户不能登录FTP，列表外的用户可以登录，也可以起到一个黑名单的作用。当userlist_enable=YES，这个值为NO，则user_list文件中的用户能登录FTP，列表外的用户不可以登录，也可以起到一个白名单的作用。如果同一个用户即在白名单中又在ftpusers黑名单文件中，那还是会以黑名单为前提，对应账号没法登录。</li>
<li>tcp_wrappers=YES              #是否启用TCPWrappers管理服务</li>
</ul>
</li>
<li>FTP用户黑名单配置文件：<code>sudo vim /etc/vsftpd/ftpusers</code>，默认root用户也在黑名单中</li>
<li>控制FTP用户登录配置文件：<code>sudo vim /etc/vsftpd/user_list</code></li>
</ul>
</li>
<li>启动服务：<ul>
<li><code>service vsftpd restart</code></li>
</ul>
</li>
</ul>
<h2 id="vsftpd-的两种传输模式"><a href="#vsftpd-的两种传输模式" class="headerlink" title="vsftpd 的两种传输模式"></a>vsftpd 的两种传输模式</h2><ul>
<li>分为：主动模式（PORT）和被动模式（PASV）。这两个模式会涉及到一些端口问题，也就涉及到防火墙问题，所以要特别注意。主动模式比较简单，只要在防火墙上放开放开 21 和 20 端口即可。被动模式则要根据情况放开一个端口段。<ul>
<li><img src="images/FTP-a-1.jpg" alt="vsftpd 的两种传输模式"></li>
<li>上图箭头：xftp 新建连接默认都是勾选被动模式的，所以如果要使用主动模式，在该连接的属性中是要去掉勾选。</li>
</ul>
</li>
</ul>
<h2 id="vsftpd-的两种运行模式"><a href="#vsftpd-的两种运行模式" class="headerlink" title="vsftpd 的两种运行模式"></a>vsftpd 的两种运行模式</h2><ul>
<li>分为：xinetd 模式和 standalone 模式<ul>
<li>xinetd 模式：由 xinetd 作为 FTP 的守护进程，负责 21 端口的监听，一旦外部发起对 21 端口的连接，则调用 FTP 的主程序处理，连接完成后，则关闭 FTP 主程序，释放内存资源。好处是资源占用少，适合 FTP 连接数较少的场合。</li>
<li>standalone 模式：直接使用 FTP 主程序作为 FTP 的守护进程，负责 21 端口的监听，由于无需经过 xinetd 的前端代理，响应速度快，适合连接数 较大的情况，但由于 FTP 主程序长期驻留内存，故较耗资源。</li>
<li>standalone 一次性启动，运行期间一直驻留在内存中，优点是对接入信号反应快，缺点是损耗了一定的系统资源，因此经常应用于对实时反应要求较高的 专业 FTP 服务器。</li>
<li>xinetd 恰恰相反，由于只在外部连接发送请求时才调用 FTP 进程，因此不适合应用在同时连接数量较多的系统。此外，xinetd 模式不占用系统资源。除了反应速度和占用资源两方面的影响外，vsftpd 还提供了一些额外的高级功能，如 xinetd 模式支持 per_IP (单一 IP)限制，而 standalone 模式则更有利于 PAM 验证功能的应用。<ul>
<li>配置 xinetd 模式：  <ul>
<li>编辑配置文件：<code>sudo vim /etc/xinetd.d/vsftpd</code></li>
<li>属性信息改为如下信息：<ul>
<li>disable = no</li>
<li>socket_type = stream</li>
<li>wait = no     #这表示设备是激活的，它正在使用标准的TCP Sockets </li>
</ul>
</li>
<li>编辑配置文件：<code>sudo vim /etc/vsftpd/vsftpd.conf</code></li>
<li>如果该配置选项中的有 <code>listen=YES</code>，则要注释掉</li>
</ul>
</li>
<li>重启 xinetd 服务，命令：<code>sudo /etc/rc.d/init.d/xinetd restart</code></li>
<li>配置 standalone 模式：<ul>
<li>编辑配置文件：<code>sudo vim /etc/xinetd.d/vsftpd</code></li>
<li>属性信息改为如下信息：<ul>
<li>disable = yes</li>
</ul>
</li>
<li>编辑配置文件：<code>sudo vim /etc/vsftpd/vsftpd.conf</code></li>
<li>属性信息改为如下信息：<ul>
<li>Listen=YES（如果是注释掉则要打开注释）</li>
</ul>
</li>
</ul>
</li>
<li>重启服务：<code>sudo service vsftpd restart</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="FTP-资料"><a href="#FTP-资料" class="headerlink" title="FTP 资料"></a>FTP 资料</h2><ul>
<li><a href="http://www.jikexueyuan.com/course/994.html" target="_blank" rel="external">http://www.jikexueyuan.com/course/994.html</a></li>
<li><a href="http://www.while0.com/36.html" target="_blank" rel="external">http://www.while0.com/36.html</a></li>
<li><a href="http://www.cnblogs.com/CSGrandeur/p/3754126.html" target="_blank" rel="external">http://www.cnblogs.com/CSGrandeur/p/3754126.html</a></li>
<li><a href="http://www.centoscn.com/image-text/config/2015/0613/5651.html" target="_blank" rel="external">http://www.centoscn.com/image-text/config/2015/0613/5651.html</a></li>
<li><a href="http://wiki.ubuntu.org.cn/Vsftpd" target="_blank" rel="external">http://wiki.ubuntu.org.cn/Vsftpd</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;FTP（File-Transfer-Protocol）介绍&quot;&gt;&lt;a href=&quot;#FTP（File-Transfer-Protocol）介绍&quot; class=&quot;headerlink&quot; title=&quot;FTP（File Transfer Protocol）介绍&quot;&gt;&lt;/a&gt;FTP（File Transfer Protocol）介绍&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>VPN</title>
    <link href="//zeroto.tech/2017/11/22/VPN/"/>
    <id>//zeroto.tech/2017/11/22/VPN/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T07:10:24.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="VPN（Virtual-Private-Network）介绍"><a href="#VPN（Virtual-Private-Network）介绍" class="headerlink" title="VPN（Virtual Private Network）介绍"></a>VPN（Virtual Private Network）介绍</h1><h2 id="VPN-介绍"><a href="#VPN-介绍" class="headerlink" title="VPN 介绍"></a>VPN 介绍</h2><p>VPN 分类有很多，这里主要讲 PPTPD 和 L2TPD、OpenVPN</p>
<h2 id="PPTPD-安装"><a href="#PPTPD-安装" class="headerlink" title="PPTPD 安装"></a>PPTPD 安装</h2><ul>
<li><p>查看是否已安装：</p>
<ul>
<li>CentOS：<code>rpm -qa | grep pptpd</code></li>
<li>Ubuntu：<code>dpkg -l | grep pptpd</code></li>
</ul>
</li>
<li><p>先安装依赖包：</p>
<ul>
<li>CentOS 6：<code>sudo yum -y install ppp</code></li>
<li>Ubuntu：<code>sudo apt-get install -y ppp</code></li>
</ul>
</li>
<li><p>安装：</p>
<ul>
<li>CentOS 6：<code>sudo yum -y install pptpd</code></li>
<li>Ubuntu：<code>sudo apt-get install -y pptpd</code></li>
</ul>
</li>
</ul>
<h2 id="PPTPD-服务配置"><a href="#PPTPD-服务配置" class="headerlink" title="PPTPD 服务配置"></a>PPTPD 服务配置</h2><ul>
<li>注意：PPTPD 默认端口是 1723，所以防火墙要取消对其限制，查看 1723 端口是否开启：<code>sudo netstat -apnl | grep 1723</code></li>
<li>编辑 PPTPD 配置文件介绍（记得先备份）：<code>sudo vim /etc/pptpd.conf</code><ul>
<li>修改配置信息：<ul>
<li><code>option /etc/ppp/options.pptpd</code>  #配置文件中有一行这样的参数，如果没有自己添加上去，正常默认是有的。同时也有可能是这样的一句话：<code>option /etc/ppp/pptpd-options</code>，具体你自己看下你的配置文件里面是什么内容。</li>
<li><code>logwtmp</code>  #默认这个是没有被注释的，这里要进行注释</li>
<li><code>localip 172.31.0.1</code>  #本机服务器的内网IP地址，建议你的内网IP一般不要用常见网段，默认这个被注释，取消注释</li>
<li><code>remoteip 192.168.0.10-200</code>   #客户端的IP地址范围，默认这个被注释，取消注释</li>
</ul>
</li>
</ul>
</li>
<li>编辑 PPP 配置文件介绍（记得先备份）：<code>sudo vim /etc/ppp/options.pptpd</code> 或是 <code>sudo vim /etc/ppp/pptpd-options</code><ul>
<li>在文件尾巴添加如下配置信息（默认配置文件应该有，只是被注释了）：<ul>
<li><code>ms-dns 8.8.8.8</code>           #配置DNS，如果是境外服务器最好改为google的，国内的看情况</li>
<li><code>ms-dns 8.8.4.4</code>           #配置DNS，如果是境外服务器最好改为google的，国内的看情况</li>
</ul>
</li>
</ul>
</li>
<li>开启系统转发（记得先备份）：<code>sudo vim /etc/sysctl.conf</code><ul>
<li>修改配置信息该值改为 1：<ul>
<li><code>net.ipv4.ip_forward=1</code> # 默认是注释掉的，要取消注释，也有出现是没有注释，但是默认是0：<code>net.ipv4.ip_forward=0</code></li>
</ul>
</li>
<li>刷新配置：<code>sudo sysctl -p</code></li>
</ul>
</li>
<li>设置 iptables 转发：<ul>
<li>追加 iptables 规则：<code>sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</code></li>
<li>设置默认启动使用该规则：<code>sudo vim /etc/rc.local</code><ul>
<li>在配置文件中添加：<code>iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</code></li>
</ul>
</li>
</ul>
</li>
<li>添加登录账号（记得先备份）：<code>sudo vim /etc/ppp/chap-secrets</code><ul>
<li>在文件尾巴添加如下配置信息：<ul>
<li><code>mytest1 pptpd 123456 *</code> #该格式分别表示：登录名、登录协议、密码、该连接上的客户端用什么 IP（* 表示随机一个 IP）</li>
</ul>
</li>
</ul>
</li>
<li>重启服务：<code>sudo service pptpd restart</code></li>
<li>Windows 连接 VPN 方法：<a href="http://www.cnblogs.com/yuzeren48/p/4123879.html" target="_blank" rel="external">http://www.cnblogs.com/yuzeren48/p/4123879.html</a></li>
</ul>
<h2 id="L2TPD-安装"><a href="#L2TPD-安装" class="headerlink" title="L2TPD 安装"></a>L2TPD 安装</h2><ul>
<li><p>查看是否已安装：</p>
<ul>
<li>CentOS：<code>rpm -qa | grep xl2tpd</code></li>
<li>Ubuntu：<code>dpkg -l | grep xl2tpd</code></li>
</ul>
</li>
<li><p>安装：</p>
<ul>
<li>CentOS 6：<code>XXXXXXXXXXXXXXXXXXXXXXXX</code></li>
<li>Ubuntu：<code>sudo apt-get install -y xl2tpd ppp openswan</code></li>
</ul>
</li>
</ul>
<h2 id="L2TPD-服务配置"><a href="#L2TPD-服务配置" class="headerlink" title="L2TPD 服务配置"></a>L2TPD 服务配置</h2><ul>
<li>注意：L2TPD 默认端口是 1701，所以防火墙要取消对其限制，查看 1701 端口是否开启：<code>sudo netstat -apnl | grep 1701</code></li>
<li>编辑 Openswan 配置文件介绍（记得先备份）：<code>sudo vim /etc/ipsec.conf</code><ul>
<li>left=172.31.201.255  #其中这里的IP地址改为本机的内网IP，文件中有两处，都进行修改</li>
</ul>
</li>
<li>编辑 IPsec-based 配置文件介绍（记得先备份）：<code>sudo vim /etc/ipsec.secrets</code><ul>
<li>172.31.201.255 %any:    PSK”adc123456”  #在文件最后一行补充：（格式是：本机内网IP，后面是配置密钥。密钥不配置也可以但是建议配上去）</li>
</ul>
</li>
<li>编辑 L2TPD 配置文件介绍（记得先备份）：<code>sudo vim /etc/xl2tpd/xl2tpd.conf</code><ul>
<li>修改配置信息：</li>
</ul>
</li>
</ul>
<pre><code class="bash">ipsec saref = yes           
require chap = yes   
refuse pap = yes   
require authentication = yes  
ppp debug = yes  
length bit = yes
ip range = 192.168.1.10-192.168.1.200              #这是客户端连接本机的IP端限制
local ip = 172.31.201.255        #这是本机服务器端的内网 IP
pppoptfile = /etc/ppp/options.xl2tpd        #指定本机的 PPP 配置文件地址，如果你的 PPP 配置文件地址不是这里那就改下
</code></pre>
<ul>
<li>编辑 PPP 配置文件介绍（记得先备份）：<code>sudo vim /etc/ppp/options.xl2tpd</code> (如果没有这个文件自己创建)<ul>
<li>在文件尾巴添加如下配置信息：</li>
</ul>
</li>
</ul>
<pre><code class="bash">refuse-mschap-v2           
refuse-mschap           
ms-dns 8.8.8.8           #配置DNS，如果是境外服务器最好改为google的，国内的看情况
ms-dns 8.8.4.4           #配置DNS，如果是境外服务器最好改为google的，国内的看情况
asyncmap 0           
auth           
lock           
hide-password           
local           
name l2tpd           
proxyarp           
lcp-echo-interval 30           
lcp-echo-failure 4           
refuse           
refuse           
refuse
</code></pre>
<ul>
<li>在终端输入命令：sudo sh -c ‘for each in /proc/sys/net/ipv4/conf/* do echo 0 &gt; $each/accept_redirects echo 0 &gt; $each/send_redirects done’</li>
<li>开启系统转发（记得先备份）：<code>sudo vim /etc/sysctl.conf</code><ul>
<li>修改配置信息：<ul>
<li>net.ipv4.ip_forward=1 #默认是注释掉的，要取消注释</li>
</ul>
</li>
<li>刷新配置：<code>sudo sysctl -p</code></li>
</ul>
</li>
<li>设置 iptables 转发：<ul>
<li>追加 iptables 规则：<code>sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</code></li>
<li>设置默认启动使用该规则：<code>sudo vim /etc/rc.local</code><ul>
<li>在配置文件中添加：iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</li>
</ul>
</li>
</ul>
</li>
<li>添加登录账号（记得先备份）：<code>sudo vim /etc/ppp/chap-secrets</code><ul>
<li>在文件尾巴添加如下配置信息：<ul>
<li>mytest1 l2tpd 123456 <em> #该格式分别表示：登录名、登录协议、密码、该连接上的客户端用什么 IP（</em> 表示随机一个 IP）</li>
</ul>
</li>
</ul>
</li>
<li>重启服务：<code>sudo service l2tpd restart</code></li>
<li>Windows 连接 VPN 方法：<a href="http://www.cnblogs.com/yuzeren48/p/4123879.html" target="_blank" rel="external">http://www.cnblogs.com/yuzeren48/p/4123879.html</a></li>
</ul>
<h2 id="OpenVPN-安装"><a href="#OpenVPN-安装" class="headerlink" title="OpenVPN 安装"></a>OpenVPN 安装</h2><ul>
<li>主要软件版本信息：<ul>
<li>OpenVPN：2.3.11-1.el6</li>
<li>EasyRsa：2.2.2-1.el6</li>
</ul>
</li>
<li>检查系统环境是否支持：<code>cat /dev/net/tun</code>，如果出现：<code>cat: /dev/net/tun: File descriptor in bad state</code>，则表示支持。如果现实的是：<code>cat: /dev/net/tun: No such device</code>，则不支持</li>
<li>需要先安装 EPEL 源，具体可以看这篇文章：<a href="https://github.com/judasn/Linux-Tutorial/blob/master/centos-settings/CentOS-Extra-Packages.md" target="_blank" rel="external">CentOS 源设置</a></li>
<li>安装：<ul>
<li>安装依赖包：<ul>
<li><code>yum install -y gcc make rpm-build autoconf.noarch openssl openssl-devel lzo lzo-devel pam pam-devel automake pkgconfig</code></li>
</ul>
</li>
<li>安装 OpenVPN：<ul>
<li><code>yum install -y openvpn easy-rsa</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="OpenVPN-服务配置"><a href="#OpenVPN-服务配置" class="headerlink" title="OpenVPN 服务配置"></a>OpenVPN 服务配置</h2><h3 id="禁用-selinux"><a href="#禁用-selinux" class="headerlink" title="禁用 selinux"></a>禁用 selinux</h3><ul>
<li>编辑配置文件：<code>vim /etc/selinux/config</code></li>
<li>把 <code>SELINUX=enforcing</code> 改为 <code>SELINUX=disabled</code></li>
</ul>
<h3 id="生成OpenVPN需要的服务器、客户端证书"><a href="#生成OpenVPN需要的服务器、客户端证书" class="headerlink" title="生成OpenVPN需要的服务器、客户端证书"></a>生成OpenVPN需要的服务器、客户端证书</h3><ul>
<li><p>使用 easy-rsa 的脚本产生证书</p>
</li>
<li><p>修改vars文件</p>
<ul>
<li><code>cd /usr/share/easy-rsa/2.0</code>，后面关于证书的操作都是在这个目录下</li>
<li><code>vim vars</code><ul>
<li>需要修改的内容主要有下面这些信息（在文件 64 行）：注册信息，比如公司地址、公司名称、部门名称等。<ul>
<li><code>export KEY_COUNTRY=&quot;CN&quot;</code></li>
<li><code>export KEY_PROVINCE=&quot;GuangDong&quot;</code></li>
<li><code>export KEY_CITY=&quot;GuangZhou&quot;</code></li>
<li><code>export KEY_ORG=&quot;YouMeekOrganization&quot;</code></li>
<li><code>export KEY_EMAIL=&quot;admin@youmeek.com&quot;</code></li>
<li><code>export KEY_OU=&quot;YouMeekOrganizationalUnit&quot;</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>初始化环境变量</p>
<ul>
<li><code>source vars</code></li>
</ul>
</li>
<li><p>清除keys目录下所有与证书相关的文件，下面步骤生成的证书和密钥都在 /usr/share/easy-rsa/2.0/keys 目录里</p>
<ul>
<li><code>./clean-all</code></li>
</ul>
</li>
<li><p>生成根证书 ca.crt 和根密钥 ca.key（会有好几个提示，你都不需要输入什么内容，一路按回车即可，除非你懂原理）</p>
<ul>
<li><code>./build-ca</code></li>
</ul>
</li>
<li><p>为服务端生成证书和密钥（也会有好几个提示，你都不需要输入什么内容，一路按回车即可，直到提示需要输入y/n时，输入y再按回车继续走）</p>
<ul>
<li>其中：server，这个名字别改，照着来，等下那些就可以直接使用。</li>
<li><code>./build-key-server server</code></li>
</ul>
</li>
<li><p>每一个登陆的VPN客户端需要有一个证书，每个证书在同一时刻只能供一个客户端连接，下面语句是建立2份demo，你可以只输入第一个即可。</p>
</li>
<li><p>为客户端生成证书和密钥（一路按回车，直到提示需要输入y/n时，输入y再按回车，一共两次）</p>
<ul>
<li>其中：client1，这个名字别改，照着来，等下那些就可以直接使用，除非你会。</li>
<li><code>./build-key client1</code></li>
<li><code>./build-key client2</code></li>
</ul>
</li>
<li><p>创建迪菲·赫尔曼密钥，会在 keys 目录里面生成dh2048.pem文件（生成过程比较慢，在此期间不要去中断它，我这边花的时间是：2分钟）</p>
<ul>
<li><code>./build-dh</code></li>
</ul>
</li>
</ul>
<h3 id="设置OpenVPN服务端配置文件"><a href="#设置OpenVPN服务端配置文件" class="headerlink" title="设置OpenVPN服务端配置文件"></a>设置OpenVPN服务端配置文件</h3><ul>
<li>复制一份服务器端配置文件模板server.conf到/etc/openvpn/</li>
<li><p>其中，我这边现在的版本是：2.3.11，所以我这边是填这个，你的不一定就跟我一样，所以你先到 doc 目录下，看下你具体是哪个版本，改下下面这句命令即可。</p>
<ul>
<li><code>cp /usr/share/doc/openvpn-2.3.11/sample/sample-config-files/server.conf /etc/openvpn/</code></li>
</ul>
</li>
<li><p>编辑 server.conf，把下面的内容替换到已有的文件中，记得去掉后面的注释，我这样写只是为了方便解释对应的内容含义：</p>
<ul>
<li><code>vim /etc/openvpn/server.conf</code></li>
</ul>
</li>
</ul>
<pre><code class="bash">port 1194 # 端口一般我们不改
proto udp # 默认使用udp，如果使用HTTP Proxy，改成tcp，必须使用tcp协议，还需要注意的是：需要与客户端配置保持一致，等下客户端配置会说道
dev tun
ca /usr/share/easy-rsa/2.0/keys/ca.crt # 这一行默认值为：ca ca.crt
cert /usr/share/easy-rsa/2.0/keys/server.crt # 这一行默认值为：cert server.crt
key /usr/share/easy-rsa/2.0/keys/server.key  # 这一行默认值为：key server.key
dh /usr/share/easy-rsa/2.0/keys/dh2048.pem  # 这一行默认值为：dh dh2048.pem
server 10.192.170.0 255.255.255.0  # 给客户的分配的局域网IP段，默认虚拟局域网网段，不要和实际的局域网冲突即可，这个10.192.170.0跟下面还有一个地方配置也有关联，需要注意
ifconfig-pool-persist ipp.txt # 启用了ipp.txt作为客户端和virtual IP的对应表，以方便客户端重新连接可以获得同样的IP；
keepalive 10 120
comp-lzo
persist-key
persist-tun
status openvpn-status.log  # OpenVPN的状态日志，默认为/etc/openvpn/openvpn-status.log
log openvpn.log # OpenVPN的运行日志，默认为/etc/openvpn/openvpn.log 
log-append openvpn.log
verb 3

push &quot;redirect-gateway def1 bypass-dhcp&quot;
push &quot;dhcp-option DNS 8.8.8.8&quot;
push &quot;dhcp-option DOMAIN-SEARCH ap-northeast-1.compute.internal&quot;
push &quot;dhcp-option DOMAIN-SEARCH ec2.drawbrid.ge&quot;
</code></pre>
<h3 id="配置内核和防火墙，开启nat功能，启动服务"><a href="#配置内核和防火墙，开启nat功能，启动服务" class="headerlink" title="配置内核和防火墙，开启nat功能，启动服务"></a>配置内核和防火墙，开启nat功能，启动服务</h3><ul>
<li>开启路由转发功能<ul>
<li><code>sed -i &#39;/net.ipv4.ip_forward/s/0/1/&#39; /etc/sysctl.conf</code></li>
<li>刷新配置：<code>sudo sysctl -p</code></li>
</ul>
</li>
</ul>
<p>辨别你的 VPS 是属于那种虚拟方式，主流有：Xen KVM OpenVZ，方法：</p>
<ul>
<li><p><code>sudo yum install -y virt-what</code>，virt-what是一个判断当前环境所使用的虚拟技术的脚本，常见的虚拟技术基本上都能正常识别出来</p>
<ul>
<li><code>sudo virt-what</code>，我这边 Vultr 输出的结果是：KVM</li>
</ul>
</li>
<li><p>配置防火墙</p>
<ul>
<li><code>iptables -A INPUT -p udp --dport 1194 -j ACCEPT</code></li>
<li><code>iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</code></li>
</ul>
</li>
<li><p>设置IP转发，若你的 VPS 虚拟方案是：Xen 或 KVM的请输入：（eth0要根据具体的网卡标示来，可以通过ifconfig查看），其中：10.192.170.0/16 表示客户端连接上去后从这个区间中分配给客户端的IP地址</p>
<ul>
<li><code>iptables -t nat -A POSTROUTING -s 10.192.170.0/16 -o eth0 -j MASQUERADE</code></li>
</ul>
</li>
<li><p>若你的 VPS 虚拟方案是：OpenVZ 的请输入：（45.32.90.22是你VPS的IP）</p>
<ul>
<li><code>iptables -t nat -A POSTROUTING -s 10.192.170.0/16 -j SNAT --to-source 45.32.90.22</code></li>
</ul>
</li>
<li>保存防火墙配置<ul>
<li><code>service iptables save</code></li>
<li><code>service iptables restart</code></li>
</ul>
</li>
</ul>
<h3 id="启动openvpn并设置为开机启动"><a href="#启动openvpn并设置为开机启动" class="headerlink" title="启动openvpn并设置为开机启动"></a>启动openvpn并设置为开机启动</h3><ul>
<li><code>service openvpn start</code></li>
<li><code>chkconfig openvpn on</code></li>
</ul>
<h3 id="OpenVPN客户端配置"><a href="#OpenVPN客户端配置" class="headerlink" title="OpenVPN客户端配置"></a>OpenVPN客户端配置</h3><p>下载 Windows 客户端：<br><a href="https://openvpn.net/index.php/download/community-downloads.html" target="_blank" rel="external">https://openvpn.net/index.php/download/community-downloads.html</a></p>
<p>Mac 用户下载这个 tunnelblick（该地址需要开穿越）：<br><a href="http://code.google.com/p/tunnelblick/" target="_blank" rel="external">http://code.google.com/p/tunnelblick/</a></p>
<ul>
<li>从服务器上下载证书文件到本地：<ul>
<li><code>/usr/share/easy-rsa/2.0/keys/ca.crt</code></li>
<li><code>/usr/share/easy-rsa/2.0/keys/client1.crt</code></li>
<li><code>/usr/share/easy-rsa/2.0/keys/client1.key</code></li>
</ul>
</li>
</ul>
<p>到你本地的电脑上（window电脑在安装好OpenVPN软件后可以把如上证书拷贝到如下文件夹里：C:\Program Files\OpenVPN\config ）</p>
<p>从服务器找到这个文件：/usr/share/doc/openvpn-2.3.11/sample/sample-windows/sample.ovpn，下载到本地电脑这个目录下：C:\Program Files\OpenVPN\config<br>然后把这个文件改名字为：client1.ovpn 文件内如如下, 其他不用改只要把SERVER-IP 改成你服务器的 IP  </p>
<pre><code class="bash">client        #这个client不是自定义名称 不能更改
dev tun       #要与前面server.conf中的配置一致。
proto udp              #要与前面server.conf中的配置一致。
remote 45.32.90.22 1194    #将45.32.90.22替换为你VPS的IP，端口也与前面的server.conf中配置一致。
resolv-retry infinite
nobind
persist-key
persist-tun
ca ca.crt              #具体名称以刚下载的为准
cert client1.crt              #具体名称以刚下载的为准
key client1.key              #具体名称以刚下载的为准
comp-lzo
verb 3
</code></pre>
<ul>
<li>打开 OpenVPN 客户端，连接试试看。</li>
</ul>
<h2 id="VPN-资料"><a href="#VPN-资料" class="headerlink" title="VPN 资料"></a>VPN 资料</h2><ul>
<li><a href="http://www.jikexueyuan.com/course/1692_2.html?ss=1" target="_blank" rel="external">http://www.jikexueyuan.com/course/1692_2.html?ss=1</a></li>
<li><a href="http://gnailuy.com/linux/2011/07/04/pptp-vpn/" target="_blank" rel="external">http://gnailuy.com/linux/2011/07/04/pptp-vpn/</a></li>
<li><a href="http://www.centoscn.com/CentosServer/test/2014/1120/4153.html" target="_blank" rel="external">http://www.centoscn.com/CentosServer/test/2014/1120/4153.html</a></li>
<li><a href="https://linux.cn/article-3706-1.html" target="_blank" rel="external">https://linux.cn/article-3706-1.html</a></li>
<li><a href="http://www.bkjia.com/yjs/1041400.html" target="_blank" rel="external">http://www.bkjia.com/yjs/1041400.html</a></li>
<li><a href="http://blog.liujason.com/1663.html" target="_blank" rel="external">http://blog.liujason.com/1663.html</a></li>
<li><a href="http://shit.name/openvpn-on-centos/" target="_blank" rel="external">http://shit.name/openvpn-on-centos/</a></li>
<li><a href="http://kunsland.github.io/blogs/2015/03/22/vps-openvpn/" target="_blank" rel="external">http://kunsland.github.io/blogs/2015/03/22/vps-openvpn/</a></li>
<li><a href="http://neolee.com/web/centos-openvz-vps-configuration-openvpn/" target="_blank" rel="external">http://neolee.com/web/centos-openvz-vps-configuration-openvpn/</a></li>
<li><a href="http://www.jikexueyuan.com/course/1692_4.html?ss=2" target="_blank" rel="external">Freeradius 服务（用于账号认证管理的工具，可以扩展到VPN的账号管理）</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;VPN（Virtual-Private-Network）介绍&quot;&gt;&lt;a href=&quot;#VPN（Virtual-Private-Network）介绍&quot; class=&quot;headerlink&quot; title=&quot;VPN（Virtual Private Network）介绍&quot;&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>Vim 安装和配置、优化</title>
    <link href="//zeroto.tech/2017/11/22/Vim-Install-And-Settings/"/>
    <id>//zeroto.tech/2017/11/22/Vim-Install-And-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T07:09:47.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Vim-安装和配置、优化"><a href="#Vim-安装和配置、优化" class="headerlink" title="Vim 安装和配置、优化"></a>Vim 安装和配置、优化</h1><h2 id="Vim-介绍"><a href="#Vim-介绍" class="headerlink" title="Vim 介绍"></a>Vim 介绍</h2><a id="more"></a>
<ul>
<li>Vim 官网：<a href="http://www.vim.org/" target="_blank" rel="external">http://www.vim.org/</a></li>
</ul>
<h2 id="Vim-安装"><a href="#Vim-安装" class="headerlink" title="Vim 安装"></a>Vim 安装</h2><ul>
<li>CentOS：<code>sudo yum install -y vim</code></li>
<li>Ubuntu：<code>sudo apt-get install -y vim</code></li>
<li>Windows GVim 下载：<a href="http://www.xiazaiba.com/html/3347.html" target="_blank" rel="external">http://www.xiazaiba.com/html/3347.html</a></li>
</ul>
<h2 id="Vim-配置（CentOS-环境）"><a href="#Vim-配置（CentOS-环境）" class="headerlink" title="Vim 配置（CentOS 环境）"></a>Vim 配置（CentOS 环境）</h2><ul>
<li>编辑配置文件是：<code>sudo vim /etc/vimrc</code></li>
</ul>
<h2 id="Vim-基础快捷键"><a href="#Vim-基础快捷键" class="headerlink" title="Vim 基础快捷键"></a>Vim 基础快捷键</h2><ul>
<li>注意<ul>
<li>严格区分字母大小写</li>
<li>含有 <code>Ctrl</code> 字眼都表示 Ctrl 键盘按钮</li>
<li>特定符号需要配合 Shift 键，比如字母键盘区上面的数字区：!@#%%^&amp;*()</li>
<li>要按出冒号键 <code>:</code> 也是需要 Shift 的</li>
</ul>
</li>
<li>移动<ul>
<li><code>j</code>，下</li>
<li><code>k</code>，上</li>
<li><code>h</code>，左</li>
<li><code>l</code>，右</li>
<li><code>v</code>，按 v 之后按方向键可以选中你要选中的文字</li>
<li><code>gg</code>，跳到第 1 行</li>
<li><code>G</code>，跳到第最后行</li>
<li><code>16G</code> 或 <code>:16</code>，跳到第 16 行</li>
<li><code>$</code>，到本行 <strong>行尾</strong></li>
<li><code>0</code>，到本行 <strong>行头</strong></li>
<li><code>w</code>，到下一个单词的 <strong>开头</strong></li>
<li><code>e</code>，到下一个单词的 <strong>结尾</strong></li>
<li><code>Ctrl + u</code>，向文件 <strong>首翻</strong> 半屏</li>
<li><code>Ctrl + d</code>，向文件 <strong>尾翻</strong> 半屏</li>
<li><code>Ctrl + f</code>，向文件 <strong>尾翻</strong> 一屏</li>
<li><code>Ctrl + b</code>，向文件 <strong>首翻</strong> 一屏 </li>
<li><code>*</code>，匹配光标当前所在的单词，移动光标到 <strong>下一个</strong> 匹配单词</li>
<li><code>#</code>，匹配光标当前所在的单词，移动光标到 <strong>上一个</strong> 匹配单词</li>
<li><code>^</code>，到本行第一个单词头</li>
<li><code>g_</code>，到本行最后一个单词尾巴</li>
<li><code>%</code>，匹配括号移动，包括 <strong>(、{、[</strong></li>
</ul>
</li>
<li>插入<ul>
<li><code>I</code>，在当前 <strong>行首</strong> 插入</li>
<li><code>A</code>，在当前 <strong>行尾</strong> 插入</li>
<li><code>i</code>，在当前字符的 <strong>左边</strong> 插入</li>
<li><code>a</code>，在当前字符的 <strong>右边</strong> 插入</li>
<li><code>o</code>，在当前行 <strong>下面</strong> 插入一个新行</li>
<li><code>O</code>，在当前行 <strong>上面</strong> 插入一个新行</li>
</ul>
</li>
<li>编辑<ul>
<li>删除<ul>
<li><code>x</code>，删除 <strong>光标后</strong> 的 1 个字符</li>
<li><code>2x</code>，删除 <strong>光标后</strong> 的 2 个字符</li>
<li><code>X</code>，删除 <strong>光标前</strong> 的 1 个字符</li>
<li><code>2X</code>，删除 <strong>光标前</strong> 的 2 个字符</li>
<li><code>dd</code>，删除当前行</li>
<li><code>cc</code>，删除当前行后进入 insert 模式</li>
<li><code>dw</code>，删除当前光标下的单词/空格</li>
<li><code>d$</code>，删除光标至 <strong>行尾</strong> 所有字符</li>
<li><code>dG</code>，删除光标至 <strong>文件尾</strong> 所有字符</li>
<li><code>3dd</code>，从当前光标开始，删掉 3 行</li>
</ul>
</li>
<li>复制<ul>
<li><code>y</code>，复制光标所选字符</li>
<li><code>yw</code>，复制光标后单词</li>
<li><code>yy</code>，复制当前行</li>
<li><code>4yy</code>，复制当前行及下面 4 行</li>
<li><code>y$</code>，复制光标位置至 <strong>行尾</strong> 的内容</li>
<li><code>y^</code>，复制光标位置至 <strong>行首</strong> 的内容</li>
</ul>
</li>
<li>粘贴<ul>
<li><code>p</code>，将粘贴板中内容复制到 <strong>光标之后</strong></li>
<li><code>P</code>，将粘贴板中内容复制到 <strong>光标之前</strong></li>
</ul>
</li>
<li>其他<ul>
<li><code>ddp</code>，交换当前光标所在行和下一行的位置</li>
<li><code>u</code>，撤销</li>
<li><code>:wq</code>，退出并 <strong>保存</strong></li>
<li><code>:q!</code>，退出并 <strong>不保存</strong></li>
<li><code>Ctrl + v</code>，进入 Vim 列编辑</li>
<li><code>guu</code>，把当前行的字母全部转换成 <strong>小写</strong></li>
<li><code>gUU</code>，把当前行的字母全部转换成 <strong>大写</strong></li>
<li><code>g~~</code>，把当前行的字母是大写的转换成小写，是小写的转换成大写</li>
<li><code>:saveas /opt/setups/text.txt</code>，另存到 /opt/setups/text.txt</li>
</ul>
</li>
</ul>
</li>
<li>搜索<ul>
<li><code>/YouMeek</code>，从光标开始处向文件尾搜索 YouMeek 字符，按 <code>n</code> 继续向下找，按 <code>N</code> 继续向上找</li>
<li><code>?YouMeek</code>，从光标开始处向文件首搜索 YouMeek 字符，按 <code>n</code> 继续向下找，按 <code>N</code> 继续向上找</li>
</ul>
</li>
<li>替换<ul>
<li><code>:%s/YouMeek/Judasn/g</code>，把文件中所有 YouMeek 替换为：Judasn</li>
<li><code>:%s/YouMeek/Judasn/</code>，把文件中所有行中第一个 YouMeek 替换为：Judasn</li>
<li><code>:s/YouMeek/Judasn/</code>，把光标当前行第一个 YouMeek 替换为 Judasn</li>
<li><code>:s/YouMeek/Judasn/g</code>，把光标当前行所有 YouMeek 替换为 Judasn</li>
<li><code>:s#YouMeek/#Judasn/#</code>，除了使用斜杠作为分隔符之外，还可以使用 # 作为分隔符，此时中间出现的 / 不会作为分隔符，该命令表示：把光标当前行第一个 YouMeek/ 替换为 Judasn/</li>
<li><code>:10,31s/YouMeek/Judasng</code>，把第 10 行到 31 行之间所有 YouMeek 替换为 Judasn</li>
</ul>
</li>
</ul>
<h2 id="Vim-的特殊复制、黏贴"><a href="#Vim-的特殊复制、黏贴" class="headerlink" title="Vim 的特殊复制、黏贴"></a>Vim 的特殊复制、黏贴</h2><ul>
<li>Vim 提供了 12 个剪贴板，分别是：<code>0,1,2,3,4,5,6,7,8,9,a,&quot;</code>，默认采用的是 <code>&quot;</code>，也就是双引号，可能你初读感觉很奇怪。你可以用 Vim 编辑某个文件，然后输入：<code>:reg</code>。你可以看到如下内容：<ul>
<li><img src="images/Vim-Cut-And-Paste-a-1.png" alt="vim"></li>
</ul>
</li>
<li>复制到某个剪切板的命令：<code>&quot;7y</code>，表示使用 7 号剪切板。</li>
<li>黏贴某个剪切板内容：<code>&quot;7p</code>，表示使用 7 号剪切板内容进行黏贴</li>
</ul>
<h2 id="Vim-配置"><a href="#Vim-配置" class="headerlink" title="Vim 配置"></a>Vim 配置</h2><ul>
<li>我个人本地不使用 Vim 的，基本上都是在操作服务器的时候使用，所以这里推荐这个配置文件<ul>
<li><a href="https://github.com/wklken/vim-for-server" target="_blank" rel="external">vim-for-server</a></li>
<li>在假设你已经备份好你的 Vim 配置文件后，使用该配置文件：<code>curl https://raw.githubusercontent.com/wklken/vim-for-server/master/vimrc &gt; ~/.vimrc</code></li>
<li>效果如下：<ul>
<li><img src="https://raw.githubusercontent.com/wklken/gallery/master/vim/vim-for-server.png" alt="vim-for-server"></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://blogread.cn/it/article/1010?f=sa" target="_blank" rel="external">vim几个小技巧（批量替换，列编辑）</a></li>
<li><a href="http://www.2maomao.com/blog/wp-content/uploads/vim_tips.txt" target="_blank" rel="external">最佳vim技巧</a></li>
<li><a href="http://coolshell.cn/articles/5426.html" target="_blank" rel="external">简明 Vim 练级攻略</a></li>
<li><a href="http://blog.csdn.net/wangchong0/article/details/6801956" target="_blank" rel="external">vim 批量查找替换</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Vim-安装和配置、优化&quot;&gt;&lt;a href=&quot;#Vim-安装和配置、优化&quot; class=&quot;headerlink&quot; title=&quot;Vim 安装和配置、优化&quot;&gt;&lt;/a&gt;Vim 安装和配置、优化&lt;/h1&gt;&lt;h2 id=&quot;Vim-介绍&quot;&gt;&lt;a href=&quot;#Vim-介绍&quot; class=&quot;headerlink&quot; title=&quot;Vim 介绍&quot;&gt;&lt;/a&gt;Vim 介绍&lt;/h2&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>GitLab 安装和配置</title>
    <link href="//zeroto.tech/2017/11/22/GitLab-Install-And-Settings/"/>
    <id>//zeroto.tech/2017/11/22/GitLab-Install-And-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:38:15.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="GitLab-安装和配置"><a href="#GitLab-安装和配置" class="headerlink" title="GitLab 安装和配置"></a>GitLab 安装和配置</h1><a id="more"></a>
<h2 id="GitLab-介绍"><a href="#GitLab-介绍" class="headerlink" title="GitLab 介绍"></a>GitLab 介绍</h2><ul>
<li>官网下载：<a href="https://www.gitlab.cc/downloads" target="_blank" rel="external">https://www.gitlab.cc/downloads</a></li>
<li>官网安装说明：<a href="https://doc.gitlab.cc/ce/install/requirements.html" target="_blank" rel="external">https://doc.gitlab.cc/ce/install/requirements.html</a></li>
<li>开源版本和企业版本对比：<a href="https://www.gitlab.cc/features/#enterprise" target="_blank" rel="external">https://www.gitlab.cc/features/#enterprise</a></li>
</ul>
<h2 id="GitLab-安装（CentOS-6）"><a href="#GitLab-安装（CentOS-6）" class="headerlink" title="GitLab 安装（CentOS 6）"></a>GitLab 安装（CentOS 6）</h2><ul>
<li>安装并开放 HTTP 和 SSH、邮件相关服务和端口<ul>
<li>命令：<code>sudo yum install -y curl openssh-server openssh-clients postfix cronie</code></li>
<li>命令：<code>sudo service postfix start</code></li>
<li>命令：<code>sudo chkconfig postfix on</code></li>
<li>命令：<code>sudo lokkit -s http -s ssh</code></li>
</ul>
</li>
<li>添加 GitLab 仓库，并安装到服务器上（8.8.4 安装包有：261M）：<ul>
<li><code>curl -sS http://packages.gitlab.cc/install/gitlab-ce/script.rpm.sh | sudo bash</code></li>
<li><code>sudo yum install -y gitlab-ce</code></li>
</ul>
</li>
<li>启动 GitLab：<code>sudo gitlab-ctl reconfigure</code>，使用这个命令会输出一堆的日志出来，整个启动过程需要耗时 20 秒左右</li>
</ul>
<h2 id="GitLab-配置"><a href="#GitLab-配置" class="headerlink" title="GitLab 配置"></a>GitLab 配置</h2><ul>
<li>用浏览器访问服务器 IP，比如我的是：<a href="http://192.168.1.113，就可以直接看到" target="_blank" rel="external">http://192.168.1.113，就可以直接看到</a> GitLab 配置初始化界面，让你先重置管理员密码，因为密码不能太简单，所以我改为：<a href="http://192.168.1.113，这样比较好记又复杂" target="_blank" rel="external">http://192.168.1.113，这样比较好记又复杂</a></li>
<li>重新访问：<a href="http://192.168.1.113，输入账号密码：root、http://192.168.1.113" target="_blank" rel="external">http://192.168.1.113，输入账号密码：root、http://192.168.1.113</a></li>
<li>访问管理员控制台，添加用户：<a href="http://192.168.1.113/admin/users" target="_blank" rel="external">http://192.168.1.113/admin/users</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;GitLab-安装和配置&quot;&gt;&lt;a href=&quot;#GitLab-安装和配置&quot; class=&quot;headerlink&quot; title=&quot;GitLab 安装和配置&quot;&gt;&lt;/a&gt;GitLab 安装和配置&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>Tomcat 8 安装和配置、优化</title>
    <link href="//zeroto.tech/2017/11/22/Tomcat-Install-And-Settings/"/>
    <id>//zeroto.tech/2017/11/22/Tomcat-Install-And-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T07:06:14.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Tomcat-8-安装和配置、优化"><a href="#Tomcat-8-安装和配置、优化" class="headerlink" title="Tomcat 8 安装和配置、优化"></a>Tomcat 8 安装和配置、优化</h1><a id="more"></a>
<h2 id="Tomcat-8-安装"><a href="#Tomcat-8-安装" class="headerlink" title="Tomcat 8 安装"></a>Tomcat 8 安装</h2><ul>
<li>Tomcat 8 安装<ul>
<li>官网：<a href="http://tomcat.apache.org/" target="_blank" rel="external">http://tomcat.apache.org/</a></li>
<li>Tomcat 8 官网下载：<a href="http://tomcat.apache.org/download-80.cgi" target="_blank" rel="external">http://tomcat.apache.org/download-80.cgi</a></li>
<li>此时（20160207） Tomcat 8 最新版本为：<code>apache-tomcat-8.0.32.tar.gz</code></li>
<li>我个人习惯 <code>/opt</code> 目录下创建一个目录 <code>setups</code> 用来存放各种软件安装包；在 <code>/usr</code> 目录下创建一个 <code>program</code> 用来存放各种解压后的软件包，下面的讲解也都是基于此习惯</li>
<li>我个人已经使用了第三方源：<code>EPEL、RepoForge</code>，如果你出现 <code>yum install XXXXX</code> 安装不成功的话，很有可能就是你没有相关源，请查看我对源设置的文章</li>
<li>Tomcat 8 下载：<code>wget http://apache.fayea.com/tomcat/tomcat-8/v8.0.32/bin/apache-tomcat-8.0.32.tar.gz</code></li>
<li>压缩包解压：<code>tar -zxvf apache-tomcat-8.0.32.tar.gz</code></li>
<li>移到解压出来文件夹到 /usr 下：<code>mv apache-tomcat-8.0.32/ /usr/program/</code></li>
<li>为了方便，修改解压目录的名字：<code>mv /usr/program/apache-tomcat-8.0.32/ /usr/program/tomcat8/</code></li>
</ul>
</li>
<li>设置 Iptables 规则（这一步是必须设置的）：<ul>
<li>一种方式：先关闭 iptables，防止出现拦截问题而测试不了：<code>service iptables stop</code></li>
<li>一种方式：在 iptables 中添加允许规则（Tomcat 默认端口是 8080）：<ul>
<li>添加规则：<code>sudo iptables -I INPUT -p tcp -m tcp --dport 8080 -j ACCEPT</code></li>
<li>保存规则：<code>sudo /etc/rc.d/init.d/iptables save</code></li>
<li>重启 iptables：<code>sudo service iptables restart</code></li>
</ul>
</li>
</ul>
</li>
<li>测试安装好后的 Tomcat：<ul>
<li>启动 Tomcat：<code>sh /usr/program/tomcat8/bin/startup.sh ; tail -200f /usr/program/tomcat8/logs/catalina.out</code></li>
<li>访问：<code>http://服务器 IP 地址:8080/</code></li>
<li>停止 Tomcat：<code>sh /usr/program/tomcat8/bin/shutdown.sh</code></li>
</ul>
</li>
</ul>
<h2 id="Tomcat-8-配置"><a href="#Tomcat-8-配置" class="headerlink" title="Tomcat 8 配置"></a>Tomcat 8 配置</h2><ul>
<li>设置 Tomcat 相关变量：<ul>
<li><code>sudo vim /usr/program/tomcat8/bin/catalina.sh</code></li>
<li>在配置文件的可编辑内容最上面（98 行开始），加上如下内容（具体参数根据你服务器情况自行修改）：<pre><code class="ini">JAVA_HOME=/usr/program/jdk1.8.0_72
CATALINA_HOME=/usr/program/tomcat8
CATALINA_OPTS=&quot;-server -Xms528m -Xmx528m -XX:PermSize=256m -XX:MaxPermSize=358m&quot;
CATALINA_PID=$CATALINA_HOME/catalina.pid
</code></pre>
</li>
</ul>
</li>
<li>如果使用 <code>shutdown.sh</code> 还无法停止 tomcat，可以修改其配置：<code>vim /usr/program/tomcat8/bin/shutdown.sh</code><ul>
<li>把最尾巴这一行：<code>exec &quot;$PRGDIR&quot;/&quot;$EXECUTABLE&quot; stop &quot;$@&quot;</code></li>
<li>改为：<code>exec &quot;$PRGDIR&quot;/&quot;$EXECUTABLE&quot; stop 10 -force</code></li>
</ul>
</li>
</ul>
<h2 id="Tomcat-8-优化"><a href="#Tomcat-8-优化" class="headerlink" title="Tomcat 8 优化"></a>Tomcat 8 优化</h2><ul>
<li>Tomcat 6/7/8 的优化参数有点不一样，最好按下面的方式看一下官网这个文档是否还保留着这个参数</li>
<li>启动tomcat，访问该地址，下面要讲解的一些配置信息，在该文档下都有说明的：<ul>
<li>文档：<a href="http://127.0.0.1:8080/docs/config" target="_blank" rel="external">http://127.0.0.1:8080/docs/config</a></li>
<li>你也可以直接看网络版本：<ul>
<li>Tomcat 6 文档：<a href="https://tomcat.apache.org/tomcat-6.0-doc/config" target="_blank" rel="external">https://tomcat.apache.org/tomcat-6.0-doc/config</a></li>
<li>Tomcat 7 文档：<a href="https://tomcat.apache.org/tomcat-7.0-doc/config/" target="_blank" rel="external">https://tomcat.apache.org/tomcat-7.0-doc/config/</a></li>
<li>Tomcat 8 文档：<a href="https://tomcat.apache.org/tomcat-8.0-doc/config/" target="_blank" rel="external">https://tomcat.apache.org/tomcat-8.0-doc/config/</a></li>
</ul>
</li>
</ul>
</li>
<li>如果你需要查看 Tomcat 的运行状态可以配置tomcat管理员账户，然后登陆 Tomcat 后台进行查看</li>
<li>编辑 /opt/tomcat7/bin/conf/tomcat-users.xml 文件，在里面添加下面信息：<pre><code class="xml">&lt;role rolename=&quot;manager&quot;/&gt;
&lt;role rolename=&quot;manager-gui&quot;/&gt;
&lt;role rolename=&quot;admin&quot;/&gt;
&lt;role rolename=&quot;admin-gui&quot;/&gt;
&lt;user username=&quot;tomcat&quot; password=&quot;tomcat&quot; roles=&quot;admin-gui,admin,manager-gui,manager&quot;/&gt;
</code></pre>
</li>
<li>编辑配置文件：<code>vim /usr/program/tomcat7/conf/server.xml</code><ul>
<li>打开默认被注释的连接池配置：<ul>
<li>默认值：<pre><code class="xml">&lt;!--
&lt;Executor name=&quot;tomcatThreadPool&quot; namePrefix=&quot;catalina-exec-&quot;
  maxThreads=&quot;150&quot; minSpareThreads=&quot;4&quot;/&gt;
--&gt;
</code></pre>
</li>
<li>修改为：<pre><code class="xml">&lt;Executor 
  name=&quot;tomcatThreadPool&quot; 
  namePrefix=&quot;catalina-exec-&quot;
  maxThreads=&quot;500&quot; 
  minSpareThreads=&quot;100&quot; 
  prestartminSpareThreads = &quot;true&quot;
  maxQueueSize = &quot;100&quot;
/&gt;
</code></pre>
</li>
<li>重点参数解释：<ul>
<li>maxThreads，最大并发数，默认设置 200，一般建议在 500 ~ 800，根据硬件设施和业务来判断</li>
<li>minSpareThreads，Tomcat 初始化时创建的线程数，默认设置 25</li>
<li>prestartminSpareThreads，在 Tomcat 初始化的时候就初始化 minSpareThreads 的参数值，如果不等于 true，minSpareThreads 的值就没啥效果了</li>
<li>maxQueueSize，最大的等待队列数，超过则拒绝请求</li>
</ul>
</li>
</ul>
</li>
<li>修改默认的链接参数配置：<ul>
<li>默认值：<pre><code class="xml">&lt;Connector 
  port=&quot;8080&quot; 
  protocol=&quot;HTTP/1.1&quot; 
  connectionTimeout=&quot;20000&quot; 
  redirectPort=&quot;8443&quot; 
/&gt;
</code></pre>
</li>
<li>修改为：<pre><code class="xml">&lt;Connector 
 executor=&quot;tomcatThreadPool&quot;
 port=&quot;8080&quot; 
 protocol=&quot;org.apache.coyote.http11.Http11Nio2Protocol&quot; 
 connectionTimeout=&quot;20000&quot; 
 maxConnections=&quot;10000&quot; 
 redirectPort=&quot;8443&quot; 
 enableLookups=&quot;false&quot; 
 acceptCount=&quot;100&quot; 
 maxPostSize=&quot;10485760&quot; 
 compression=&quot;on&quot; 
 disableUploadTimeout=&quot;true&quot; 
 compressionMinSize=&quot;2048&quot; 
 acceptorThreadCount=&quot;2&quot; 
 compressableMimeType=&quot;text/html,text/xml,text/plain,text/css,text/javascript,application/javascript&quot; 
 URIEncoding=&quot;utf-8&quot;
/&gt;
</code></pre>
</li>
<li>重点参数解释：<ul>
<li>protocol，Tomcat 8 设置 nio2 更好：org.apache.coyote.http11.Http11Nio2Protocol（如果这个用不了，就用下面那个）</li>
<li>protocol，Tomcat 6、7 设置 nio 更好：org.apache.coyote.http11.Http11NioProtocol</li>
<li>enableLookups，禁用DNS查询</li>
<li>acceptCount，指定当所有可以使用的处理请求的线程数都被使用时，可以放到处理队列中的请求数，超过这个数的请求将不予处理，默认设置 100</li>
<li>maxPostSize，以 FORM URL 参数方式的 POST 提交方式，限制提交最大的大小，默认是 2097152(2兆)，它使用的单位是字节。10485760 为 10M。如果要禁用限制，则可以设置为 -1。</li>
<li>acceptorThreadCount，用于接收连接的线程的数量，默认值是1。一般这个指需要改动的时候是因为该服务器是一个多核CPU，如果是多核 CPU 一般配置为 2.</li>
</ul>
</li>
</ul>
</li>
<li>禁用 AJP（如果你服务器没有使用 Apache） <ul>
<li>把下面这一行注释掉，默认 Tomcat 是开启的。<pre><code class="xml">&lt;!-- &lt;Connector port=&quot;8009&quot; protocol=&quot;AJP/1.3&quot; redirectPort=&quot;8443&quot; /&gt; --&gt;
</code></pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="JVM-优化"><a href="#JVM-优化" class="headerlink" title="JVM 优化"></a>JVM 优化</h2><ul>
<li>模型资料来源：<a href="http://xmuzyq.iteye.com/blog/599750" target="_blank" rel="external">http://xmuzyq.iteye.com/blog/599750</a></li>
<li>Java 的内存模型分为：<ul>
<li>Young，年轻代（易被 GC）。Young 区被划分为三部分，Eden 区和两个大小严格相同的 Survivor 区，其中 Survivor 区间中，某一时刻只有其中一个是被使用的，另外一个留做垃圾收集时复制对象用，在 Young 区间变满的时候，minor GC 就会将存活的对象移到空闲的Survivor 区间中，根据 JVM 的策略，在经过几次垃圾收集后，任然存活于 Survivor 的对象将被移动到 Tenured  区间。</li>
<li>Tenured，终身代。Tenured 区主要保存生命周期长的对象，一般是一些老的对象，当一些对象在 Young 复制转移一定的次数以后，对象就会被转移到 Tenured 区，一般如果系统中用了 application 级别的缓存，缓存中的对象往往会被转移到这一区间。</li>
<li>Perm，永久代。主要保存 class,method,filed 对象，这部门的空间一般不会溢出，除非一次性加载了很多的类，不过在涉及到热部署的应用服务器的时候，有时候会遇到 java.lang.OutOfMemoryError : PermGen space 的错误，造成这个错误的很大原因就有可能是每次都重新部署，但是重新部署后，类的 class 没有被卸载掉，这样就造成了大量的 class 对象保存在了 perm 中，这种情况下，一般重新启动应用服务器可以解决问题。</li>
</ul>
</li>
<li>Linux 修改 /usr/program/tomcat7/bin/catalina.sh 文件，把下面信息添加到文件第一行。Windows 和 Linux 有点不一样的地方在于，在 Linux 下，下面的的参数值是被引号包围的，而 Windows 不需要引号包围。<ul>
<li>如果服务器只运行一个 Tomcat<ul>
<li>机子内存如果是 8G，一般 PermSize 配置是主要保证系统能稳定起来就行：<ul>
<li><code>JAVA_OPTS=&quot;-Dfile.encoding=UTF-8 -server -Xms6144m -Xmx6144m -XX:NewSize=1024m -XX:MaxNewSize=2048m -XX:PermSize=512m -XX:MaxPermSize=512m -XX:MaxTenuringThreshold=10 -XX:NewRatio=2 -XX:+DisableExplicitGC&quot;</code></li>
</ul>
</li>
<li>机子内存如果是 16G，一般 PermSize 配置是主要保证系统能稳定起来就行：<ul>
<li><code>JAVA_OPTS=&quot;-Dfile.encoding=UTF-8 -server -Xms13312m -Xmx13312m -XX:NewSize=3072m -XX:MaxNewSize=4096m -XX:PermSize=512m -XX:MaxPermSize=512m -XX:MaxTenuringThreshold=10 -XX:NewRatio=2 -XX:+DisableExplicitGC&quot;</code></li>
</ul>
</li>
<li>机子内存如果是 32G，一般 PermSize 配置是主要保证系统能稳定起来就行：<ul>
<li><code>JAVA_OPTS=&quot;-Dfile.encoding=UTF-8 -server -Xms29696m -Xmx29696m -XX:NewSize=6144m -XX:MaxNewSize=9216m -XX:PermSize=1024m -XX:MaxPermSize=1024m -XX:MaxTenuringThreshold=10 -XX:NewRatio=2 -XX:+DisableExplicitGC&quot;</code></li>
</ul>
</li>
</ul>
</li>
<li>如果是开发机<ul>
<li><code>-Xms550m -Xmx1250m -XX:PermSize=550m -XX:MaxPermSize=1250m</code></li>
</ul>
</li>
<li>参数说明：<pre><code class="nginx">-Dfile.encoding：默认文件编码
-server：表示这是应用于服务器的配置，JVM 内部会有特殊处理的
-Xmx1024m：设置JVM最大可用内存为1024MB
-Xms1024m：设置JVM最小内存为1024m。此值可以设置与-Xmx相同，以避免每次垃圾回收完成后JVM重新分配内存。
-XX:NewSize：设置年轻代大小
-XX:MaxNewSize：设置最大的年轻代大小
-XX:PermSize：设置永久代大小
-XX:MaxPermSize：设置最大永久代大小
-XX:NewRatio=4：设置年轻代（包括 Eden 和两个 Survivor 区）与终身代的比值（除去永久代）。设置为 4，则年轻代与终身代所占比值为 1：4，年轻代占整个堆栈的 1/5
-XX:MaxTenuringThreshold=10：设置垃圾最大年龄，默认为：15。如果设置为 0 的话，则年轻代对象不经过 Survivor 区，直接进入年老代。对于年老代比较多的应用，可以提高效率。如果将此值设置为一个较大值，则年轻代对象会在 Survivor 区进行多次复制，这样可以增加对象再年轻代的存活时间，增加在年轻代即被回收的概论。
-XX:+DisableExplicitGC：这个将会忽略手动调用 GC 的代码使得 System.gc() 的调用就会变成一个空调用，完全不会触发任何 GC
</code></pre>
</li>
</ul>
</li>
</ul>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul>
<li>Tomcat 历史版本下载地址整理（不间断更新）：<ul>
<li><strong>Tomcat 9.0.0.M4</strong>：<code>wget http://mirror.bit.edu.cn/apache/tomcat/tomcat-9/v9.0.0.M4/bin/apache-tomcat-9.0.0.M4.tar.gz</code></li>
<li><strong>Tomcat 8.0.32</strong>：<code>wget http://mirror.bit.edu.cn/apache/tomcat/tomcat-8/v8.0.32/bin/apache-tomcat-8.0.32.tar.gz</code></li>
<li><strong>Tomcat 7.0.68</strong>：<code>wget http://apache.fayea.com/tomcat/tomcat-7/v7.0.68/bin/apache-tomcat-7.0.68.tar.gz</code></li>
<li><strong>Tomcat 6.0.45</strong>：<code>wget http://mirrors.cnnic.cn/apache/tomcat/tomcat-6/v6.0.45/bin/apache-tomcat-6.0.45.tar.gz</code></li>
</ul>
</li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://www.jikexueyuan.com/course/2064_3.html?ss=1" target="_blank" rel="external">http://www.jikexueyuan.com/course/2064_3.html?ss=1</a></li>
<li><a href="http://www.wellho.net/mouth/2163_CATALINA-OPTS-v-JAVA-OPTS-What-is-the-difference-.html" target="_blank" rel="external">http://www.wellho.net/mouth/2163_CATALINA-OPTS-v-JAVA-OPTS-What-is-the-difference-.html</a></li>
<li><a href="http://blog.csdn.net/sunlovefly2012/article/details/47395165" target="_blank" rel="external">http://blog.csdn.net/sunlovefly2012/article/details/47395165</a></li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7708724" target="_blank" rel="external">http://blog.csdn.net/lifetragedy/article/details/7708724</a></li>
<li><a href="http://ihuangweiwei.iteye.com/blog/1233941" target="_blank" rel="external">http://ihuangweiwei.iteye.com/blog/1233941</a></li>
<li><a href="http://www.cnblogs.com/ggjucheng/archive/2013/04/16/3024731.html" target="_blank" rel="external">http://www.cnblogs.com/ggjucheng/archive/2013/04/16/3024731.html</a></li>
<li><a href="https://tomcat.apache.org/tomcat-8.0-doc/config/http.html#Connector_Comparison" target="_blank" rel="external">https://tomcat.apache.org/tomcat-8.0-doc/config/http.html#Connector_Comparison</a></li>
<li><a href="http://www.apelearn.com/study_v2/chapter23.html" target="_blank" rel="external">http://www.apelearn.com/study_v2/chapter23.html</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Tomcat-8-安装和配置、优化&quot;&gt;&lt;a href=&quot;#Tomcat-8-安装和配置、优化&quot; class=&quot;headerlink&quot; title=&quot;Tomcat 8 安装和配置、优化&quot;&gt;&lt;/a&gt;Tomcat 8 安装和配置、优化&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>黑客入侵检查</title>
    <link href="//zeroto.tech/2017/11/22/Was-Hacked/"/>
    <id>//zeroto.tech/2017/11/22/Was-Hacked/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T07:11:17.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="黑客入侵检查"><a href="#黑客入侵检查" class="headerlink" title="黑客入侵检查"></a>黑客入侵检查</h1><a id="more"></a>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><ul>
<li>扫描木马工具：<code>clamAV</code><ul>
<li>官网：<a href="http://pkgs.repoforge.org/clamav/" target="_blank" rel="external">http://pkgs.repoforge.org/clamav/</a></li>
</ul>
</li>
<li>CentOS 安装：<code>yum install -y clamav*</code></li>
<li>启动 clamAV 服务：<code>service clamd restart</code> </li>
<li>更新病毒库：<code>freshclam</code>  </li>
<li>扫描方法：<ul>
<li>扫描 /etc 目录，并把扫描结果放在 /root 目录下：<code>clamscan -r /etc --max-dir-recursion=5 -l /root/etcclamav.log</code></li>
<li>扫描 /bin 目录，并把扫描结果放在 /root 目录下：<code>clamscan -r /bin --max-dir-recursion=5 -l /root/binclamav.log</code></li>
<li>扫描 /usr 目录，并把扫描结果放在 /root 目录下：<code>clamscan -r /usr --max-dir-recursion=5 -l /root/usrclamav.log</code></li>
</ul>
</li>
<li>如果日志有类似内容，表示有木马病毒：<ul>
<li><code>/usr/bin/.sshd: Linux.Trojan.Agent FOUND</code></li>
<li><code>/usr/sbin/ss: Linux.Trojan.Agent FOUND</code></li>
<li><code>/usr/sbin/lsof: Linux.Trojan.Agent FOUND</code></li>
</ul>
</li>
<li>看下当前有多少登录者：<code>who</code></li>
<li>看下最近有哪些登录者：<code>last</code></li>
<li>查看最近尝试登录的账号信息：<code>grep &quot;sshd&quot; /var/log/secure</code><ul>
<li>很多这种信息就表示有人在不断地尝试用 root 登录：<code>Failed password for root from 222.186.56.168 port 4080 ssh2</code></li>
</ul>
</li>
<li>查看最近登录成功的账号信息：<code>grep &quot;Accepted&quot; /var/log/secure</code>，可以看到：pop3, ssh, telnet, ftp 类型</li>
<li>看下查看系统资源占用有无异常：<code>top</code></li>
<li>看下所有进程：<code>ps aux</code></li>
<li>查看当前系统登录者有哪些，及其登录记录：<code>last | more</code></li>
<li>把最近执行的所有命令输出到一个文件，然后下载下来细细研究：<code>history &gt;&gt; /opt/test.txt</code></li>
<li>查看当前系统所有用户有哪些：<code>cat /etc/passwd |awk -F \: &#39;{print $1}&#39;</code><ul>
<li>更多详细可以用：<code>cat /etc/passwd</code></li>
</ul>
</li>
<li>查看开放的端口，比如常用的80,22,8009，后面的箭头表示端口对应占用的程序：<code>netstat -lnp</code></li>
<li>检查某个端口的具体信息：<code>lsof -i :18954</code></li>
<li>检查启动项：<code>chkconfig</code></li>
<li>检查定时器：<code>cat /etc/crontab</code></li>
<li>检查其他系统重要文件：<ul>
<li><code>cat /etc/rc.local</code></li>
<li><code>cd /etc/init.d;ll</code></li>
</ul>
</li>
<li>检查文件：<ul>
<li><code>find / -uid 0 –perm -4000 –print</code></li>
<li><code>find / -size +10000k –print</code></li>
<li><code>find / -name &quot;…&quot; –print</code></li>
<li><code>find / -name &quot;.. &quot; –print</code></li>
<li><code>find / -name &quot;. &quot; –print</code></li>
<li><code>find / -name &quot; &quot; –print</code></li>
</ul>
</li>
<li>下载 iftop 分析流量，查看是否被黑客当做肉鸡使用</li>
<li>安装 iftop<ul>
<li>官网：<a href="http://www.ex-parrot.com/~pdw/iftop/" target="_blank" rel="external">http://www.ex-parrot.com/~pdw/iftop/</a></li>
<li>使用文章：<a href="https://linux.cn/article-1843-1.html" target="_blank" rel="external">https://linux.cn/article-1843-1.html</a></li>
<li>没有安装第三方源的情况：<ul>
<li>安装依赖包：<code>yum install -y flex byacc  libpcap ncurses ncurses-devel libpcap-devel</code></li>
<li>下载源码包：<code>wget http://www.ex-parrot.com/pdw/iftop/download/iftop-0.17.tar.gz</code></li>
<li>解压：<code>tar zxf iftop-0.17.tar.gz</code></li>
<li>进入解压目录：<code>cd iftop-0.17/</code></li>
<li>编译：<code>./configure</code></li>
<li>安装：<code>make &amp;&amp; make install</code></li>
</ul>
</li>
<li>有第三方源的情况（eg：EPEL）：<ul>
<li><code>yum install -y iftop</code></li>
</ul>
</li>
</ul>
</li>
<li>运行：<code>iftop</code><ul>
<li>显示端口与 IP 信息：<code>iftop -nP</code></li>
</ul>
</li>
</ul>
<pre><code class="nginx">中间部分：外部连接列表，即记录了哪些ip正在和本机的网络连接

右边部分：实时参数分别是该访问 ip 连接到本机 2 秒，10 秒和 40 秒的平均流量

=&gt; 代表发送数据，&lt;= 代表接收数据

底部会显示一些全局的统计数据，peek 是指峰值情况，cumm 是从 iftop 运行至今的累计情况，而 rates 表示最近 2 秒、10 秒、40 秒内总共接收或者发送的平均网络流量。

TX:（发送流量）  cumm:   143MB   peak:   10.5Mb    rates:   1.03Mb  1.54Mb  2.10Mb
RX:（接收流量）          12.7GB          228Mb              189Mb   191Mb   183Mb
TOTAL:（总的流量）       12.9GB          229Mb              190Mb   193Mb   185MbW
</code></pre>
<ul>
<li>禁用 root 账号登录：<code>vim /etc/ssh/sshd_config</code><ul>
<li>把 PermitRootLogin 属性 yes 改为 no</li>
</ul>
</li>
<li>如果安全度要更高，可以考虑禁用口令登录，采用私钥/公钥方式：<code>vim /etc/ssh/sshd_config</code><ul>
<li>设置属性：PasswordAuthentication 为 no</li>
</ul>
</li>
<li>如果还要限制指定 IP 登录，可以考虑编辑：hosts.allow 和 hosts.deny 两个文件</li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://www.jianshu.com/p/97b9dc47b88c" target="_blank" rel="external">http://www.jianshu.com/p/97b9dc47b88c</a> </li>
<li><a href="http://monklof.com/post/10/" target="_blank" rel="external">http://monklof.com/post/10/</a> </li>
<li><a href="http://yafeilee.me/blogs/54be6e876c69341430050000" target="_blank" rel="external">http://yafeilee.me/blogs/54be6e876c69341430050000</a> </li>
<li><a href="http://coolnull.com/4174.html" target="_blank" rel="external">http://coolnull.com/4174.html</a> </li>
<li><a href="http://www.oicqzone.com/pc/2014110420118.html" target="_blank" rel="external">http://www.oicqzone.com/pc/2014110420118.html</a> </li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;黑客入侵检查&quot;&gt;&lt;a href=&quot;#黑客入侵检查&quot; class=&quot;headerlink&quot; title=&quot;黑客入侵检查&quot;&gt;&lt;/a&gt;黑客入侵检查&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>Zsh入门</title>
    <link href="//zeroto.tech/2017/11/22/Zsh/"/>
    <id>//zeroto.tech/2017/11/22/Zsh/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T07:11:58.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Zsh-入门"><a href="#Zsh-入门" class="headerlink" title="Zsh 入门"></a>Zsh 入门</h1><h2 id="本文前提"><a href="#本文前提" class="headerlink" title="本文前提"></a>本文前提</h2><ul>
<li>CentOS 6.7 64 bit</li>
<li>root 用户</li>
</ul>
<h2 id="Zsh-介绍"><a href="#Zsh-介绍" class="headerlink" title="Zsh 介绍"></a>Zsh 介绍</h2><ul>
<li>Zsh 兼容 Bash，据传说 99% 的 Bash 操作 和 Zsh 是相同的</li>
<li>Zsh 官网：<a href="http://www.zsh.org/" target="_blank" rel="external">http://www.zsh.org/</a></li>
<li>先看下你的 CentOS 支持哪些 shell：<code>cat /etc/shells</code>，正常结果应该是这样的：</li>
</ul>
<pre><code class="bash">/bin/sh
/bin/bash
/sbin/nologin
/bin/dash
/bin/tcsh
/bin/csh
</code></pre>
<ul>
<li>默认 CentOS / Ubuntu / Mac 系统用的是 Bash，倒也不是说 Bash 不好，而是说我们有更好的选择。</li>
</ul>
<h2 id="Zsh-安装"><a href="#Zsh-安装" class="headerlink" title="Zsh 安装"></a>Zsh 安装</h2><ul>
<li>CentOS 安装：<code>sudo yum install -y zsh</code></li>
<li>Ubuntu 安装：<code>sudo apt-get install -y zsh</code></li>
<li>在检查下系统的 shell：<code>cat /etc/shells</code>，你会发现多了一个：<code>/bin/zsh</code></li>
</ul>
<h2 id="使用-Zsh-扩展集合：oh-my-zsh"><a href="#使用-Zsh-扩展集合：oh-my-zsh" class="headerlink" title="使用 Zsh 扩展集合：oh-my-zsh"></a>使用 Zsh 扩展集合：oh-my-zsh</h2><ul>
<li>oh-my-zsh 帮我们整理了一些常用的 Zsh 扩展功能和主题：<a href="https://github.com/robbyrussell/oh-my-zsh" target="_blank" rel="external">https://github.com/robbyrussell/oh-my-zsh</a></li>
<li>我们无需自己去捣搞 Zsh，直接用 oh-my-zsh 就足够了，如果你想继续深造的话那再去弄。</li>
<li>先安装 git：<code>sudo yum install -y git</code></li>
<li>安装 oh-my-zsh：<code>wget https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O - | sh</code></li>
<li>整个过程效果如下图：<ul>
<li><img src="images/Zsh-a-1.jpg" alt="oh-my-zsh 安装"></li>
</ul>
</li>
<li>在以 root 用户为前提下，oh-my-zsh 的安装目录：<strong>/root/.oh-my-zsh</strong></li>
<li>在以 root 用户为前提下，Zsh 的配置文件位置：<strong>/root/.zshrc</strong></li>
<li>为 root 用户设置 zsh 为系统默认 shell：<code>chsh -s /bin/zsh root</code></li>
<li>如果你要重新恢复到 bash：<code>chsh -s /bin/bash root</code></li>
<li>现在你关掉终端或是重新连上 shell，现在开头是一个箭头了，如下图：<ul>
<li><img src="images/Zsh-b-1.jpg" alt="oh-my-zsh 安装"></li>
</ul>
</li>
</ul>
<h2 id="Zsh-配置"><a href="#Zsh-配置" class="headerlink" title="Zsh 配置"></a>Zsh 配置</h2><h3 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h3><ul>
<li>启用 oh-my-zsh 中自带的插件。</li>
<li>oh-my-zsh 的插件列表介绍（太长了，用源码不精准地统计下有 149 个）：<a href="https://github.com/robbyrussell/oh-my-zsh/wiki/Plugins" target="_blank" rel="external">https://github.com/robbyrussell/oh-my-zsh/wiki/Plugins</a></li>
<li>我们看下安装 oh-my-zsh 的时候自带有多少个插件：<code>ls -l /root/.oh-my-zsh/plugins |grep &quot;^d&quot;|wc -l</code>，我这边得到的结果是：211</li>
<li>编辑配置文件：<code>vim /root/.zshrc</code>，找到下图的地方，怎么安装，原作者注释写得很清楚了，别装太多了，默认 git 是安装的。<ul>
<li><img src="images/Zsh-c-1.jpg" alt="oh-my-zsh 安装"></li>
</ul>
</li>
<li>插件推荐：<ul>
<li><code>wd</code><ul>
<li>简单地讲就是给指定目录映射一个全局的名字，以后方便直接跳转到这个目录，比如：</li>
<li>编辑配置文件，添加上 wd 的名字：<code>vim /root/.zshrc</code></li>
<li>我常去目录：<strong>/opt/setups</strong>，每次进入该目录下都需要这样：<code>cd /opt/setups</code></li>
<li>现在用 wd 给他映射一个快捷方式：<code>cd /opt/setups ; wd add setups</code></li>
<li>以后我在任何目录下只要运行：<code>wd setups</code> 就自动跑到 /opt/setups 目录下了</li>
<li>插件官网：<a href="https://github.com/mfaerevaag/wd" target="_blank" rel="external">https://github.com/mfaerevaag/wd</a></li>
</ul>
</li>
<li><code>autojump</code><ul>
<li>这个插件会记录你常去的那些目录，然后做一下权重记录，你可以用这个命令看到你的习惯：<code>j --stat</code>，如果这个里面有你的记录，那你就只要敲最后一个文件夹名字即可进入，比如我个人习惯的 program：<code>j program</code>，就可以直接到：<code>/usr/program</code></li>
<li>插件官网：<a href="https://github.com/wting/autojump" target="_blank" rel="external">https://github.com/wting/autojump</a></li>
<li>官网插件下载地址：<a href="https://github.com/wting/autojump/downloads" target="_blank" rel="external">https://github.com/wting/autojump/downloads</a></li>
<li>插件下载：<code>wget https://github.com/downloads/wting/autojump/autojump_v21.1.2.tar.gz</code></li>
<li>解压：<code>tar zxvf autojump_v21.1.2.tar.gz</code></li>
<li>进入解压后目录并安装：<code>cd autojump_v21.1.2/ ; ./install.sh</code></li>
<li>再执行下这个：<code>source /etc/profile.d/autojump.sh</code></li>
<li>编辑配置文件，添加上 autojump 的名字：<code>vim /root/.zshrc</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="主题"><a href="#主题" class="headerlink" title="主题"></a>主题</h3><ul>
<li>很多人喜欢捣搞这个 ╮(￣▽￣)╭</li>
<li>捣搞主题和插件思路一样</li>
<li>oh-my-zsh 的主题列表介绍（还是太长了）：<a href="https://github.com/robbyrussell/oh-my-zsh/wiki/Themes" target="_blank" rel="external">https://github.com/robbyrussell/oh-my-zsh/wiki/Themes</a></li>
<li>我们看下安装 oh-my-zsh 的时候，自带有多少个：<code>ls -l /root/.oh-my-zsh/themes |grep &quot;^-&quot;|wc -l</code>，我这边得到的结果是：140</li>
<li>我个人品味地推荐的是（排名有先后）：<ul>
<li><code>ys</code></li>
<li><code>agnoster</code></li>
<li><code>avit</code></li>
<li><code>blinks</code></li>
</ul>
</li>
<li>编辑配置文件：<code>vim /root/.zshrc</code>，找到下图的地方，怎么安装，原作者注释写得很清楚了，如果你没特别的喜欢那就选择随机吧。<ul>
<li><img src="images/Zsh-d-1.jpg" alt="oh-my-zsh 安装"></li>
</ul>
</li>
<li>配置好新主题需要重新连接 shell 才能看到效果</li>
</ul>
<h2 id="一些人性化功能"><a href="#一些人性化功能" class="headerlink" title="一些人性化功能"></a>一些人性化功能</h2><ul>
<li>呃，这个其实可以不用讲的，你自己用的时候你自己会发现的，各种便捷，特别是用 Tab 多的人一定会有各种惊喜的。</li>
</ul>
<h2 id="差异"><a href="#差异" class="headerlink" title="差异"></a>差异</h2><ul>
<li>我们现在增加系统变量在：/etc/profile 后，输入命令：source /etc/profile 之后，重启服务器发现刚刚的系统变量现在没效果。<ul>
<li>解决办法：<code>vim ~/.zshrc</code>，在该配置文件里面增加一行：<code>source /etc/profile</code>，然后刷新 zsh 的配置：<code>source ~/.zshrc</code>。</li>
</ul>
</li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://macshuo.com/?p=676" target="_blank" rel="external">http://macshuo.com/?p=676</a></li>
<li><a href="https://aaaaaashu.gitbooks.io/mac-dev-setup/content/iTerm/zsh.html" target="_blank" rel="external">https://aaaaaashu.gitbooks.io/mac-dev-setup/content/iTerm/zsh.html</a></li>
<li><a href="http://hackerxu.com/2014/11/19/ZSH.html" target="_blank" rel="external">http://hackerxu.com/2014/11/19/ZSH.html</a></li>
<li><a href="https://blog.phpgao.com/oh-my-zsh.html" target="_blank" rel="external">https://blog.phpgao.com/oh-my-zsh.html</a></li>
<li><a href="http://www.bkjia.com/Linuxjc/1033947.html" target="_blank" rel="external">http://www.bkjia.com/Linuxjc/1033947.html</a></li>
<li><a href="http://swiftcafe.io/2015/10/31/cafe-time-omz/" target="_blank" rel="external">http://swiftcafe.io/2015/10/31/cafe-time-omz/</a></li>
<li><a href="http://swiftcafe.io/2015/12/04/omz-plugin/" target="_blank" rel="external">http://swiftcafe.io/2015/12/04/omz-plugin/</a></li>
<li><a href="http://www.hackbase.com/article-206940-1.html" target="_blank" rel="external">http://www.hackbase.com/article-206940-1.html</a></li>
<li><a href="http://hahack.com/wiki/shell-zsh.html" target="_blank" rel="external">http://hahack.com/wiki/shell-zsh.html</a></li>
<li><a href="http://blog.jobbole.com/86820/" target="_blank" rel="external">http://blog.jobbole.com/86820/</a></li>
<li><a href="http://uecss.com/zsh-brew-autojump-plugins-shell-for-mac.html" target="_blank" rel="external">http://uecss.com/zsh-brew-autojump-plugins-shell-for-mac.html</a></li>
<li><a href="http://www.cnblogs.com/westfly/p/3283525.html" target="_blank" rel="external">http://www.cnblogs.com/westfly/p/3283525.html</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Zsh-入门&quot;&gt;&lt;a href=&quot;#Zsh-入门&quot; class=&quot;headerlink&quot; title=&quot;Zsh 入门&quot;&gt;&lt;/a&gt;Zsh 入门&lt;/h1&gt;&lt;h2 id=&quot;本文前提&quot;&gt;&lt;a href=&quot;#本文前提&quot; class=&quot;headerlink&quot; title=&quot;本
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="//zeroto.tech/2017/11/22/centos-settings/Close-XWindow/"/>
    <id>//zeroto.tech/2017/11/22/centos-settings/Close-XWindow/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2017-11-22T09:32:19.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="CentOS-图形界面的关闭与开启"><a href="#CentOS-图形界面的关闭与开启" class="headerlink" title="CentOS 图形界面的关闭与开启"></a>CentOS 图形界面的关闭与开启</h2><h2 id="初衷"><a href="#初衷" class="headerlink" title="初衷"></a>初衷</h2><ul>
<li>本地开多个虚拟机搞集群测试，为了节省资源，关掉图形界面更好点</li>
</ul>
<h2 id="设置方法"><a href="#设置方法" class="headerlink" title="设置方法"></a>设置方法</h2><ul>
<li>编辑配置文件：<code>vim /etc/inittab</code></li>
<li>把默认值：<code>id:5:initdefault:</code>，改为：<code>id:3:initdefault:</code></li>
<li>重启系统：<code>reboot</code>，重启后就只有 shell 界面了。</li>
<li>在 shell 界面中如果你还希望临时开启图形界面可以输入：<code>init 5</code></li>
<li>在图形界面中如果你希望临时关闭图形界面可以输入：<code>init 3</code></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;CentOS-图形界面的关闭与开启&quot;&gt;&lt;a href=&quot;#CentOS-图形界面的关闭与开启&quot; class=&quot;headerlink&quot; title=&quot;CentOS 图形界面的关闭与开启&quot;&gt;&lt;/a&gt;CentOS 图形界面的关闭与开启&lt;/h2&gt;&lt;h2 id=&quot;初衷&quot;&gt;&lt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>CentOS 源设置</title>
    <link href="//zeroto.tech/2017/11/22/centos-settings/CentOS-Extra-Packages/"/>
    <id>//zeroto.tech/2017/11/22/centos-settings/CentOS-Extra-Packages/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T07:14:25.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CentOS-源设置"><a href="#CentOS-源设置" class="headerlink" title="CentOS 源设置"></a>CentOS 源设置</h1><a id="more"></a>
<blockquote>
<p>国内常用源配置方法（该源和官方源是一样的，只是因为服务器在国内会起到加速作用而已）：</p>
</blockquote>
<ul>
<li>163 源：<a href="http://mirrors.163.com/.help/centos.html" target="_blank" rel="external">http://mirrors.163.com/.help/centos.html</a> </li>
<li>阿里源：<a href="http://mirrors.aliyun.com/help/centos" target="_blank" rel="external">http://mirrors.aliyun.com/help/centos</a></li>
<li>sohu：<a href="http://mirrors.sohu.com/help/centos.html" target="_blank" rel="external">http://mirrors.sohu.com/help/centos.html</a></li>
</ul>
<blockquote>
<p>替换过程（这里以 163 源为例，系统 CentOS 6.7）：</p>
</blockquote>
<ul>
<li>备份官网源：<code>sudo mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.20151219.backup</code></li>
<li><code>cd /etc/yum.repos.d/</code></li>
<li>下载对应版本 repo 文件, 放入 <strong>/etc/yum.repos.d/</strong><ul>
<li>下载源文件：<ul>
<li>CentOS7：<code>sudo wget http://mirrors.163.com/.help/CentOS7-Base-163.repo</code></li>
<li>CentOS6：<code>sudo wget http://mirrors.163.com/.help/CentOS6-Base-163.repo</code></li>
<li>CentOS5：<code>sudo wget http://mirrors.163.com/.help/CentOS5-Base-163.repo</code></li>
</ul>
</li>
<li><code>sudo mv CentOS6-Base-163.repo CentOS-Base.repo</code></li>
<li>导入key：<code>rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</code></li>
<li><code>sudo yum clean all</code></li>
<li><code>sudo yum makecache</code></li>
<li><code>sudo yum update -y</code></li>
</ul>
</li>
</ul>
<blockquote>
<p>加入第三方源主要是为了 yum 下载到官方没有提供的软件，在其他社区、第三方源里面有很多的软件包，有些软件是很好用的。CentOS 可以加入多个源，所以就存在一个源的优先级问题了，设置优先级的可以使用 yum-plugin-priorities 工具。一般我是建议官方的优先级是最高的，然后才是第三方的。</p>
</blockquote>
<ul>
<li>安装 yum-plugin-priorities：<ul>
<li>CentOS 4 或 CentOS 6：<code>sudo yum install -y yum-plugin-priorities</code></li>
<li>CentOS 5：<code>sudo yum install -y yum-priorities</code></li>
</ul>
</li>
<li><p>安装完 yum-plugin-priorities 插件后，默认是开启的，如果要关闭可以这样设置：</p>
<ul>
<li><code>sudo vim /etc/yum/pluginconf.d/priorities.conf</code></li>
<li>把 enabled=1 改为 enabled=0 即可</li>
<li>设置默认源的优先级：</li>
<li>一般默认的源配置里面 [base], [updates], [extras]，[centosplus] 的 priority=1， [contrib] 的 priority=2，其他第三的软件源为：priority=N （推荐 N &gt; 10，N 可以为1到99的正整数，数值越小越优先）</li>
<li><code>sudo vim /etc/yum.repos.d/CentOS-Base.repo</code></li>
<li>配置内容如下图</li>
<li><img src="../images/CentOS-Extra-Packages-a-1.jpg" alt="CentOS 默认源的级别设置"></li>
</ul>
</li>
<li><p>安装 EPEL 源：</p>
<ul>
<li>官网中文材料：<a href="https://fedoraproject.org/wiki/EPEL/zh-cn" target="_blank" rel="external">https://fedoraproject.org/wiki/EPEL/zh-cn</a></li>
<li>安装命令：<code>sudo yum install -y epel-release</code></li>
<li>导入 KEY：<code>rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6</code></li>
<li>设置 EPEL 源的级别：<code>vim  /etc/yum.repos.d/epel.repo</code>，追加：priority=11</li>
</ul>
</li>
<li><p>卸载 EPEL 源</p>
<ul>
<li>如果你暂时不想使用 EPEL 源的话，把 epel.repo 里的 enabled=1 改成 enabled=0 即可，如果你完全不需要了，那就直接卸载掉 <code>sudo rpm -e epel-release</code></li>
</ul>
</li>
<li><p>安装 RepoForge 源：（旧的名字为 rpmforge）</p>
<ul>
<li>官网下载 RPM包：<a href="http://repoforge.org/use/" target="_blank" rel="external">http://repoforge.org/use/</a></li>
<li>我是 CentOS 6.7 64 位，所以下载 EL 6 x86_64，下载 RMP 安装文件大小：12.3 KB</li>
<li>下载命令：<code>wget http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.3-1.el6.rf.x86_64.rpm</code>（我这边 wget 不下来，需要开 VPN，所以你最好有这个心理准备）</li>
<li>安装 RPM 文件：<code>sudo rpm -ivh rpmforge-release-0.5.3-1.el6.rf.x86_64.rpm</code></li>
<li>导入 KEY：<code>sudo rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-rpmforge-dag</code></li>
<li>设置 RepoForge 源的级别：<code>vim  /etc/yum.repos.d/rpmforge.repo</code>，设置如下图</li>
<li><img src="../images/CentOS-Extra-Packages-a-2.jpg" alt="RepoForge 源的级别设置"></li>
</ul>
</li>
<li><p>更新包信息：</p>
<ul>
<li><code>sudo yum clean all</code></li>
<li><code>sudo yum makecache</code></li>
<li><code>sudo yum update -y</code></li>
</ul>
</li>
<li><p>测试：</p>
<ul>
<li>命令：<code>sudo yum check-update</code></li>
<li>看到显示的结果中包括 rpmforge 和 epel 的列表表示成功。</li>
<li><code>sudo yum install -y htop</code>（htop 官方源是没有的，所以如果能下载下来就表示已经使用了第三方源）</li>
</ul>
</li>
</ul>
<blockquote>
<p>资料：</p>
</blockquote>
<ul>
<li><a href="https://wiki.centos.org/zh/PackageManagement/Yum/Priorities" target="_blank" rel="external">https://wiki.centos.org/zh/PackageManagement/Yum/Priorities</a></li>
<li><a href="http://www.cnblogs.com/Security-Darren/p/3947952.html" target="_blank" rel="external">http://www.cnblogs.com/Security-Darren/p/3947952.html</a></li>
<li><a href="http://freeloda.blog.51cto.com/2033581/1260824" target="_blank" rel="external">http://freeloda.blog.51cto.com/2033581/1260824</a></li>
<li><a href="http://www.centoscn.com/CentOS/config/2014/0920/3793.html" target="_blank" rel="external">http://www.centoscn.com/CentOS/config/2014/0920/3793.html</a>  </li>
<li><a href="http://www.cnblogs.com/mchina/archive/2013/01/04/2842275.html" target="_blank" rel="external">http://www.cnblogs.com/mchina/archive/2013/01/04/2842275.html</a></li>
<li><a href="http://www.ha97.com/2626.html" target="_blank" rel="external">http://www.ha97.com/2626.html</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;CentOS-源设置&quot;&gt;&lt;a href=&quot;#CentOS-源设置&quot; class=&quot;headerlink&quot; title=&quot;CentOS 源设置&quot;&gt;&lt;/a&gt;CentOS 源设置&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="//zeroto.tech/2017/11/22/config/"/>
    <id>//zeroto.tech/2017/11/22/config/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2017-11-22T09:32:19.000Z</updated>
    
    <content type="html"><![CDATA[{"name":"Java 程序员眼中的 Linux","introduction":"笔者从 Java 开发角度，全方位讲解各种环境搭建及常用工具详解，是一部适合程序员的百科全书。"}]]></content>
    
    <summary type="html">
    
      {&quot;name&quot;:&quot;Java 程序员眼中的 Linux&quot;,&quot;introduction&quot;:&quot;笔者从 Java 开发角度，全方位讲解各种环境搭建及常用工具详解，是一部适合程序员的百科全书。&quot;}
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>CentOS 网络设置</title>
    <link href="//zeroto.tech/2017/11/22/centos-settings/CentOS-Network-Settings/"/>
    <id>//zeroto.tech/2017/11/22/centos-settings/CentOS-Network-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T07:17:10.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CentOS-网络设置"><a href="#CentOS-网络设置" class="headerlink" title="CentOS 网络设置"></a>CentOS 网络设置</h1><ul>
<li>由于前面虚拟机中安装 CentOS 使用的是桥接模式，为了让虚拟机中的系统能上网，我们需要进行网络设置。</li>
</ul>
<a id="more"></a>
<ul>
<li><img src="../images/CentOS-Network-Settings-a-1.jpg" alt="界面化设置"><ul>
<li>选择上图箭头所示</li>
</ul>
</li>
<li><img src="../images/CentOS-Network-Settings-a-2.jpg" alt="界面化设置"><ul>
<li>如上图标注 3 所示：选择 <code>手动</code> 模式</li>
<li>如上图标注 4 所示：填写自己局域网内的子网掩码、默认网关，以及你要分配的内网 IP 地址。这三个参数你可以参考你当前使用的主机信息，在 Windows 系统上使用：<code>cmd --- ipconfig</code>，查看你当前连接的网卡信息。如果你是无线网卡则读取对应的无线网卡信息，如果你是本地连接，则读取对应的本地连接信息。 </li>
<li>如上图标注 5 所示：填写你当前地区合适的 DNS 地址，我这边地区使用 360 测试出来的结果显示 114 的适合我，所以我这里填写该值</li>
</ul>
</li>
</ul>
<h2 id="networkSettings2">命令行下设置网络</h2>

<ul>
<li>编辑网卡信息：<ul>
<li>备份：<code>cp /etc/sysconfig/network-scripts/ifcfg-eth0 /etc/sysconfig/network-scripts/ifcfg-eth0-20160205Back</code></li>
<li>把备份文件移动到其他目录：<code>mv /etc/sysconfig/network-scripts/ifcfg-eth0-20160205Back /opt/myBack</code></li>
<li>编辑网卡文件：<code>vim /etc/sysconfig/network-scripts/ifcfg-eth0</code></li>
<li>把网卡中信息改为下面对应内容：<pre><code>DEVICE=eth0  (系统默认值)
TYPE=Ethernet  (系统默认值)
UUID=a2c17f0c-a224-43d5-a203-48af1f0d9113  (系统默认值)
ONBOOT=yes  (系统默认值是 no,我改为 yes)
NM_CONTROLLED=yes  (系统默认值)
BOOTPROTO=none   (系统默认值是 dhcp,我改为 none,代表手动)
USERCTL=no   (自己补充的)
IPV6INIT=no   (自己补充的)
NETMASK=255.255.255.0  (自己补充的)
IPADDR=192.168.0.110   (自己补充的)
GATEWAY=192.168.0.1   (自己补充的)
DNS1=114.114.114.114  (自己补充的)
PREFIX=24  (使用图形界面设置后生成的)
DEFROUTE=yes  (使用图形界面设置后生成的)
IPV4_FAILURE_FATAL=yes  (使用图形界面设置后生成的) 
NAME=&quot;System eth0&quot;    (使用图形界面设置后生成的) 
HWADDR=00:0C:29:A9:37:D4    (使用图形界面设置后生成的) 
LAST_CONNECT=1454626679   (使用图形界面设置后生成的)
</code></pre></li>
<li>重启网络配置：<code>service network restart</code></li>
</ul>
</li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;CentOS-网络设置&quot;&gt;&lt;a href=&quot;#CentOS-网络设置&quot; class=&quot;headerlink&quot; title=&quot;CentOS 网络设置&quot;&gt;&lt;/a&gt;CentOS 网络设置&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;由于前面虚拟机中安装 CentOS 使用的是桥接模式，为了让虚拟机中的系统能上网，我们需要进行网络设置。&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>花生壳</title>
    <link href="//zeroto.tech/2017/11/22/Hsk-Install/"/>
    <id>//zeroto.tech/2017/11/22/Hsk-Install/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:38:59.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="花生壳-安装"><a href="#花生壳-安装" class="headerlink" title="花生壳 安装"></a>花生壳 安装</h1><a id="more"></a>
<h2 id="CentOS-下过程"><a href="#CentOS-下过程" class="headerlink" title="CentOS 下过程"></a>CentOS 下过程</h2><ul>
<li>官网：<a href="http://hsk.oray.com/" target="_blank" rel="external">http://hsk.oray.com/</a> </li>
<li>官网下载：<a href="http://hsk.oray.com/download/#type=linux" target="_blank" rel="external">http://hsk.oray.com/download/#type=linux</a></li>
<li>官网安装说明：<a href="http://service.oray.com/question/1890.html" target="_blank" rel="external">http://service.oray.com/question/1890.html</a></li>
<li>软件包下载：<code>wget http://download.oray.com/peanuthull/linux/phddns-2.0.6.el6.x86_64.rpm</code></li>
<li>安装：<code>sudo yum localinstall -y phddns-2.0.6.el6.x86_64.rpm</code></li>
<li>配置：<ul>
<li>安装完毕后，在终端下运行：<code>phddns</code></li>
<li>第一步：：Enter server address(press ENTER use phddns60.oray.net)，这是提示您输入花生壳服务器的域名，如果网站上没有更新域名的公告说明，这一步直接回车即可，会使用默认的 phddns60.oray.net 域名。</li>
<li>第二步：Enter your Oray account:这是提示您输入在花生壳官网注册的用户名，请根据实际情况输入。</li>
<li>第三步：Password：这是提示您输入在花生壳官网注册的用户名所对应的密码，请根据实际情况输入。</li>
<li>第四步：Network interface(s): 这是要配置您这台服务器的网络参数，花生壳（公网版）软件会自动检查，并输出您的网络情况。eth0部分可能和上面的不一样，是您的实际网络设置。如果您有两块网卡，eth0 和eth1 ,而您希望用eth1来绑定花生壳，请在这里输入 eth1 ，然后回车。如果您只有一块网卡，或者您希望使用 eth0来绑定花生壳，在这里直接回车即可。</li>
<li>第五步：Log to use(default /var/log/phddns.log):这是提示您输入花生壳（公网版）软件日志的保存位置，请使用绝对路径指定日志文件名。如果直接回车，会使用 /var/log/phddns.log 来保存日志。</li>
<li>第六步： Save to configuration file (/etc/phlinux.conf)?(yes/no/other): 这是提示您输入上述配置的保存文件名。如果输入yes 或直接回车，将会使用/etc/phlinux.conf 来作为配置的保存文件名。如果输入other ，将会提示您自行指定文件名，请使用绝对路径来指定这个配置文件名。如果输入no ,不对上述配置进行保存,下次重新使用花生壳（公网版）时,需要手动指定配置文件或再次通过交互模式进行设置.</li>
<li>第六步执行完毕后，屏幕上会依次出现：defOnStatusChanged ok，DomainsRegistered，UserType，表示安装、配置完成了</li>
</ul>
</li>
<li>启动服务：<code>/usr/bin/phddns -c /etc/phlinux.conf -d</code></li>
<li>设置开机启动：<code>echo &quot;/usr/bin/phddns -c /etc/phlinux.conf -d&quot; &gt;&gt; /etc/rc.local</code></li>
<li>查看进程：<code>ps -ef | grep phddns</code></li>
<li>卸载：<ul>
<li><code>rpm -qa|grep phddns</code></li>
<li><code>sudo rpm -e phddns-2.0.6-1.el6.x86_64</code></li>
</ul>
</li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://service.oray.com/question/1890.html" target="_blank" rel="external">http://service.oray.com/question/1890.html</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;花生壳-安装&quot;&gt;&lt;a href=&quot;#花生壳-安装&quot; class=&quot;headerlink&quot; title=&quot;花生壳 安装&quot;&gt;&lt;/a&gt;花生壳 安装&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>JDK 安装</title>
    <link href="//zeroto.tech/2017/11/22/JDK-Install/"/>
    <id>//zeroto.tech/2017/11/22/JDK-Install/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:41:03.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="JDK-安装"><a href="#JDK-安装" class="headerlink" title="JDK 安装"></a>JDK 安装</h1><a id="more"></a>
<h2 id="CentOS-下过程"><a href="#CentOS-下过程" class="headerlink" title="CentOS 下过程"></a>CentOS 下过程</h2><ul>
<li>JDK 在 CentOS 和 Ubuntu 下安装过程是一样的，所以这里不再讲 Ubuntu 系统下的安装</li>
<li>JDK 1.8 下载<ul>
<li>此时（20160205）最新版本：<code>jdk-8u72-linux-x64.tar.gz</code></li>
<li>官网：<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="external">http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html</a></li>
<li>百度云下载（64 位）：<a href="http://pan.baidu.com/s/1eQZffbW" target="_blank" rel="external">http://pan.baidu.com/s/1eQZffbW</a></li>
<li>官网压缩包地址：<a href="http://211.138.156.198:82/1Q2W3E4R5T6Y7U8I9O0P1Z2X3C4V5B/download.oracle.com/otn-pub/java/jdk/8u72-b15/jdk-8u72-linux-x64.tar.gz" target="_blank" rel="external">http://211.138.156.198:82/1Q2W3E4R5T6Y7U8I9O0P1Z2X3C4V5B/download.oracle.com/otn-pub/java/jdk/8u72-b15/jdk-8u72-linux-x64.tar.gz</a></li>
<li>在命令行模式下下载上面压缩包：<ul>
<li><code>cd /opt</code></li>
<li><code>sudo wget http://211.138.156.198:82/1Q2W3E4R5T6Y7U8I9O0P1Z2X3C4V5B/download.oracle.com/otn-pub/java/jdk/8u72-b15/jdk-8u72-linux-x64.tar.gz</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>默认 CentOS 有安装 openJDK，建议先卸载掉</p>
<ul>
<li>检查 JDK 命令：<code>java -version</code></li>
<li><p>查询本地 JDK 安装程序情况； <code>rpm -qa|grep java</code></p>
<ul>
<li>我查询出来的结果如下：</li>
</ul>
<pre><code>java-1.6.0-openjdk-1.6.0.38-1.13.10.0.el6_7.x86_64
java-1.7.0-openjdk-1.7.0.95-2.6.4.0.el6_7.x86_64
tzdata-java-2015g-2.el6.noarch
</code></pre><ul>
<li>卸载上面三个文件（<code>--nodeps</code> 的作用：忽略依赖的检查）：</li>
<li><code>sudo rpm -e --nodeps java-1.6.0-openjdk-1.6.0.38-1.13.10.0.el6_7.x86_64</code></li>
<li><code>sudo rpm -e --nodeps java-1.7.0-openjdk-1.7.0.95-2.6.4.0.el6_7.x86_64</code></li>
<li><code>sudo rpm -e --nodeps tzdata-java-2015g-2.el6.noarch</code></li>
<li>也可以一起卸载：<code>sudo rpm -e --nodeps java-1.6.0-openjdk-1.6.0.38-1.13.10.0.el6_7.x86_64 java-1.7.0-openjdk-1.7.0.95-2.6.4.0.el6_7.x86_64 tzdata-java-2015g-2.el6.noarch</code></li>
</ul>
</li>
</ul>
</li>
<li><p>JDK 1.8 安装</p>
<ul>
<li>我们以安装 <code>jdk-8u72-linux-x64.tar.gz</code> 为例</li>
<li>我个人习惯 <code>/opt</code> 目录下创建一个目录 <code>setups</code> 用来存放各种软件安装包；在 <code>/usr</code> 目录下创建一个 <code>program</code> 用来存放各种解压后的软件包，下面的讲解也都是基于此习惯</li>
<li>我个人已经使用了第三方源：<code>EPEL、RepoForge</code>，如果你出现 <code>yum install XXXXX</code> 安装不成功的话，很有可能就是你没有相关源，请查看我对源设置的文章</li>
<li>解压安装包：<code>sudo tar -zxvf jdk-8u72-linux-x64.tar.gz</code></li>
<li>移到解压包到我个人习惯的安装目录下：<code>mv jdk1.8.0_72/ /usr/program/</code></li>
<li>配置环境变量：<ul>
<li>编辑配置文件：<code>sudo vim /etc/profile</code></li>
<li>在该文件的最尾巴，添加下面内容：<pre><code># JDK
JAVA_HOME=/usr/program/jdk1.8.0_72
JRE_HOME=$JAVA_HOME/jre
PATH=$PATH:$JAVA_HOME/bin
CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
export JAVA_HOME
export JRE_HOME
export PATH
export CLASSPATH
</code></pre></li>
<li>执行命令，刷新该配置（必备操作）：<code>source /etc/profile</code></li>
<li>检查是否使用了最新的 JDK：<code>java -version</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul>
<li>JDK 历史版本下载地址整理（不间断更新）：<ul>
<li><strong>JDK 8</strong>：<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="external">http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html</a></li>
<li><strong>JDK 7</strong>：<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html" target="_blank" rel="external">http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html</a></li>
<li><strong>JDK 6</strong>：<a href="http://www.oracle.com/technetwork/java/javasebusiness/downloads/java-archive-downloads-javase6-419409.html" target="_blank" rel="external">http://www.oracle.com/technetwork/java/javasebusiness/downloads/java-archive-downloads-javase6-419409.html</a></li>
</ul>
</li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;JDK-安装&quot;&gt;&lt;a href=&quot;#JDK-安装&quot; class=&quot;headerlink&quot; title=&quot;JDK 安装&quot;&gt;&lt;/a&gt;JDK 安装&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="//zeroto.tech/2017/11/22/centos-settings/Clear-Cache/"/>
    <id>//zeroto.tech/2017/11/22/centos-settings/Clear-Cache/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2017-11-22T09:32:19.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="清除系统缓存"><a href="#清除系统缓存" class="headerlink" title="清除系统缓存"></a>清除系统缓存</h2><h2 id="初衷"><a href="#初衷" class="headerlink" title="初衷"></a>初衷</h2><ul>
<li>本身 Linux 有比较成熟的内存管理机制，但是不免也是会抽风的，有些程序在被 kill 掉之后系统内存依然没有大的变化，这时候就需要手动清除。</li>
</ul>
<h2 id="清除缓存"><a href="#清除缓存" class="headerlink" title="清除缓存"></a>清除缓存</h2><ul>
<li>官网说明：<a href="http://www.kernel.org/doc/Documentation/sysctl/vm.txt" target="_blank" rel="external">http://www.kernel.org/doc/Documentation/sysctl/vm.txt</a></li>
<li>先查看目前系统内存使用情况：<code>free -m</code></li>
<li>同步缓存数据到硬盘：<code>sync</code></li>
<li>开始清理：<code>echo 3 &gt; /proc/sys/vm/drop_caches</code><ul>
<li>0：不清除</li>
<li>1：清除页缓存</li>
<li>2：清除目录项缓存与文件结点缓存</li>
<li>3：清除所有缓存（常用）</li>
</ul>
</li>
<li>再查看清除后效果：<code>free -m</code></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;清除系统缓存&quot;&gt;&lt;a href=&quot;#清除系统缓存&quot; class=&quot;headerlink&quot; title=&quot;清除系统缓存&quot;&gt;&lt;/a&gt;清除系统缓存&lt;/h2&gt;&lt;h2 id=&quot;初衷&quot;&gt;&lt;a href=&quot;#初衷&quot; class=&quot;headerlink&quot; title=&quot;初衷&quot;&gt;&lt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Jenkins 安装和配置</title>
    <link href="//zeroto.tech/2017/11/22/Jenkins-Install-And-Settings/"/>
    <id>//zeroto.tech/2017/11/22/Jenkins-Install-And-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:41:48.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Jenkins-安装和配置"><a href="#Jenkins-安装和配置" class="headerlink" title="Jenkins 安装和配置"></a>Jenkins 安装和配置</h1><a id="more"></a>
<h2 id="Jenkins-安装"><a href="#Jenkins-安装" class="headerlink" title="Jenkins 安装"></a>Jenkins 安装</h2><ul>
<li>Jenkins 安装<ul>
<li>官网：<a href="http://jenkins-ci.org/" target="_blank" rel="external">http://jenkins-ci.org/</a></li>
<li>官网帮助中心：<a href="https://wiki.jenkins-ci.org/display/JENKINS/Use+Jenkins" target="_blank" rel="external">https://wiki.jenkins-ci.org/display/JENKINS/Use+Jenkins</a></li>
<li>官网使用 Tomcat 部署方式指导：<a href="https://wiki.jenkins-ci.org/display/JENKINS/Tomcat" target="_blank" rel="external">https://wiki.jenkins-ci.org/display/JENKINS/Tomcat</a></li>
<li>此时（20160207） Jenkins 最新版本为：<strong>1.647</strong></li>
<li>JDK 最低要求是 JDK 7，官网推荐是 JDK 8</li>
<li>我个人习惯 <code>/opt</code> 目录下创建一个目录 <code>setups</code> 用来存放各种软件安装包；在 <code>/usr</code> 目录下创建一个 <code>program</code> 用来存放各种解压后的软件包，下面的讲解也都是基于此习惯</li>
<li>我个人已经使用了第三方源：<code>EPEL、RepoForge</code>，如果你出现 <code>yum install XXXXX</code> 安装不成功的话，很有可能就是你没有相关源，请查看我对源设置的文章</li>
<li>Jenkins 下载：<code>wget http://mirrors.jenkins-ci.org/war/latest/jenkins.war</code> （大小：61 M）<ul>
<li>我们假设这个 Tomcat 就是为了 Jenkins 专用的</li>
<li>把下载下来的 jenkins.war 移到 Tomcat 的 webapps 目录下，比如我的是：<code>/usr/program/tomcat8/webapps</code></li>
<li>把 Jenkins.war 改名为 ROOT.war：<code>mv jenkins.war ROOT.war</code></li>
<li>删除 Tomcat 下 webapps 目录下多余的一些目录</li>
<li>首次启动 Tomcat，让 Tomcat 解压 war</li>
<li>设置 JENKINS_HOME：<ul>
<li>寻找 jenkins home 目录地址：<code>find / -name .jenkins</code>，我这边得到的结果是：<code>/root/.jenkins</code></li>
<li>对在 Tomcat 文章中讲解的系统变量 <code>CATALINA_OPTS</code> 进行设置：<ul>
<li>旧值：<pre><code>CATALINA_OPTS=&quot;-server -Xms528m -Xmx528m -XX:PermSize=256m -XX:MaxPermSize=358m&quot;
export CATALINA_OPTS
</code></pre></li>
<li>改为：<pre><code>CATALINA_OPTS=&quot;-server -DJENKINS_HOME=/root/.jenkins -Xms528m -Xmx528m -XX:PermSize=256m -XX:MaxPermSize=358m&quot;
export CATALINA_OPTS
</code></pre></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>Jenkins 各个组件配置：<ul>
<li>访问：<a href="http://192.168.0.110:8080/configure" target="_blank" rel="external">http://192.168.0.110:8080/configure</a></li>
</ul>
</li>
</ul>
<ul>
<li>其他问题<ul>
<li>如果访问的时候报这个异常：<code>java.net.UnknownHostException</code>，可以查看这篇文章：<a href="http://stackoverflow.com/questions/4969156/java-net-unknownhostexception" target="_blank" rel="external">http://stackoverflow.com/questions/4969156/java-net-unknownhostexception</a></li>
</ul>
</li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://stackoverflow.com/questions/4969156/java-net-unknownhostexception" target="_blank" rel="external">http://stackoverflow.com/questions/4969156/java-net-unknownhostexception</a></li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Jenkins-安装和配置&quot;&gt;&lt;a href=&quot;#Jenkins-安装和配置&quot; class=&quot;headerlink&quot; title=&quot;Jenkins 安装和配置&quot;&gt;&lt;/a&gt;Jenkins 安装和配置&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>Jira 安装和配置</title>
    <link href="//zeroto.tech/2017/11/22/Jira-Install-And-Settings/"/>
    <id>//zeroto.tech/2017/11/22/Jira-Install-And-Settings/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:45:12.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Jira-安装和配置"><a href="#Jira-安装和配置" class="headerlink" title="Jira 安装和配置"></a>Jira 安装和配置</h1><a id="more"></a>
<h2 id="Jira-安装"><a href="#Jira-安装" class="headerlink" title="Jira 安装"></a>Jira 安装</h2><ul>
<li>Jira 安装<ul>
<li>官网：<a href="https://www.atlassian.com/software/jira" target="_blank" rel="external">https://www.atlassian.com/software/jira</a></li>
<li>官网下载：<a href="https://www.atlassian.com/software/jira/download" target="_blank" rel="external">https://www.atlassian.com/software/jira/download</a></li>
<li>中文在线试用：<a href="http://www.jira.cn/secure/Dashboard.jspa" target="_blank" rel="external">http://www.jira.cn/secure/Dashboard.jspa</a></li>
<li>官网帮助说明：<a href="https://confluence.atlassian.com/jira/installing-jira-on-linux-191501165.html" target="_blank" rel="external">https://confluence.atlassian.com/jira/installing-jira-on-linux-191501165.html</a></li>
<li>官网中文语言包：<a href="https://translations.atlassian.com/dashboard/download?lang=zh_CN#/JIRA/6.3.6" target="_blank" rel="external">https://translations.atlassian.com/dashboard/download?lang=zh_CN#/JIRA/6.3.6</a></li>
<li>Jira 6.3.6 网盘下载：<a href="http://pan.baidu.com/s/1eRjrz5C" target="_blank" rel="external">http://pan.baidu.com/s/1eRjrz5C</a></li>
<li>Jira 6.3.6 中文语言包网盘下载：<a href="http://pan.baidu.com/s/1i3VEsC1" target="_blank" rel="external">http://pan.baidu.com/s/1i3VEsC1</a></li>
<li>环境要求：<ul>
<li>JDK 7 或更新版本；</li>
<li>Mysql</li>
</ul>
</li>
<li>我们要使用的版本：<strong>atlassian-jira-6.3.6.tar.gz</strong></li>
<li>我个人习惯 <code>/opt</code> 目录下创建一个目录 <code>setups</code> 用来存放各种软件安装包；在 <code>/usr</code> 目录下创建一个 <code>program</code> 用来存放各种解压后的软件包，下面的讲解也都是基于此习惯</li>
<li>我个人已经使用了第三方源：<code>EPEL、RepoForge</code>，如果你出现 <code>yum install XXXXX</code> 安装不成功的话，很有可能就是你没有相关源，请查看我对源设置的文章</li>
<li>解压：<code>tar zxvf atlassian-jira-6.3.6.tar.gz</code></li>
<li>修改目录名：<code>mv atlassian-jira-6.3.6/ jira6.3.6/</code></li>
<li>移到我个人的安装目录下：<code>mv jira6.3.6/ /usr/program/</code></li>
<li>创建存放数据目录：<code>mkdir -p /usr/program/jira6.3.6/data/</code></li>
<li>设置环境变量：<ul>
<li>编辑：<code>vim /etc/profile</code></li>
<li>在文件尾部添加：<pre><code class="ini">JIRA_HOME=/usr/program/jira6.3.6/data/
export JIRA_HOME
</code></pre>
</li>
<li>刷新配置：<code>source /etc/profile</code></li>
</ul>
</li>
<li>运行：<code>/usr/program/jira6.3.6/bin/start-jira.sh</code></li>
<li>访问：<code>http://192.168.0.111:8080/</code></li>
<li>汉化：<code>cp JIRA-6.3.6-language-pack-zh_CN.jar /usr/program/jira6.3.6/atlassian-jira/WEB-INF/lib/</code></li>
<li>配置过程：<ul>
<li><img src="images/Jira-Install-And-Settings-a-1.jpg" alt="Jira 安装和配置"></li>
<li><img src="images/Jira-Install-And-Settings-a-2.jpg" alt="Jira 安装和配置"></li>
<li><img src="images/Jira-Install-And-Settings-a-3.jpg" alt="Jira 安装和配置"></li>
<li><img src="images/Jira-Install-And-Settings-a-4.jpg" alt="Jira 安装和配置"></li>
<li><img src="images/Jira-Install-And-Settings-a-5.jpg" alt="Jira 安装和配置"></li>
<li><img src="images/Jira-Install-And-Settings-a-6.jpg" alt="Jira 安装和配置"></li>
</ul>
</li>
<li>重新激活页面地址：<code>http://192.168.0.111:8090/secure/admin/ViewLicense.jspa</code></li>
</ul>
</li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Jira-安装和配置&quot;&gt;&lt;a href=&quot;#Jira-安装和配置&quot; class=&quot;headerlink&quot; title=&quot;Jira 安装和配置&quot;&gt;&lt;/a&gt;Jira 安装和配置&lt;/h1&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title>iptables</title>
    <link href="//zeroto.tech/2017/11/22/Iptables/"/>
    <id>//zeroto.tech/2017/11/22/Iptables/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2018-08-02T06:19:19.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Iptables-介绍"><a href="#Iptables-介绍" class="headerlink" title="Iptables 介绍"></a>Iptables 介绍</h1><h2 id="前提说明"><a href="#前提说明" class="headerlink" title="前提说明"></a>前提说明</h2><p>iptables 的设置在 CentOS 和 Ubuntu 下有些细节不一样，Ubuntu 这里不讲，文章底下贴的资料有部分关于 Ubuntu 的，有需要的可以自己看。一般大家会用到 iptables 都是服务器，而一般服务器大家普遍是用 CentOS）</p>
<a id="more"></a>
<h2 id="Iptables-安装"><a href="#Iptables-安装" class="headerlink" title="Iptables 安装"></a>Iptables 安装</h2><ul>
<li><p>查看是否已安装：</p>
<ul>
<li>CentOS：<code>rpm -qa | grep iptables</code></li>
</ul>
</li>
<li><p>安装（一般系统是集成的）：</p>
<ul>
<li>CentOS 6：<code>sudo yum install -y iptables</code></li>
</ul>
</li>
</ul>
<h2 id="Iptables-服务器配置文件常用参数"><a href="#Iptables-服务器配置文件常用参数" class="headerlink" title="Iptables 服务器配置文件常用参数"></a>Iptables 服务器配置文件常用参数</h2><ul>
<li>常用命令：<ul>
<li>查看已有规则列表，并且显示编号：<code>sudo iptables -L -n --line-numbers</code></li>
<li><img src="images/Iptables-a-1.png" alt="Iptables 服务器配置文件常用参数"></li>
<li>要删除 INPUT 里序号为 x 的规则，执行：<code>sudo iptables -D INPUT x</code> </li>
<li>保存配置命令：<code>sudo service iptables save 或者 sudo /etc/rc.d/init.d/iptables save</code></li>
<li>重启服务命令 ：<code>sudo service iptables restart</code></li>
<li>查看服务状态： <code>sudo service iptables status</code></li>
<li>设置开启默认启动： <code>sudo chkconfig --level 345 iptables on</code></li>
<li>清除所有规则(慎用)<ul>
<li><code>sudo iptables -F</code></li>
<li><code>sudo iptables -X</code></li>
<li><code>sudo iptables -Z</code></li>
</ul>
</li>
<li>添加规则：格式 <code>sudo iptables [-AI 链名] [-io 网络接口] [-p 协议] [-s 来源IP/网域] [-d 目标IP/网域] -j [ACCEPT|DROP|REJECT|LOG]</code></li>
<li>选项与参数：<ul>
<li>-AI 链名：针对某的链进行规则的 “插入” 或 “累加”<ul>
<li>-A ：新增加一条规则，该规则增加在原本规则的最后面。例如原本已经有四条规则，使用 -A 就可以加上第五条规则！</li>
<li>-I ：插入一条规则。如果没有指定此规则的顺序，默认是插入变成第一条规则。例如原本有四条规则，使用 -I 则该规则变成第一条，而原本四条变成 2~5 号链 ：有 INPUT, OUTPUT, FORWARD 等，此链名称又与 -io 有关，请看底下。</li>
</ul>
</li>
<li>-io 网络接口：设定封包进出的接口规范<ul>
<li>-i ：封包所进入的那个网络接口，例如 eth0, lo 等接口。需与 INPUT 链配合；</li>
<li>-o ：封包所传出的那个网络接口，需与 OUTPUT 链配合；</li>
</ul>
</li>
<li>-p 协定：设定此规则适用于哪种封包格式。主要的封包格式有： tcp, udp, icmp 及 all 。</li>
<li>-s 来源 IP/网域：设定此规则之封包的来源项目，可指定单纯的 IP 或包括网域，例如：IP：192.168.0.100，网域：192.168.0.0/24, 192.168.0.0/255.255.255.0 均可。若规范为『不许』时，则加上 ! 即可，例如：-s ! 192.168.100.0/24 表示不许 192.168.100.0/24 之封包来源。</li>
<li>-d 目标 IP/网域：同 -s ，只不过这里指的是目标的 IP 或网域。</li>
<li>-j ：后面接动作，主要的动作有接受(ACCEPT)、丢弃(DROP)、拒绝(REJECT)及记录(LOG)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Iptables-例子"><a href="#Iptables-例子" class="headerlink" title="Iptables 例子"></a>Iptables 例子</h2><ul>
<li>开放指定端口<ul>
<li><code>sudo iptables -I INPUT -i lo -j ACCEPT</code> #允许本地回环接口(即运行本机访问本机)</li>
<li><code>sudo iptables -I INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</code> # 允许已建立的或相关连的通行</li>
<li><code>sudo iptables -I OUTPUT -j ACCEPT</code> #允许所有本机向外的访问</li>
<li><code>sudo iptables -A INPUT -p tcp -m tcp --dport 22 -j ACCEPT</code> # 允许访问 22 端口</li>
<li><code>sudo iptables -A INPUT -p tcp -m tcp --dport 80 -j ACCEPT</code> #允许访问 80 端口</li>
<li><code>sudo iptables -A INPUT -p tcp -m tcp --dport 8080 -j ACCEPT</code> #允许访问 8080 端口</li>
<li><code>sudo iptables -A INPUT -p tcp -m tcp --dport 21 -j ACCEPT</code> #允许 FTP 服务的 21 端口</li>
<li><code>sudo iptables -A INPUT -p tcp -m tcp --dport 20 -j ACCEPT</code> #允许 FTP 服务的 20 端口</li>
<li><code>sudo iptables -I INPUT -p icmp -m icmp --icmp-type 8 -j ACCEPT</code> #允许 ping</li>
<li><code>sudo iptables -I INPUT -j REJECT</code>  #禁止其他未允许的规则访问（使用该规则前一定要保证 22 端口是开着，不然就连 SSH 都会连不上）</li>
<li><code>sudo iptables -I FORWARD -j REJECT</code></li>
</ul>
</li>
</ul>
<h2 id="Iptables-资料"><a href="#Iptables-资料" class="headerlink" title="Iptables 资料"></a>Iptables 资料</h2><ul>
<li><a href="https://wsgzao.github.io/post/iptables/" target="_blank" rel="external">https://wsgzao.github.io/post/iptables/</a> </li>
<li><a href="http://www.vpser.net/security/linux-iptables.html" target="_blank" rel="external">http://www.vpser.net/security/linux-iptables.html</a> </li>
</ul>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="external">judasn</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Iptables-介绍&quot;&gt;&lt;a href=&quot;#Iptables-介绍&quot; class=&quot;headerlink&quot; title=&quot;Iptables 介绍&quot;&gt;&lt;/a&gt;Iptables 介绍&lt;/h1&gt;&lt;h2 id=&quot;前提说明&quot;&gt;&lt;a href=&quot;#前提说明&quot; class=&quot;headerlink&quot; title=&quot;前提说明&quot;&gt;&lt;/a&gt;前提说明&lt;/h2&gt;&lt;p&gt;iptables 的设置在 CentOS 和 Ubuntu 下有些细节不一样，Ubuntu 这里不讲，文章底下贴的资料有部分关于 Ubuntu 的，有需要的可以自己看。一般大家会用到 iptables 都是服务器，而一般服务器大家普遍是用 CentOS）&lt;/p&gt;
    
    </summary>
    
    
      <category term="Java 程序员眼中的 Linux" scheme="//zeroto.tech/tags/Java-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9C%BC%E4%B8%AD%E7%9A%84-Linux/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="//zeroto.tech/2017/11/22/centos-settings/Cpu-Info/"/>
    <id>//zeroto.tech/2017/11/22/centos-settings/Cpu-Info/</id>
    <published>2017-11-22T09:32:19.000Z</published>
    <updated>2017-11-22T09:32:19.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="CPU-信息分析"><a href="#CPU-信息分析" class="headerlink" title="CPU 信息分析"></a>CPU 信息分析</h2><h2 id="初衷"><a href="#初衷" class="headerlink" title="初衷"></a>初衷</h2><ul>
<li>了解服务器的性能，以方便我们如何更好地对程序进行部署</li>
</ul>
<h2 id="CPU-信息"><a href="#CPU-信息" class="headerlink" title="CPU 信息"></a>CPU 信息</h2><ul>
<li>Demo CPU 型号：<a href="http://ark.intel.com/products/75789/Intel-Xeon-Processor-E5-2620-v2-15M-Cache-2_10-GHz" target="_blank" rel="external">Intel® Xeon® Processor E5-2620 v2(15M Cache, 2.10 GHz)</a></li>
<li>该 CPU 显示的数据中有一项这个要注意：<code>Intel® Hyper-Threading Technology</code> 是 <code>Yes</code>。表示该 CPU 支持超线程</li>
<li><code>cat /proc/cpuinfo</code>，查看 CPU 总体信息</li>
<li><code>grep &#39;physical id&#39; /proc/cpuinfo | sort -u | wc -l</code>，查看物理 CPU 个数<ul>
<li>结果：2</li>
<li>物理 CPU：物理 CPU 也就是机器外面就能看到的一个个 CPU，每个物理 CPU 还带有单独的风扇</li>
</ul>
</li>
<li><code>grep &#39;core id&#39; /proc/cpuinfo | sort -u | wc -l</code>，查看每个物理 CPU 的核心数量<ul>
<li>结果：6，因为每个物理 CPU 是 6，所有 2 个物理 CPU 的总核心数量应该是：12</li>
<li>核心数：一个核心就是一个物理线程，英特尔有个超线程技术可以把一个物理线程模拟出两个线程来用，充分发挥 CPU 性能，意思是一个核心可以有多个线程。</li>
</ul>
</li>
<li><code>grep &#39;processor&#39; /proc/cpuinfo | sort -u | wc -l</code>，查看 CPU 总的线程数，一般也叫做：逻辑 CPU 数量<ul>
<li>结果：24，正常情况下：CPU 的总核心数量 == CPU 线程数，但是如果该 CPU 支持超线程，那结果是：CPU 的总核心数量 X 2 == CPU 线程数</li>
<li>线程数：线程数是一种逻辑的概念，简单地说，就是模拟出的 CPU 核心数。比如，可以通过一个 CPU 核心数模拟出 2 线程的 CPU，也就是说，这个单核心的 CPU 被模拟成了一个类似双核心 CPU 的功能。</li>
</ul>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;CPU-信息分析&quot;&gt;&lt;a href=&quot;#CPU-信息分析&quot; class=&quot;headerlink&quot; title=&quot;CPU 信息分析&quot;&gt;&lt;/a&gt;CPU 信息分析&lt;/h2&gt;&lt;h2 id=&quot;初衷&quot;&gt;&lt;a href=&quot;#初衷&quot; class=&quot;headerlink&quot; titl
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>深入理解Java虚拟机-学习</title>
    <link href="//zeroto.tech/2017/11/17/jvm-tool/"/>
    <id>//zeroto.tech/2017/11/17/jvm-tool/</id>
    <published>2017-11-17T06:52:55.000Z</published>
    <updated>2018-03-12T03:42:38.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="jvm调优工具"><a href="#jvm调优工具" class="headerlink" title="jvm调优工具"></a>jvm调优工具</h1><h2 id="jdk的命令行工具"><a href="#jdk的命令行工具" class="headerlink" title="jdk的命令行工具"></a>jdk的命令行工具</h2><ol>
<li>jps：虚拟机进程状况工具（jps -l）</li>
<li>jstat：虚拟机统计信息监视工具（jstat -gcutil VMID，stat -gccapacity VMID）  （Local Virtual Machine Identifier,LVMID）  </li>
<li>jinfo：Java配置信息工具<ul>
<li>jinfo -flag +PrintGCDetails VMID</li>
<li>jinfo -flag +PrintGC VMID</li>
<li>jinfo -flag +PrintGCTimeStamps VMID<br>以上就可以在一个正在运行的JVM中动态开启GC日志功能。</li>
</ul>
</li>
<li>jmap：Java内存映像工具<ul>
<li>jmap -heap VMID 显示Java堆详细信息，例如使用哪种回收器、参数配置、分代状况等。</li>
</ul>
</li>
<li>jhat：虚拟机堆转储快照分析工具</li>
<li>jstack：Java堆栈跟踪工具<ul>
<li>jstack -l VMID</li>
</ul>
</li>
</ol>
<a id="more"></a>
<h2 id="jdk的可视化工具"><a href="#jdk的可视化工具" class="headerlink" title="jdk的可视化工具"></a>jdk的可视化工具</h2><h3 id="jconsole"><a href="#jconsole" class="headerlink" title="jconsole"></a>jconsole</h3><p>JDK中自带的java监控和管理控制台，用于对JVM中内存，线程和类等的监控，是一个基于JMX（java management extensions）的GUI性能监测工具。<br><img src="Java监视和管理控制台-启动.png" alt="Java监视和管理控制台-启动"><br><img src="Java监视和管理控制台.png" alt="内存"></p>
<h3 id="VisualVM"><a href="#VisualVM" class="headerlink" title="VisualVM"></a>VisualVM</h3><p>VisualVM（All-in-One Java Troubleshooting Tool）强大的运行监视和故障处理程序，也能够进行性能分析，CPU、内存，在Profiler页签中能看到。<br>1.插件安装<br><img src="VisualVM插件1.png" alt="VisualVM插件1"><br><img src="VisualVM插件2.png" alt="VisualVM插件2"><br><img src="VisualVM插件3.png" alt="VisualVM插件3"></p>
<p>2.主界面<br><img src="VisualVM概述.png" alt="VisualVM概述"><br><img src="VisualVM监视.png" alt="VisualVM监视"></p>
<p>因为VisualVM的插件太多，重点展示下Visual GC：<br><img src="VisualVM-Visual GC.png" alt="VisualVM-Visual GC"></p>
<h2 id="第三方调优工具"><a href="#第三方调优工具" class="headerlink" title="第三方调优工具"></a>第三方调优工具</h2><blockquote>
<ul>
<li>MAT(Memory Analyzer Tool)</li>
<li><a href="http://gceasy.io" target="_blank" rel="external">GC Easy</a></li>
</ul>
</blockquote>
<p>MAT以eclipse插件形式安装,利用visualvm或者是 jmap命令生产堆文件，导入eclipse mat中生成分析报告：</p>
<p><img src="Memory Analyzer.png" alt="Memory Analyzer Tool"><br><img src="Memory Analyzer-Overview.png" alt="Memory Analyzer-Overview"><br><img src="Top Consumers.png" alt="Top Consumers"></p>
<p>参考在此：<br>深入理解Java虚拟机 第2版<br><a href="http://www.ityouknow.com/java/2017/02/22/jvm-tool.html" target="_blank" rel="external">jvm调优-工具篇</a> 作者：纯洁的微笑</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;jvm调优工具&quot;&gt;&lt;a href=&quot;#jvm调优工具&quot; class=&quot;headerlink&quot; title=&quot;jvm调优工具&quot;&gt;&lt;/a&gt;jvm调优工具&lt;/h1&gt;&lt;h2 id=&quot;jdk的命令行工具&quot;&gt;&lt;a href=&quot;#jdk的命令行工具&quot; class=&quot;headerlink&quot; title=&quot;jdk的命令行工具&quot;&gt;&lt;/a&gt;jdk的命令行工具&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;jps：虚拟机进程状况工具（jps -l）&lt;/li&gt;
&lt;li&gt;jstat：虚拟机统计信息监视工具（jstat -gcutil VMID，stat -gccapacity VMID）  （Local Virtual Machine Identifier,LVMID）  &lt;/li&gt;
&lt;li&gt;jinfo：Java配置信息工具&lt;ul&gt;
&lt;li&gt;jinfo -flag +PrintGCDetails VMID&lt;/li&gt;
&lt;li&gt;jinfo -flag +PrintGC VMID&lt;/li&gt;
&lt;li&gt;jinfo -flag +PrintGCTimeStamps VMID&lt;br&gt;以上就可以在一个正在运行的JVM中动态开启GC日志功能。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;jmap：Java内存映像工具&lt;ul&gt;
&lt;li&gt;jmap -heap VMID 显示Java堆详细信息，例如使用哪种回收器、参数配置、分代状况等。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;jhat：虚拟机堆转储快照分析工具&lt;/li&gt;
&lt;li&gt;jstack：Java堆栈跟踪工具&lt;ul&gt;
&lt;li&gt;jstack -l VMID&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
    
      <category term="JVM" scheme="//zeroto.tech/tags/JVM/"/>
    
  </entry>
  
  <entry>
    <title>Java内存模型之happens-before</title>
    <link href="//zeroto.tech/2017/11/03/happens-before/"/>
    <id>//zeroto.tech/2017/11/03/happens-before/</id>
    <published>2017-11-03T05:28:14.000Z</published>
    <updated>2018-03-12T03:42:43.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Java内存模型之happens-before"><a href="#Java内存模型之happens-before" class="headerlink" title="Java内存模型之happens-before"></a>Java内存模型之happens-before</h1><p>从JDK 5 开始，JMM就使用happens-before(先行发生原则)的概念来阐述多线程之间的内存可见性。</p>
<p><strong>在JMM中，如果一个操作执行的结果需要对另一个操作可见，那么这两个操作之间必须存在happens-before关系。</strong></p>
<p>happens-before原则定义如下：</p>
<a id="more"></a>
<p><strong>1. 如果一个操作happens-before另一个操作，那么第一个操作的执行结果将对第二个操作可见，而且第一个操作的执行顺序排在第二个操作之前。</strong><br><strong>2. 两个操作之间存在happens-before关系，并不意味着一定要按照happens-before原则制定的顺序来执行。如果重排序之后的执行结果与按照happens-before关系来执行的结果一致，那么这种重排序并不非法。</strong></p>
<p>下面是Java内存模型下一些“天然的“先行发生关系，可以再编码中直接使用。如果两个操作之间的关系不在此列，并且无法从下列规则推导出来的话，虚拟机可以对它们随意地进行重排序。</p>
<p>（摘自《深入理解Java虚拟机第12章》）：</p>
<ul>
<li>程序次序规则（Program Order Rule）：在一个线程内，按照程序代码顺序，书写在前面的操作先行发生于书写在后面的操作。准确地说，应该是控制流顺序而不是程序代码顺序，因为要考虑分支、循环等结构。</li>
<li>锁定规则（Monitor Lock Rule）：一个unlock操作先行发生与后面同一个锁的lock操作。这里必须强调的是同一个锁，而”后面“是指时间上的先后顺序。</li>
<li>volatile变量规则（Volatile Variable Rule）：这是一条比较重要的规则，它标志着volatile保证了线程可见性。通俗点讲就是如果一个线程先去写一个volatile变量，然后一个线程去读这个变量，那么这个写操作一定是happens-before读操作的。</li>
<li>线程启动规则（Thread Start Rule）：Thread 对象的start()方法先行发生与此线程的每一个动作。</li>
<li>线程终止规则（Thread Termination Rule）：线程中的所有操作都先行发生与对此线程的终止检测，我们可以通过Thread.join()方法结束、Thread.isAlive()的返回值等手段检测到线程已经终止执行。</li>
<li>线程中断原则（Thread Interruption Rule）：对线程interrupt()方法的调用先行发生于被中断线程的代码检测到中断事件的发生，可以通过Thread.interrupted()方法检测到是否有中段发生。</li>
<li>对象终结规则（Finalizer Rule）：一个对象的初始化完成（构造函数执行结束）先行发生与它的finalize()方法的开始。</li>
<li>传递性（Transitivity）：如果操作A先行发生与操作B，操作B先行发生于操作C，那就可以得出操作A先行发生于操作C的结论。</li>
</ul>
<p>上面八条是原生Java满足Happens-before关系的规则，但是我们可以对他们进行推导出其他满足happens-before的规则：</p>
<ol>
<li>将一个元素放入一个线程安全的队列的操作Happens-Before从队列中取出这个元素的操作</li>
<li>将一个元素放入一个线程安全容器的操作Happens-Before从容器中取出这个元素的操作</li>
<li>在CountDownLatch上的倒数操作Happens-Before CountDownLatch#await()操作</li>
<li>释放Semaphore许可的操作Happens-Before获得许可操作</li>
<li>Future表示的任务的所有操作Happens-Before Future#get()操作</li>
<li>向Executor提交一个Runnable或Callable的操作Happens-Before任务开始执行操作</li>
</ol>
<p>参考在此：<br>    深入理解Java虚拟机：JVM高级特性与最佳实践（最新第二版）周志明 著</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Java内存模型之happens-before&quot;&gt;&lt;a href=&quot;#Java内存模型之happens-before&quot; class=&quot;headerlink&quot; title=&quot;Java内存模型之happens-before&quot;&gt;&lt;/a&gt;Java内存模型之happens-before&lt;/h1&gt;&lt;p&gt;从JDK 5 开始，JMM就使用happens-before(先行发生原则)的概念来阐述多线程之间的内存可见性。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;在JMM中，如果一个操作执行的结果需要对另一个操作可见，那么这两个操作之间必须存在happens-before关系。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;happens-before原则定义如下：&lt;/p&gt;
    
    </summary>
    
    
      <category term="Java" scheme="//zeroto.tech/tags/Java/"/>
    
      <category term="Java内存模型" scheme="//zeroto.tech/tags/Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/"/>
    
  </entry>
  
  <entry>
    <title>Java内存模型看并发（一）</title>
    <link href="//zeroto.tech/2017/11/01/JVM-1/"/>
    <id>//zeroto.tech/2017/11/01/JVM-1/</id>
    <published>2017-11-01T06:49:18.000Z</published>
    <updated>2018-06-06T07:25:30.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Java内存模型"><a href="#Java内存模型" class="headerlink" title="Java内存模型"></a>Java内存模型</h1><p>所有的Java开发人员可能会遇到这样的困惑？我该为堆内存设置多大空间呢？OutOfMemoryError的异常到底涉及到运行时数据的哪块区域？该怎么解决呢？</p>
<a id="more"></a>
<p>对象和类的数据存储在3个不同的内存区域：堆（heap space）、方法区（method area）、本地区（native area）。</p>
<p>堆内存存放对象以及数组的数据，方法区存放类的信息（包括类名、方法、字段）、静态变量、编译器编译后的代码，本地区包含线程栈、本地方法栈等存放线程</p>
<p><img src="/assets/blogImg/JUtH_20121024_RuntimeDataAreas_1_MemoryModel-1.png" alt="RuntimeDataAreas_1_MemoryModel-1"></p>
<p>方法区有时被称为持久代（PermGen）。</p>
<p><img src="/assets/blogImg/JUtH_20121024_RuntimeDataAreas_2_MemoryModel-1.png" alt="RuntimeDataAreas_2_MemoryModel-1"></p>
<p>所有的对象在实例化后的整个运行周期内，都被存放在堆内存中。堆内存又被划分成不同的部分：伊甸区(Eden)，幸存者区域(Survivor Sapce)，老年代（Old Generation Space）。</p>
<p>方法的执行都是伴随着线程的。原始类型的本地变量以及引用都存放在线程栈中。而引用关联的对象比如String，都存在在堆中。</p>
<h2 id="你真的会写单例吗"><a href="#你真的会写单例吗" class="headerlink" title="你真的会写单例吗"></a>你真的会写单例吗</h2><pre><code class="java">/**   
 * 漫画：什么是单例模式？见：https://mp.weixin.qq.com/s/pAYYcvh4IRvLs5WYgiPe3A
 * https://blankj.com/2016/04/21/really-use-singleton/
 * @ClassName: Singleton.java
 * @Description: 单例模式实现方式&lt;br&gt;
 * 1、双重锁检测&lt;br&gt;
 * 2、静态内部类&lt;br&gt;
 * 3、饿汉式
 *
 * @author: zhangjk
 * @date: 2018年3月7日 下午2:05:53 
 */
public class Singleton {

    //一、双检查锁（DCL，即 double-checked locking）
    //描述：这种方式称为双重检查锁(Double-Check Locking)，需要注意的是，如果使用双重检查锁定来实现懒汉式单例类
//    private Singleton() {}
//    private volatile static Singleton instance = null; //单例对象;volatile 修饰符阻止了变量访问前后的指令重排序，保证了指令执行顺序。
//    public static Singleton getInstance() {
//        if (instance == null) {
//            synchronized (Singleton.class) {
//                if(instance == null) {
//                    instance = new Singleton();
//                }
//            }
//        }
//        return instance;
//    }


    // 二、用静态内部类实现单例模式：
    // 1.从外部无法访问静态内部类LazyHolder，只有当调用Singleton.getInstance方法的时候，才能得到单例对象INSTANCE。
    // 2.INSTANCE对象初始化的时机并不是在单例类Singleton被加载的时候，而是在调用getInstance方法，使得静态内部类LazyHolder被加载的时候。
    //描述：饿汉式单例类不能实现延迟加载，不管将来用不用始终占据内存；懒汉式单例类线程安全控制繁琐，而且性能受影响。
//    private static class LazyHolder {
//        private static final Singleton INSTANCE = new Singleton();
//    }
//    
//    private Singleton() {}
//    public static Singleton getInstance() {
//        return LazyHolder.INSTANCE;
//    }

    //三、饿汉式
    //优点：没有加锁，执行效率会提高。
    //缺点：类加载时就初始化，浪费内存。
    private static Singleton instance = new Singleton();
    private Singleton() {}
    public static Singleton getIntance() {
        return instance;
    }

}
</code></pre>
<h2 id="并发工具类"><a href="#并发工具类" class="headerlink" title="并发工具类"></a>并发工具类</h2><p>CountDownLatch和CyclicBarrier是jdk concurrent包下非常有用的两个并发工具类，它们提供了一种控制并发流程的手段。</p>
<p>CountDownLatch 允许一个或多个线程等待其他线程完成操作。<br>CyclicBarrier 让一组线程到达一个同步点后再一起继续运行，在其中任意一个线程未达到同步点，其他到达的线程均会被阻塞。</p>
<h3 id="Semaphore（信号量）"><a href="#Semaphore（信号量）" class="headerlink" title="Semaphore（信号量）"></a>Semaphore（信号量）</h3><p>信号量(Semaphore)，有时被称为信号灯，是在多线程环境下使用的一种设施, 它负责协调各个线程, 以保证它们能够正确、合理的使用公共资源。</p>
<p>一个计数信号量。从概念上讲，信号量维护了一个许可集。如有必要，在许可可用前会阻塞每一个 acquire()，然后再获取该许可。<br>每个 release() 添加一个许可，从而可能释放一个正在阻塞的获取者。但是，不使用实际的许可对象，Semaphore 只对可用许可的号码进行计数，并采取相应的行动。拿到信号量的线程可以进入代码，否则就等待。通过acquire()和release()获取和释放访问许可。</p>
<pre><code class="java">/**
 * 控制并发线程数
 */
public class SemaphoreDemo {

    /**
     *执行任务类，获取信号量
     */
    class SemaphoreRunnable implements Runnable{
        private Semaphore semaphore;
        private int user;

        public SemaphoreRunnable(Semaphore semaphore, int user) {
            this.semaphore = semaphore;
            this.user = user;
        }

        @Override
        public void run() {
            try {
                //获取信号量许可
                semaphore.acquire();
                System.out.println(&quot;用户【&quot; + user + &quot;】进入窗口，准备买票...&quot;);
                Thread.sleep((long)(Math.random()*10000));
                System.out.println(&quot;用户【&quot; + user + &quot;】买票完成，即将离开...&quot;);
                Thread.sleep((long)(Math.random()*10000));
                System.out.println(&quot;用户【&quot; + user + &quot;】离开售票窗口...&quot;);
                //释放信号量许可
                semaphore.release();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }

    }

    private void execute(){
        //定义窗口个数
        final Semaphore semaphore = new Semaphore(3);
        //线程池
        ExecutorService threadPool = Executors.newCachedThreadPool();

        for (int i = 0; i &lt; 10; i++) {
            threadPool.execute(new SemaphoreRunnable(semaphore,i + 1));
        }
        threadPool.shutdown();
    }

    public static void main(String[] args) {
        SemaphoreDemo semaphoreDemo = new SemaphoreDemo();
        semaphoreDemo.execute();
    }

}
</code></pre>
<h3 id="CountDownLatch"><a href="#CountDownLatch" class="headerlink" title="CountDownLatch"></a>CountDownLatch</h3><p>源码注释：<br>A synchronization aid that allows one or more threads to wait until a set of operations being performed in other threads completes.<br>（一个或者多个线程，等待其他多个线程完成某件事情之后才能执行）</p>
<blockquote>
<ul>
<li>CountDownLatch声明： </li>
<li>CountDownLatch的构造函数接受int型参数作为它的计数器，如果想等待N个点完成，就传入N；</li>
<li>调用CountDownLatch的countDown方法时，N会减1，CountDownLatch的await方法会阻塞主线程直到N减少到0。</li>
</ul>
</blockquote>
<p>网上有个经典例子，在此抄录一下帮助理解记忆。</p>
<pre><code class="java">/**
 * F1赛车每次进站后，车队技师都需要在尽可能短的时间内对赛车做三个工作：加注燃油、更换轮胎、更换刹车片。
 * 当然，这三项工作都是同时进行的。只有当这三项工作完成，赛车才能驶出维修站。
 */
public class CountdownlatchDemo {

    static class Mechanician implements Runnable{
        String work;
        CountDownLatch cDownLatch ;
        public Mechanician(String work,CountDownLatch cDownLatch) {
            this.work = work;
            this.cDownLatch = cDownLatch;
        }
        @Override
        public void run() {
            try {
                int random=new Random().nextInt(7);
                TimeUnit.SECONDS.sleep(random);
                System.out.println(Thread.currentThread().getName()+&quot;--- &quot;+work+&quot; 完成，此组耗时：&quot;+random+&quot;秒&quot;);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }finally{
                /*当前技师的任务完成,cDownLatch计算器减1
                 *通常countDown放在finally里中使用*/
                cDownLatch.countDown();
            }
        }
    }


    public static void main(String[] args) {
        CountDownLatch cDownLatch=new CountDownLatch(3);//初始计数器值为3，对应3个维修组
         /*1、赛车进站*/
        System.out.println(&quot;F1赛车进站，时间：&quot;+Calendar.getInstance().get(Calendar.SECOND));

        List&lt;Mechanician&gt; mechanician_team=new ArrayList&lt;Mechanician&gt;();
        mechanician_team.add(new Mechanician(&quot;加注燃油&quot;, cDownLatch));
        mechanician_team.add(new Mechanician(&quot;更换轮胎&quot;, cDownLatch));
        mechanician_team.add(new Mechanician(&quot;更换刹车片&quot;, cDownLatch));
        for(Mechanician mechanician : mechanician_team){
            new Thread(mechanician).start();
        }
        /*3、等待技师完成三项工作。实际就是等待cDownLatch计数器变成0*/
        try {
            cDownLatch.await();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        /*4、完成维护，出发*/
        System.out.println(&quot;F1赛车维修完毕，出发！时间：&quot;+Calendar.getInstance().get(Calendar.SECOND));

    }

}
</code></pre>
<p>Countdownlatch 是一个倒计数器锁。调用CountDownLatch对象的await()方法使线程处于等待状态，调用countDown()方法的线程会将计数器减1，当计数到达0时，所有等待线程（可多个，但通常的应用场景中只有一个等待者）开始继续执行。</p>
<h3 id="CyclicBarrier"><a href="#CyclicBarrier" class="headerlink" title="CyclicBarrier"></a>CyclicBarrier</h3><p>源码注释：<br>A synchronization aid that allows a set of threads to all wait for each other to reach a common barrier point.（多个线程互相等待，直到到达同一个同步点，再继续一起执行）</p>
<blockquote>
<ul>
<li>CyclicBarrier(int parties) 默认构造方法，参数表示拦截的线程数量。</li>
<li>CyclicBarrier(int parties, Runnable barrierAction)<br>由于线程之前的调度是由CPU决定的，所以默认的构造方法无法设置线程执行优先级，CyclicBarrier提供一个更高级的构造函数(int parties, Runnable barrierAction)，用于在线程到达同步点时，优先执行线程barrierAction，这样可以更加方便的处理一些复杂的业务场景。</li>
<li>创建CyclicBarrier后，每个线程调用await方法告诉CyclicBarrier自己已经到达同步点，然后当前线程被阻塞。</li>
</ul>
</blockquote>
<h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>在Java语言内部，java.lang.Runtime对象就是一个使用单例模式的例子。在每一个Java应用程序里面，都有唯一的一个Runtime对象，应用程序可以与其运行环境发生相互作用。</p>
<p>参考在此：<br>深入理解Java虚拟机 第2版（第2章 Java 内存区域与内存溢出异常）<br><a href="http://ifeve.com/under-the-hood-runtime-data-areas-javas-memory-model/" target="_blank" rel="external">JAVA的内存模型及结构</a><br><a href="https://blankj.com/2016/04/21/really-use-singleton/" target="_blank" rel="external">你真的会写单例吗</a><br><a href="http://cmsblogs.com/?p=2253" target="_blank" rel="external">J.U.C之并发工具类：CountDownLatch</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Java内存模型&quot;&gt;&lt;a href=&quot;#Java内存模型&quot; class=&quot;headerlink&quot; title=&quot;Java内存模型&quot;&gt;&lt;/a&gt;Java内存模型&lt;/h1&gt;&lt;p&gt;所有的Java开发人员可能会遇到这样的困惑？我该为堆内存设置多大空间呢？OutOfMemoryError的异常到底涉及到运行时数据的哪块区域？该怎么解决呢？&lt;/p&gt;
    
    </summary>
    
    
      <category term="J.U.C" scheme="//zeroto.tech/tags/J-U-C/"/>
    
      <category term="单例" scheme="//zeroto.tech/tags/%E5%8D%95%E4%BE%8B/"/>
    
  </entry>
  
  <entry>
    <title>poi实现Excel文件导入、导出</title>
    <link href="//zeroto.tech/2017/10/23/Excel-poi-how/"/>
    <id>//zeroto.tech/2017/10/23/Excel-poi-how/</id>
    <published>2017-10-23T02:33:07.000Z</published>
    <updated>2018-03-12T06:40:17.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="poi-是什么呢"><a href="#poi-是什么呢" class="headerlink" title="poi 是什么呢"></a>poi 是什么呢</h1><p>Apache POI 简介是用Java编写的免费开源的跨平台的 Java API，Apache POI提供API给Java程式对Microsoft Office（Excel、WORD、PowerPoint、Visio等）格式档案读和写的功能。POI为“Poor Obfuscation Implementation”的首字母缩写，意为“可怜的模糊实现”。</p>
<a id="more"></a>
<h1 id="与我而言"><a href="#与我而言" class="headerlink" title="与我而言"></a>与我而言</h1><p>使用于某项技术，来完成特定业务是最重要的。看下图最终要实现的功能：<br>考查、考试，在对应的中期（期中）考核形式、期末考试形式 相应位置处画 √<br>必修课补考形式 唯一必填。<br>难点在于 期中考试形式、期末考试形式、必修课补考形式（考试形式字典）是动态可增减的。</p>
<p><img src="excel-poi.png" alt="考务：考试形式登记"></p>
<h2 id="归纳总结Excel工具类"><a href="#归纳总结Excel工具类" class="headerlink" title="归纳总结Excel工具类"></a>归纳总结Excel工具类</h2><pre><code class="java">
public static Map&lt;String,String&gt;  getExcelHeaderString(String filePath) {
//        You&#39;d use HSSF if you needed to read or write an Excel file using Java (XLS). 
//        You&#39;d use XSSF if you need to read or write an OOXML Excel file using Java (XLSX).         
        boolean isE2007 = false;    //判断是否是excel2007格式

        if(filePath.endsWith(&quot;xlsx&quot;)) isE2007 = true;
        //得到表头字段
        Map&lt;String, String&gt; excelHeaderMap = new LinkedHashMap&lt;String, String&gt;();
        InputStream input = null;
        Workbook wb = null;
        try {
            //建立输入流
            input = new FileInputStream(filePath);
            //根据文件格式(2003或者2007)来初始化
            if(isE2007) wb = new XSSFWorkbook(input);
            else wb = new HSSFWorkbook(input);

            Sheet sheet = wb.getSheetAt(0);     //获得第一个表单
            Row row = sheet.getRow(0);
            int columnNum = row.getLastCellNum();

            for (short i = 0; i &lt; columnNum; i++) {
                Cell cell = row.getCell(i);
                String HeaderString = cell.getRichStringCellValue().getString().trim();
                excelHeaderMap.put(HeaderString,HeaderString);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }finally{
            try {
                if(null != wb){
                    input.close();
                    wb.close();
                }
            } catch (IOException e) {
            }
        }
        return excelHeaderMap;
    }


    public static List&lt;Map&lt;String,Object&gt;&gt; getBeanList(String filePath) throws IOException{
        return getBeanList(filePath, null);
    }
    /**
     * 解析excel 数据，每一行存为一个map， key为每列首行对应的文字
     */
    public static List&lt;Map&lt;String,Object&gt;&gt; getBeanList(String filePath, Map&lt;String, String&gt; matchingResultMap) throws IOException{
        List&lt;Map&lt;String,Object&gt;&gt; beanList = new ArrayList&lt;Map&lt;String,Object&gt;&gt;();

        boolean isE2007 = false;    //判断是否是excel2007格式

        if(filePath.endsWith(&quot;xlsx&quot;)) isE2007 = true;
        InputStream input = null;
        Workbook wb = null;
        try {
            //建立输入流
            input = new FileInputStream(filePath);
            //根据文件格式(2003或者2007)来初始化
            if(isE2007) wb = new XSSFWorkbook(input);
            else wb = new HSSFWorkbook(input);

            Sheet sheet = wb.getSheetAt(0);
            Map&lt;Short, String&gt; excelHeaderMap = new HashMap&lt;Short, String&gt;();
            int firstRowNum = sheet.getFirstRowNum();
            Row row = sheet.getRow(firstRowNum);
            int columnNum = row.getLastCellNum();
            for (short i = 0; i &lt; columnNum; i++) {
                Cell cell = row.getCell(i);
                String HeaderString = cell.getRichStringCellValue().getString().trim();
                excelHeaderMap.put(i,HeaderString);
            }
            int rowNum = sheet.getPhysicalNumberOfRows();// 获取第0个sheet的行的数量(1...n)

            for (int i = firstRowNum+1; i &lt; rowNum; i++) {
                Row xRow = sheet.getRow(i);
                Map&lt;String,Object&gt; beanMap = new LinkedHashMap&lt;String, Object&gt;();
                for(short j=0; j &lt; columnNum; j++ ){
                    String headerKey = null;
                    if ( matchingResultMap == null
                            || matchingResultMap.get(excelHeaderMap.get(j)) == null){
                        headerKey = excelHeaderMap.get(j);
                    } else {
                        matchingResultMap.get(excelHeaderMap.get(j));
                    }
                    String headerValue = null;
                    if(null != xRow.getCell(j)){
                        headerValue = getCellContent(xRow.getCell(j)).trim();
                        if (beanMap.get(headerKey) == null){
                            beanMap.put(headerKey, headerValue);
                        }
                    }else{
                        beanMap.put(headerKey, &quot;&quot;);
                    }
                }
                if(beanMap.containsKey(null)){
                    beanMap.remove(null);
                }
                beanMap.put(&quot;row_num&quot;, i + 1);//excel中的行号
                beanList.add(beanMap);
            }
        }catch(IOException e){

        }finally{
            input.close();
            wb.close();
        }
        return beanList;
    }

    /**
     * 根据 二维数组（数据）在指定路径下生成文件
     * 
     * @param fileFullPathName 绝对文件路径（包含文件名）
     * @param fieldNames 表头字段数组
     * @param data 二维数组（数据）Object[行][列]
     * @return boolean (标识是否成功生成文件)
     * @author zhangjinkui
     */
    public static boolean writeFile(String fileFullPathName,String[] fieldNames,Object[][] data) {

        boolean flag = false;
        HSSFWorkbook wb = new HSSFWorkbook();
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        try {
            // 创建字体
            Font font = wb.createFont();
            // 创建列样式
            CellStyle cellStyle = wb.createCellStyle();

            Sheet sheet = wb.createSheet();
            Row row = sheet.createRow(0);
            int colLength = fieldNames.length;
            for (int i = 0; i &lt; colLength; i++) {
                row.setHeightInPoints(25);
                sheet.setColumnWidth(i, 256*16);
                ExcelUtils.createCell(row, i, fieldNames[i],createHeadCell(wb));
            }
            int line = 0;
            for (line = 0; line &lt; data.length; line++) {
                Row rowtemp = sheet.createRow(line +1);
                for (int col = 0; col &lt; colLength; col++) {
                    createCell2(rowtemp, col,data[line][col],createCellStyle(font,cellStyle));
                }
            }
            wb.write(baos);
            File file = new File(fileFullPathName);
            FileUtils.writeByteArrayToFile(file, baos.toByteArray());    
            flag = true;
        } catch (Exception e) {
            flag = false;
        } finally {
                try {
                    baos.close();
                    wb.close();
                } catch (IOException e) {
                    e.printStackTrace();
                } 
        }
        return flag;
    }

    /**
     * 得到字节流之后，可直接写入客户端，也可写入到指定文件
     * 
     * @param sheetName sheet页名称
     * @param fieldNames 表头字段数组
     * @param data 二维数组（数据）Object[行][列]
     * @return  返回字节数组
     * @throws IOException 
     * @author zhangjinkui
     */
    public static byte[] writeExcel(String sheetName,String[] fieldNames,Object[][] data) throws IOException{
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        HSSFWorkbook wb = new HSSFWorkbook();
        try {
            // 创建字体
            Font font = wb.createFont();
            // 创建列样式
            CellStyle cellStyle = wb.createCellStyle();
            Sheet sheet = null;
            if(StringUtils.isBlank(sheetName)){
                sheet = wb.createSheet(&quot;&quot;);
            }else{
                sheet =  wb.createSheet(sheetName);
            }
            Row row = sheet.createRow(0);
            int colLength = fieldNames.length;
            for (int i = 0; i &lt; colLength; i++) {
                row.setHeightInPoints(25);
                sheet.setColumnWidth(i, 256*16);
                ExcelUtils.createCell(row, i, fieldNames[i], createHeadCell(wb));
            }
            int line = 0;
            for (line = 0; line &lt; data.length; line++) {
                Row rowtemp = sheet.createRow(line +1);
                for (int col = 0; col &lt; colLength; col++) {
                    createCell2(rowtemp, col,data[line][col],createCellStyle(font,cellStyle));
                }
            }
            wb.write(baos);
        } catch (Exception e) {
        } finally {
                try {
                    baos.close();
                    wb.close();
                } catch (IOException e) {
                    e.printStackTrace();
                } 
        }
        return baos.toByteArray();
    }

    /**
     * 合并单元格 行
     * @param sheet    
     * @param columnNum 从第几列开始（0-based）
     * @param rowStart          从第几行开始（0-based）
     * @param rowspan          跨多少行
     */
    public static void mergedRegionRow(Sheet sheet, int columnNum, int rowStart, int rowspan){
         sheet.addMergedRegion(new CellRangeAddress(
                 rowStart, //first row (0-based)
                 rowStart + rowspan-1, //last row  (0-based)
                 columnNum, //first column (0-based)
                 columnNum  //last column  (0-based)
         ));
    }

    /**
     * 合并单元格 列
     * @param sheet
     * @param rowNum 第几行 （0-based）
     * @param colStart    从第几列开始（0-based）
     * @param colspan    跨多少列
     */
    public static void mergedRegionColumn(Sheet sheet, int rowNum, int colStart, int colspan){
         sheet.addMergedRegion(new CellRangeAddress(
                 rowNum, //first row (0-based)
                 rowNum, //last row  (0-based)
                 colStart, //first column (0-based)
                 colStart + colspan - 1 //last column  (0-based)
         ));
    }

    /**
     * 设置生成Cell单元格 
     * @param row
     * @param column
     * @param cellValue
     * @param cellStyle
     */
    public static void createCell(Row row, Integer column, String cellValue, CellStyle cellStyle) {
        Cell cell = row.createCell(column);
        if(StringUtils.isEmpty(cellValue)) cellValue = &quot;&quot;;
        cell.setCellValue(cellValue);
        // 统一将单元格格式设置成字符串类型
        cell.setCellType(Cell.CELL_TYPE_STRING);
        cell.setCellStyle(cellStyle);
    }

    public static void createCell2(Row row, Integer column, Object cellValue, CellStyle cellStyle) {
        Cell cell = row.createCell(column);
        if(StringUtils.isEmpty(String.valueOf(cellValue))) cellValue = &quot;&quot;;

        try {
            if (isNumeric(String.valueOf(cellValue))){
                double num = Double.valueOf(String.valueOf(cellValue));
                cell.setCellValue(num);
                cell.setCellType(Cell.CELL_TYPE_NUMERIC);
            } else {
                cell.setCellValue(String.valueOf(cellValue));
                cell.setCellType(Cell.CELL_TYPE_STRING);
            }
        }catch(Exception e){
            cell.setCellValue(String.valueOf(cellValue));
            cell.setCellType(Cell.CELL_TYPE_STRING);
        }

        cell.setCellStyle(cellStyle);
    }

     private static boolean isNumeric(String value){
             if (StringUtils.isBlank(value) ){
                 return false;
             }
             //http://blog.jobbole.com/96052/ 
             //非负浮点数：^\d+(\.\d+)?$ 或 ^[1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0$ 
//            String reg = &quot;^\\d+(\\.\\d+)?$&quot;;
            String reg = &quot;^(0|([1-9]\\d{0,6}))(\\.\\d+)?$&quot;;//避免长数字出现科学计数法
            return Pattern.compile(reg).matcher(value).find();
        }

    /**
     * 设置生成Cell单元格 
     * @param row
     * @param column
     * @param cellValue
     */
    public static void createCell(Row row, Integer column, String cellValue) {
        Cell cell = row.createCell(column);
        if(StringUtils.isEmpty(cellValue)) cellValue = &quot;&quot;;
        cell.setCellValue(cellValue);
        // 统一将单元格格式设置成字符串类型
        cell.setCellType(Cell.CELL_TYPE_STRING);
    }

    /**
     * 设置生成Cell单元格 
     * @param row
     * @param column
     * @param cellValue
     */
    public static void createCell(Row row, Integer column, Object cellValue) {
        Cell cell = row.createCell(column);
        if(StringUtils.isEmpty(String.valueOf(cellValue))) cellValue = &quot;&quot;;
        cell.setCellValue(String.valueOf(cellValue));
        // 统一将单元格格式设置成字符串类型
        cell.setCellType(Cell.CELL_TYPE_STRING);
    }

    /**
     * 获得excel列的值，以字符串格式返回
     * 避免过大数字 以出现科学计数法形式出现
     * @param cell
     * @return
     */
    public static String getCellContent(Cell cell){
        switch (cell.getCellType()) {
        case Cell.CELL_TYPE_STRING:
            return String.valueOf(cell.getRichStringCellValue().toString().trim());
        case Cell.CELL_TYPE_NUMERIC:
            if (DateUtil.isCellDateFormatted(cell)) {
                return String.valueOf(cell.getDateCellValue());
            } else {
                DecimalFormat df = new DecimalFormat(&quot;0&quot;);
                return  df.format(cell.getNumericCellValue());
            }
        case Cell.CELL_TYPE_BOOLEAN:
            return String.valueOf(cell.getBooleanCellValue());
        case Cell.CELL_TYPE_FORMULA:
            String strCell = null;
            try {  
                   strCell = String.valueOf(cell.getStringCellValue().trim());  
            } catch (IllegalStateException e) {  
                   strCell = String.valueOf(cell.getNumericCellValue());  
            }  
            return strCell;
        default:
            return String.valueOf(cell.getRichStringCellValue().getString().trim());
        }
    }

    /**
     * 正文 默认字体样式，setWrapText=true（自动换行）
     * @return
     */
    public static CellStyle createCellStyle(Font font,CellStyle cellStyle) {

        // 设置字体颜色 (黑色)
        font.setColor(HSSFColor.BLACK.index);
        // 设置字体
        font.setFontName(&quot;宋体&quot;);
        // 设置粗体
        font.setBoldweight(HSSFFont.BOLDWEIGHT_NORMAL);
        // 设置字体大小
        font.setFontHeightInPoints((short)12);
        cellStyle.setWrapText(true);
        // 设置字体
        cellStyle.setFont(font);
        // 设置对齐
        cellStyle.setAlignment(CellStyle.ALIGN_CENTER);
        // 垂直居中
        cellStyle.setVerticalAlignment(CellStyle.VERTICAL_CENTER);
        cellStyle.setLocked(false);
        return cellStyle;
    }

    /**
     * 正文 默认字体样式，setWrapText=false（不允许自动换行）
     * @return
     */
    public static CellStyle createCellStyleWrapTextFalse(Font font,CellStyle cellStyle) {

        // 设置字体颜色 (黑色)
        font.setColor(HSSFColor.BLACK.index);
        // 设置字体
        font.setFontName(&quot;宋体&quot;);
        // 设置粗体
        font.setBoldweight(HSSFFont.BOLDWEIGHT_NORMAL);
        // 设置字体大小
        font.setFontHeightInPoints((short)12);
        cellStyle.setWrapText(false);
        // 设置字体
        cellStyle.setFont(font);
        // 设置对齐
        cellStyle.setAlignment(CellStyle.ALIGN_CENTER);
        // 垂直居中
        cellStyle.setVerticalAlignment(CellStyle.VERTICAL_CENTER);
        cellStyle.setLocked(false);
        return cellStyle;
    }

    /**
     * 允许换行
     * @param wb
     * @return
     */
    public static CellStyle createBrCellStyle(HSSFWorkbook wb) {
        // 创建列样式
        CellStyle style = wb.createCellStyle();
        // 创建字体
        Font font = wb.createFont();
        // 设置字体颜色 (黑色)
        font.setColor(HSSFColor.BLACK.index);
        // 设置字体
        font.setFontName(&quot;宋体&quot;);
        // 设置粗体
        font.setBoldweight(HSSFFont.BOLDWEIGHT_NORMAL);
        // 设置字体大小
        font.setFontHeightInPoints((short)12);
        // 设置不换行
        style.setWrapText(true);
        // 设置字体
        style.setFont(font);
        // 设置对齐
        style.setAlignment(CellStyle.ALIGN_LEFT);
        // 垂直居中
        style.setVerticalAlignment(CellStyle.ALIGN_LEFT);
        style.setLocked(false);

        return style;
    }

    /**
     * 表头默认样式：宋体 12号字体，加粗
     * @return
     */
    public static CellStyle createHeadCell(HSSFWorkbook wb) {
        // 创建字体
        Font font = wb.createFont();
        // 创建列样式
        CellStyle cellStyle = wb.createCellStyle();
        // 设置字体颜色 (黑色)
        font.setColor(HSSFColor.BLACK.index);
        font.setFontName(&quot;宋体&quot;);
        // 设置粗体
        font.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);
        // 设置字体大小
        font.setFontHeightInPoints((short)12);
        // 设置不允许自动换行
        cellStyle.setWrapText(false);
        // 设置字体
        cellStyle.setFont(font);
        // 设置对齐
        cellStyle.setAlignment(CellStyle.ALIGN_CENTER);
        cellStyle.setVerticalAlignment(CellStyle.VERTICAL_CENTER);
        cellStyle.setLocked(false);

        return cellStyle;
    }

    /**
     * 特殊格式自定义，主要用在表头上
     * @return
     */
    public static  CellStyle createHSSFCellStyle(HSSFWorkbook wb,short boldweight, short fontheight, short alignment) {
        // 创建列样式
        CellStyle style = wb.createCellStyle();
        // 创建字体
        Font font = wb.createFont();
        // 设置字体颜色 (黑色)
        font.setColor(HSSFColor.BLACK.index);
        // 设置字体
        font.setFontName(&quot;宋体&quot;);
        // 设置粗体
        font.setBoldweight(boldweight);
        // 设置字体大小
        font.setFontHeightInPoints(fontheight);
        // 设置不换行
        style.setWrapText(false);
        // 设置字体
        style.setFont(font);
        // 设置对齐
        style.setAlignment(alignment);
        // 垂直居中
        style.setVerticalAlignment(CellStyle.VERTICAL_CENTER);
        style.setLocked(false);

        return style;
    }

    /**
     * 获取合并单元格的值
     * @return
     */
    public static String getMergedRegionValue(Sheet sheet, int row, int column) {
        int sheetMergeCount = sheet.getNumMergedRegions();

        for (int i = 0; i &lt; sheetMergeCount; i++) {
            CellRangeAddress ca = sheet.getMergedRegion(i);
            int firstColumn = ca.getFirstColumn();
            int lastColumn = ca.getLastColumn();
            int firstRow = ca.getFirstRow();
            int lastRow = ca.getLastRow();

            if (row &gt;= firstRow &amp;&amp; row &lt;= lastRow) {

                if (column &gt;= firstColumn &amp;&amp; column &lt;= lastColumn) {
                    Row fRow = sheet.getRow(firstRow);
                    Cell fCell = fRow.getCell(firstColumn);
                    return ExcelUtils.getCellContent(fCell);
                }
            }
        }

        return null;
    }

    /**
     * 得到合并区域
     * 
     * @param sheet
     * @param row
     * @param column
     * @return
     */
    public static CellRangeAddress getMergedRegion(Sheet sheet, int row, int column) {
        int sheetMergeCount = sheet.getNumMergedRegions();

        for (int i = 0; i &lt; sheetMergeCount; i++) {
            CellRangeAddress region = sheet.getMergedRegion(i);
            int firstColumn = region.getFirstColumn();
            int lastColumn = region.getLastColumn();
            int firstRow = region.getFirstRow();
            int lastRow = region.getLastRow();

            if (row &gt;= firstRow &amp;&amp; row &lt;= lastRow) {
                if (column &gt;= firstColumn &amp;&amp; column &lt;= lastColumn) {
                    return region;
                }
            }
        }
        return null;
    }

    /**
     * 判断合并了行
     * 
     * @param sheet
     * @param row
     * @param column
     * @return
     */
    public static boolean isMergedRow(Sheet sheet, int row, int column) {
        int sheetMergeCount = sheet.getNumMergedRegions();
        for (int i = 0; i &lt; sheetMergeCount; i++) {
            CellRangeAddress range = sheet.getMergedRegion(i);
            int firstColumn = range.getFirstColumn();
            int lastColumn = range.getLastColumn();
            int firstRow = range.getFirstRow();
            int lastRow = range.getLastRow();
            if (row == firstRow &amp;&amp; row == lastRow) {
                if (column &gt;= firstColumn &amp;&amp; column &lt;= lastColumn) {
                    return true;
                }
            }
        }
        return false;
    }

    /**
     * 判断指定的单元格是否是合并单元格
     * 
     * @param sheet
     *            工作表
     * @param row
     *            行下标
     * @param column
     *            列下标
     * @return
     */
    public static boolean isMergedRegion(Sheet sheet, int row, int column) {
        int sheetMergeCount = sheet.getNumMergedRegions();
        for (int i = 0; i &lt; sheetMergeCount; i++) {
            CellRangeAddress range = sheet.getMergedRegion(i);
            int firstColumn = range.getFirstColumn();
            int lastColumn = range.getLastColumn();
            int firstRow = range.getFirstRow();
            int lastRow = range.getLastRow();
            if (row &gt;= firstRow &amp;&amp; row &lt;= lastRow) {
                if (column &gt;= firstColumn &amp;&amp; column &lt;= lastColumn) {
                    return true;
                }
            }
        }
        return false;
    }
</code></pre>
<p>页面部分分为三步：<br>1、上传文件<br><img src="excel-upload-1.png" alt="导入第一步"><br>2、设置数据更新方式<br><img src="excel-upload-2.png" alt="导入第二步"><br>3、提示（比如说Excel中有重复记录，也需要提示出来，让用户修改后重新导入）<br><img src="excel-upload-3.png" alt="导入第三步"></p>
<p>#结语<br>记录备忘之。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;poi-是什么呢&quot;&gt;&lt;a href=&quot;#poi-是什么呢&quot; class=&quot;headerlink&quot; title=&quot;poi 是什么呢&quot;&gt;&lt;/a&gt;poi 是什么呢&lt;/h1&gt;&lt;p&gt;Apache POI 简介是用Java编写的免费开源的跨平台的 Java API，Apache POI提供API给Java程式对Microsoft Office（Excel、WORD、PowerPoint、Visio等）格式档案读和写的功能。POI为“Poor Obfuscation Implementation”的首字母缩写，意为“可怜的模糊实现”。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Excel" scheme="//zeroto.tech/tags/Excel/"/>
    
      <category term="poi" scheme="//zeroto.tech/tags/poi/"/>
    
  </entry>
  
  <entry>
    <title>itext实现录取通知书、成绩单</title>
    <link href="//zeroto.tech/2017/07/03/itext-how/"/>
    <id>//zeroto.tech/2017/07/03/itext-how/</id>
    <published>2017-07-03T07:21:25.000Z</published>
    <updated>2018-03-12T06:46:06.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="itext5、jfreechart生成成绩分析图表，并写入成绩单pdf"><a href="#itext5、jfreechart生成成绩分析图表，并写入成绩单pdf" class="headerlink" title="itext5、jfreechart生成成绩分析图表，并写入成绩单pdf"></a>itext5、jfreechart生成成绩分析图表，并写入成绩单pdf</h2><p>浏览器中展示图表，一般都是用百度的<a href="http://echarts.baidu.com/" target="_blank" rel="external">ECharts</a>来展现。<br>但是后台导出成绩单，必须要绕过浏览器才最方便。</p>
<a id="more"></a>
<p>在maven中引入itext5、jfreechart、ssj</p>
<pre><code class="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;
  &lt;artifactId&gt;itextpdf&lt;/artifactId&gt;
  &lt;version&gt;5.5.10&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
  &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;
  &lt;artifactId&gt;itext-pdfa&lt;/artifactId&gt;
  &lt;version&gt;5.5.10&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
  &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;
  &lt;artifactId&gt;itext-xtra&lt;/artifactId&gt;
  &lt;version&gt;5.5.10&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
  &lt;groupId&gt;com.itextpdf.tool&lt;/groupId&gt;
  &lt;artifactId&gt;xmlworker&lt;/artifactId&gt;
  &lt;version&gt;5.5.10&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;
    &lt;artifactId&gt;itext-asian&lt;/artifactId&gt;
    &lt;version&gt;5.2.0&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
 &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
 &lt;artifactId&gt;commons-math3&lt;/artifactId&gt;
 &lt;version&gt;3.0&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;org.jfree&lt;/groupId&gt;
    &lt;artifactId&gt;jfreechart&lt;/artifactId&gt;
    &lt;version&gt;1.0.14&lt;/version&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
           &lt;groupId&gt;com.lowagie&lt;/groupId&gt;
           &lt;artifactId&gt;itext&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;ca.umontreal.iro.simul&lt;/groupId&gt;
    &lt;artifactId&gt;ssj&lt;/artifactId&gt;
    &lt;version&gt;3.2.1&lt;/version&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
             &lt;groupId&gt;jfree&lt;/groupId&gt;
             &lt;artifactId&gt;jfreechart&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
</code></pre>
<p>示例如图：<br><img src="/assets/blogImg/itext5_1.png" alt="itext5_1"></p>
<p>中位数、标准差、峰度、偏度等使用 org.apache.commons.math3.analysis.function.*<br>直接函数调用，很方便。</p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>菜头叔每篇公号文章都有个 <strong>禅定时刻</strong>，很是喜欢。在此有样学样吧。</p>
<p>一个酒鬼的自述<br>“一个人活得拧巴是值得理解的，甚至是值得赞美的，这证明他内心还有冲突，并不甘于和人生妥协。但是，通过酒来发泄显得太过脆弱而虚伪，且对不起那瓶好酒。酒带给人们的应该是被压抑的快乐，而不是被压抑的痛苦。”</p>
<p>不是酒鬼，不咋饮酒，但是挺喜欢这句话。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;itext5、jfreechart生成成绩分析图表，并写入成绩单pdf&quot;&gt;&lt;a href=&quot;#itext5、jfreechart生成成绩分析图表，并写入成绩单pdf&quot; class=&quot;headerlink&quot; title=&quot;itext5、jfreechart生成成绩分析图表，并写入成绩单pdf&quot;&gt;&lt;/a&gt;itext5、jfreechart生成成绩分析图表，并写入成绩单pdf&lt;/h2&gt;&lt;p&gt;浏览器中展示图表，一般都是用百度的&lt;a href=&quot;http://echarts.baidu.com/&quot;&gt;ECharts&lt;/a&gt;来展现。&lt;br&gt;但是后台导出成绩单，必须要绕过浏览器才最方便。&lt;/p&gt;
    
    </summary>
    
    
      <category term="iText" scheme="//zeroto.tech/tags/iText/"/>
    
      <category term="jfreechart" scheme="//zeroto.tech/tags/jfreechart/"/>
    
  </entry>
  
  <entry>
    <title>Mac上使用Homebrew进行MySQL卸载、安装，解决乱码</title>
    <link href="//zeroto.tech/2017/06/22/MySQL-how/"/>
    <id>//zeroto.tech/2017/06/22/MySQL-how/</id>
    <published>2017-06-22T05:17:06.000Z</published>
    <updated>2018-03-12T03:44:56.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Mac上使用Homebrew进行MySQL卸载、安装，解决乱码"><a href="#Mac上使用Homebrew进行MySQL卸载、安装，解决乱码" class="headerlink" title="Mac上使用Homebrew进行MySQL卸载、安装，解决乱码"></a>Mac上使用Homebrew进行MySQL卸载、安装，解决乱码</h1><h2 id="Mac上使用Homebrew进行MySQL卸载"><a href="#Mac上使用Homebrew进行MySQL卸载" class="headerlink" title="Mac上使用Homebrew进行MySQL卸载"></a>Mac上使用Homebrew进行MySQL卸载</h2><p><strong>系统环境</strong></p>
<blockquote>
<p>Mac 10.12<br>Homebrew 1.2.3<br>MySQL 5.6.36_1<br><a id="more"></a><br><strong>homebrew 卸载</strong></p>
</blockquote>
<pre><code class="bash">$ brew remove mysql@5.6
$ brew cleanup
$ launchctl unload -w ~/Library/LaunchAgents/homebrew.mxcl.mysql@5.6.plist
</code></pre>
<p><strong>删除文件</strong></p>
<pre><code class="bash">$ sudo rm -f /etc/my.cnf
$ sudo rm -rf /usr/local/var/mysql
$ sudo rm ~/Library/LaunchAgents/homebrew.mxcl.mysql@5.6.plist
</code></pre>
<h2 id="Mac上使用Homebrew安装MySQL"><a href="#Mac上使用Homebrew安装MySQL" class="headerlink" title="Mac上使用Homebrew安装MySQL"></a>Mac上使用Homebrew安装MySQL</h2><p>$ brew install mysql@5.6</p>
<h3 id="让-MySQL-开机自行启动"><a href="#让-MySQL-开机自行启动" class="headerlink" title="让 MySQL 开机自行启动"></a>让 MySQL 开机自行启动</h3><pre><code class="bash">$ ln -sfv /usr/local/opt/mysql@5.6/*.plist ~/Library/LaunchAgents
$ sudo find /usr/local/Cellar/mysql@5.6/5.6.36_1/ -name &quot;homebrew.mxcl.mysql@5.6.plist&quot; -exec cp {} ~/Library/LaunchAgents/ \;
$ launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.mysql@5.6.plist
</code></pre>
<h3 id="指定MySQL数据存放路径"><a href="#指定MySQL数据存放路径" class="headerlink" title="指定MySQL数据存放路径"></a>指定MySQL数据存放路径</h3><pre><code class="bash">$ mysql_install_db --verbose --user=`whoami` --basedir=&quot;/usr/local/Cellar/mysql@5.6/5.6.36_1&quot; --datadir=/usr/local/var/mysql --tmpdir=/tmp
$ cd . ; /usr/local/Cellar/mysql@5.6/5.6.36_1/bin/mysqld_safe &amp;
</code></pre>
<h2 id="配置MySQL"><a href="#配置MySQL" class="headerlink" title="配置MySQL"></a>配置MySQL</h2><h3 id="修改-etc-my-cnf，没有就从MySQL安装目录拷贝一个模板过来。"><a href="#修改-etc-my-cnf，没有就从MySQL安装目录拷贝一个模板过来。" class="headerlink" title="修改 /etc/my.cnf，没有就从MySQL安装目录拷贝一个模板过来。"></a>修改 /etc/my.cnf，没有就从MySQL安装目录拷贝一个模板过来。</h3><pre><code># For advice on how to change settings please see
# http://dev.mysql.com/doc/refman/5.6/en/server-configuration-defaults.html


[mysqld]
port=3306
datadir=/usr/local/var/mysql


# Remove leading # and set to the amount of RAM for the most important data
# cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.
# innodb_buffer_pool_size = 128M

# Remove leading # to turn on a very important data integrity option: logging
# changes to the binary log between backups.
# log_bin

# These are commonly set, remove the # and set as required.
# basedir = .....
# datadir = .....
# port = .....
# server_id = .....
# socket = .....

# Remove leading # to set options mainly useful for reporting servers.
</code></pre><h3 id="将mysql加入系统环境变量"><a href="#将mysql加入系统环境变量" class="headerlink" title="将mysql加入系统环境变量"></a>将mysql加入系统环境变量</h3><p>执行vim ~/.bash_profile<br>在该文件中添加如下语句，完成后，按esc，然后输入wq保存。<br>export PATH=/usr/local/opt/mysql@5.6/bin:$PATH<br>最后在命令行输入source ~/.bash_profile</p>
<p>ok ,可以启动MySQL了。<br>$ mysql.server start<br>权限配置参见官网：<br><a href="https://dev.mysql.com/doc/refman/5.7/en/resetting-permissions.html" target="_blank" rel="external">https://dev.mysql.com/doc/refman/5.7/en/resetting-permissions.html</a></p>
<h3 id="设置密码"><a href="#设置密码" class="headerlink" title="设置密码"></a>设置密码</h3><p>默认是没有密码的，进去mysql后，执行语句：</p>
<pre><code class="bash">mysql&gt; set password for &#39;root&#39;@&#39;localhost&#39;=password(&#39;root&#39;);
Query OK, 0 rows affected (0.01 sec)
</code></pre>
<p>接下来使用密码登录MySQL：</p>
<pre><code class="bash">$ mysql -uroot -p
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 395
Server version: 5.6.36 Homebrew

Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.

mysql&gt; show variables like &#39;character%&#39;;
+--------------------------+------------------------------------------------------------+
| Variable_name            | Value                                                      |
+--------------------------+------------------------------------------------------------+
| character_set_client     | utf8                                                       |
| character_set_connection | utf8                                                       |
| character_set_database   | utf8                                                       |
| character_set_filesystem | binary                                                     |
| character_set_results    | utf8                                                       |
| character_set_server     | utf8                                                       |
| character_set_system     | utf8                                                       |
| character_sets_dir       | /usr/local/Cellar/mysql@5.6/5.6.36_1/share/mysql/charsets/ |
+--------------------------+------------------------------------------------------------+
8 rows in set (0.04 sec)
</code></pre>
<p>看到utf8，编码就不会出问题了。</p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>之所以写这篇，原因是从Windows转到Mac环境搞开发，碰到了乱码问题，各种配置都试了也没解决。卸载重装妥妥的。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Mac上使用Homebrew进行MySQL卸载、安装，解决乱码&quot;&gt;&lt;a href=&quot;#Mac上使用Homebrew进行MySQL卸载、安装，解决乱码&quot; class=&quot;headerlink&quot; title=&quot;Mac上使用Homebrew进行MySQL卸载、安装，解决乱码&quot;&gt;&lt;/a&gt;Mac上使用Homebrew进行MySQL卸载、安装，解决乱码&lt;/h1&gt;&lt;h2 id=&quot;Mac上使用Homebrew进行MySQL卸载&quot;&gt;&lt;a href=&quot;#Mac上使用Homebrew进行MySQL卸载&quot; class=&quot;headerlink&quot; title=&quot;Mac上使用Homebrew进行MySQL卸载&quot;&gt;&lt;/a&gt;Mac上使用Homebrew进行MySQL卸载&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;系统环境&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Mac 10.12&lt;br&gt;Homebrew 1.2.3&lt;br&gt;MySQL 5.6.36_1&lt;br&gt;
    
    </summary>
    
    
      <category term="Homebrew" scheme="//zeroto.tech/tags/Homebrew/"/>
    
      <category term="MySQL" scheme="//zeroto.tech/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>Docker初探</title>
    <link href="//zeroto.tech/2017/06/16/docker-how-1/"/>
    <id>//zeroto.tech/2017/06/16/docker-how-1/</id>
    <published>2017-06-16T06:04:53.000Z</published>
    <updated>2018-03-12T03:45:08.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="初始容器与Docker"><a href="#初始容器与Docker" class="headerlink" title="初始容器与Docker"></a>初始容器与Docker</h1><p><a href="https://docs.docker.com/engine/docker-overview/" target="_blank" rel="external">https://docs.docker.com/engine/docker-overview/</a></p>
<h2 id="什么是Docker"><a href="#什么是Docker" class="headerlink" title="什么是Docker"></a>什么是Docker</h2><h3 id="Docker开源项目背景"><a href="#Docker开源项目背景" class="headerlink" title="Docker开源项目背景"></a>Docker开源项目背景</h3><p>Docker是基于Go语言实现的开源容器项目，诞生于2013年年初，最初发起者是dotCloud公司。Docker自开源后受到广泛的关注和讨论，目前已有多个相关项目（包括Docker三剑客、Kubernetes等），逐渐形成了围绕Docker容器的生态体系。<br>由于Docker在业界造成的影响力实在太大，dotCloud公司后来也直接改名为Docker Inc，并专注于Docker相关技术和产品的开发。</p>
<p>对于Docker，目前的定义是一个开源的容器引擎，可以方便地对容器（关于容器，将在第2章详细介绍）进行管理。其对镜像的打包封装，以及引入的Docker Registry对镜像的统一管理，构建了方便快捷的“Build，Ship and Run”流程，它可以统一整个开发、测试和部署的环境和流程，极大地减少运维成本。<br><a id="more"></a></p>
<h3 id="Docker在开发和运维中的优势"><a href="#Docker在开发和运维中的优势" class="headerlink" title="Docker在开发和运维中的优势"></a>Docker在开发和运维中的优势</h3><p>对开发和运维（DevOps）人员来说，可能最梦寐以求的效果就是一次创建或配置，之后可以在任意地方、任意时间让应用正常运行。</p>
<p>1.更快速的交付和部署。使用Docker，开发人员可以使用镜像来快速构建一套标准的开发环境；开发完成之后，测试和运维人员可以直接使用完全相同环境来部署代码。只要开发测试过的代码，就可以确保在生产环境无缝运行。Docker可以快速创建和删除容器，实现快速迭代，大量节约开发、测试、部署的时间。并且，整个过程全程可见，使团队更容易理解应用的创建和工作过程。<br>2.更高效的资源利用。Docker容器的运行不需要额外的虚拟化管理程序（Virtual Machine Manager以及Hypervisor）支持，它是内核级的虚拟化，可以实现更高的性能，同时对资源的额外需求很低。<br>3.更轻松的迁移和扩展。<br>4.更简单的更新管理。使用Dockerfile，只需要小小的配置修改，就可以替代以往大量的更新工作。并且所有修改都以增量的方式被分发和更新，从而实现自动化并且高效的容器管理。</p>
<h2 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h2><p>1.Docker镜像<br>镜像是创建Docker容器的基础。通过版本管理和增量的文件系统，Docker提供了一套十分简单的机制来创建和更新现有的镜像。<br>与容器相对应，如果说容器提供了一个完整的、隔离的运行环境，那么镜像则是这个运行环境的静态体现，是一个还没有运行起来的“运行环境”。<br>Docker镜像通常是通过Dockerfile来创建的，Dockerfile提供了镜像内容的定制，同时也体现了层级关系的建立。</p>
<p>ps:镜像自身是只读的。容器从镜像启动的时候，会在镜像的最上层创建一个可写层。<br>2.Docker容器<br>在功能上，Docker通过Libcontainer实现对容器生命周期的管理、信息的设置和查询，以及监控和通信等功能。而容器也是对镜像的完美诠释，容器以镜像为基础，同时又为镜像提供了一个标准的和隔离的执行环境。<br>在概念上，容器则很好地诠释了Docker集装箱的理念，集装箱可以存放任何货物，可以通过邮轮将货物运输到世界各地。运输集装箱的邮轮和装载卸载集装箱的码头都不用关心集装箱里的货物，这是一种标准的集装和运输方式。类似的，Docker的容器就是“软件界的集装箱”，它可以安装任意的软件和库文件，做任意的运行环境配置。</p>
<p>3.Docker仓库<br>是Docker集中存放镜像文件的场所。</p>
<h2 id="Install-Docker-for-Mac"><a href="#Install-Docker-for-Mac" class="headerlink" title="Install Docker for Mac"></a>Install Docker for Mac</h2><p><a href="https://docs.docker.com/docker-for-mac/install/" target="_blank" rel="external">https://docs.docker.com/docker-for-mac/install/</a></p>
<pre><code class="bash">~ docker version
Client:
 Version:      17.03.1-ce
 API version:  1.27
 Go version:   go1.7.5
 Git commit:   c6d412e
 Built:        Tue Mar 28 00:40:02 2017
 OS/Arch:      darwin/amd64

Server:
 Version:      17.03.1-ce
 API version:  1.27 (minimum version 1.12)
 Go version:   go1.7.5
 Git commit:   c6d412e
 Built:        Fri Mar 24 00:00:50 2017
 OS/Arch:      linux/amd64
 Experimental: true
</code></pre>
<p>我们看到Client和Server均有输出，则说明Docker for Mac已经正常启动。</p>
<h2 id="CentOS环境下安装Docker"><a href="#CentOS环境下安装Docker" class="headerlink" title="CentOS环境下安装Docker"></a>CentOS环境下安装Docker</h2><p>OS requirements<br>To install Docker, you need the 64-bit version of CentOS 7.<br>我是在Mac上安装的VirtualBox，然后装上CentOS 7镜像。</p>
<p>对于CentOS 7系统，CentOS-Extras源中已内置Docker</p>
<h3 id="yum安装"><a href="#yum安装" class="headerlink" title="yum安装"></a>yum安装</h3><pre><code class="bash">[root@centos-docker yum.repos.d]# sudo tee /etc/yum.repos.d/docker.repo &lt;&lt;-&#39;EOF&#39;
&gt; [dockerrepo]
&gt; name=Docker Repository
&gt; baseurl=https://yum.dockerproject.org/repo/main/centos/$releasever/
&gt; enabled=1
&gt; gpgcheck=1
&gt; gpgkey=https://yum.dockerproject.org/gpg
&gt; EOF
</code></pre>
<p>之后更新yum软件源缓存，并安装docker-engine 即可。</p>
<pre><code class="bash">$ sudo yum install -y yum-utils
$ sudo yum update
$ sudo yum makecache fast
$ sudo yum install docker-engine
</code></pre>
<p>这是最新的版本。要想随意指定要安装的版本，如下命令，官网上如下。<br>1.List the available versions:</p>
<p>$ yum list docker-engine.x86_64  –showduplicates |sort -r</p>
<p>2.Install a specific version by adding the version after docker-engine, separated by a hyphen (-):<br>$ sudo yum install docker-engine-version</p>
<h3 id="脚本安装"><a href="#脚本安装" class="headerlink" title="脚本安装"></a>脚本安装</h3><p>1.更新系统包到最新。<br>$ yum -y update</p>
<p>2.执行Docker安装脚本</p>
<pre><code class="bash">$ curl -fsSL https://get.docker.com/ | sh
</code></pre>
<h3 id="获取镜像"><a href="#获取镜像" class="headerlink" title="获取镜像"></a>获取镜像</h3><p>Docker Hub 镜像站点</p>
<p>安装／升级你的Docker客户端<br>您可以通过阿里云的镜像仓库下载：mirrors.aliyun.com/help/docker-engine</p>
<p>或执行以下命令：</p>
<pre><code class="bash">curl -sSL http://acs-public-mirror.oss-cn-hangzhou.aliyuncs.com/docker-engine/internet | sh -
</code></pre>
<p>如何使用Docker加速器<br>针对Docker客户端版本大于1.10的用户</p>
<p>您可以通过修改daemon配置文件/etc/docker/daemon.json来使用加速器：</p>
<p>sudo mkdir -p /etc/docker<br>sudo tee /etc/docker/daemon.json &lt;&lt;-‘EOF’<br>{<br>  “registry-mirrors”: [“<a href="https://wgqgbfsb.mirror.aliyuncs.com" target="_blank" rel="external">https://wgqgbfsb.mirror.aliyuncs.com</a>“]<br>}<br>EOF<br>sudo systemctl daemon-reload<br>sudo systemctl restart docker</p>
<p>镜像是运行容器的前提，官方的Docker Hub网站已经提供了数十万个镜像供大家开放下载。<br>可以使用docker pull命令直接从Docker Hub镜像源来下载镜像。该命令的格式为docker pull NAME[：TAG]。其中，NAME是镜像仓库的名称（用来区分镜像），TAG是镜像的标签（往往用来表示版本信息）。通常情况下，描述一个镜像需要包括“名称+标签”信息。</p>
<p>现在想要获得centos的Docker镜像，<br>1.docker search –no-trunc centos<br>2.docker pull  docker.io/jdeathe/centos-ssh</p>
<h3 id="查看镜像信息"><a href="#查看镜像信息" class="headerlink" title="查看镜像信息"></a>查看镜像信息</h3><p>1.使用images命令列出镜像<br>2.使用tag命令添加镜像标签<br>3.使用inspect命令查看详细信息<br>4.使用history命令查看镜像历史(docker history –no-trunc centos-ssh)</p>
<h3 id="搜寻镜像"><a href="#搜寻镜像" class="headerlink" title="搜寻镜像"></a>搜寻镜像</h3><p>使用docker search命令可以搜索远端仓库中共享的镜像，默认搜索官方仓库中的镜像。用法为docker search TERM，支持的参数主要包括：<br>·–automated=true|false：仅显示自动创建的镜像，默认为否；<br>·–no-trunc=true|false：输出信息不截断显示，默认为否；<br>·–filter=stars=X：指定仅显示评价为指定星级以上的镜像，默认为0，即输出所有镜像。<br>例如：</p>
<pre><code>$ docker search --filter=stars=3 ubuntu
$ docker search -f stars=25 centos
</code></pre><h3 id="删除镜像"><a href="#删除镜像" class="headerlink" title="删除镜像"></a>删除镜像</h3><p>使用标签删除镜像<br>使用docker rmi命令可以删除镜像，命令格式为docker rmi IMAGE[IMAGE…]，其中IMAGE可以为标签或ID。</p>
<h3 id="创建镜像"><a href="#创建镜像" class="headerlink" title="创建镜像"></a>创建镜像</h3><p>创建镜像的方法主要有三种：基于已有镜像的容器创建、基于本地模板导入、基于Dockerfile创建。<br>本节将重点介绍前两种方法。最后一种基于Dockerfile创建的方法将在后续章节专门予以详细介绍。</p>
<h4 id="基于已有镜像的容器创建"><a href="#基于已有镜像的容器创建" class="headerlink" title="基于已有镜像的容器创建"></a>基于已有镜像的容器创建</h4><p>该方法主要是使用docker commit命令。命令格式为docker commit[OPTIONS]CONTAINER[REPOSITORY[：TAG]]，主要选项包括：<br>·-a，–author=””：作者信息；<br>·-c，–change=[]：提交的时候执行Dockerfile指令，包括CMD|ENTRYPOINT|ENV|EXPOSE|LABEL|ONBUILD|USER|VOLUME|WORKDIR等；<br>·-m，–message=””：提交消息；<br>·-p，–pause=true：提交时暂停容器运行。</p>
<h4 id="基于本地模板导入"><a href="#基于本地模板导入" class="headerlink" title="基于本地模板导入"></a>基于本地模板导入</h4><p>要直接导入一个镜像，可以使用OpenVZ提供的模板来创建，或者用其他已导出的镜像模板来创建。OPENVZ模板的下载地址为<a href="http://openvz.org/Download/templates/precreated" target="_blank" rel="external">http://openvz.org/Download/templates/precreated</a></p>
<h4 id="存出和载入镜像"><a href="#存出和载入镜像" class="headerlink" title="存出和载入镜像"></a>存出和载入镜像</h4><p>1.存出镜像</p>
<pre><code class="bash">[root@centos-docker docker]# docker save -o centos_7.tar.gz daocloud.io/centos:7
[root@centos-docker docker]# ls
centos_7.tar.gz  certs.d  daemon.json  key.json
</code></pre>
<p>2.载入镜像</p>
<pre><code class="bash">[root@centos-docker docker]# docker load --input centos_7.tar.gz
Loaded image: daocloud.io/centos:7
</code></pre>
<p>或者<br>$ docker load &lt; centos_7.tar.gz<br>这将导入镜像及其相关的元数据信息（包括标签等）。</p>
<h3 id="创建-amp-启动一个容器："><a href="#创建-amp-启动一个容器：" class="headerlink" title="创建&amp;启动一个容器："></a>创建&amp;启动一个容器：</h3><pre><code class="bash">$ docker run -d -p 10022:22 -v /dfile/:/dfile/ -h &quot;centos-d&quot; --name centos-d centos-ssh /usr/sbin/sshd -D

$ mount -t vboxsf docker_files /docker
</code></pre>
<pre><code class="bash">[root@centos-d /]# netstat -tunlp
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1/sshd
tcp6       0      0 :::22                   :::*                    LISTEN      1/sshd
</code></pre>
<p>其中10022是宿主主机的端口，22是容器的SSH服务监听端口：<br>-p 10022:22<br>使用HostPort：ContainerPort格式将本地的10022端口映射到容器的22端口。</p>
<p>在宿主主机或其他主机上，可以通过SSH访问10022端口来登录容器。</p>
<p>使用docker inspect来查看容器的基础信息。<br>参见：<a href="https://docs.docker.com/engine/reference/commandline/inspect/" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/inspect/</a></p>
<p>-v /dfile(主机):/dfile(容器):ro<br>上面的命令加载主机的/dfile目录到容器的/dfile目录。<br>ps：本地目录的路径必须是绝对路径，如果目录不存在，Docker会自动创建。</p>
<p>Docker挂载数据卷的默认权限是读写（rw），用户也可以通过ro指定为只读。</p>
<p>mount -t vboxsf the_share_name /a_folder_name<br>ps:VirtualBox与Mac共享文件夹为：docker_files<br><img src="VirtualBoxformac.png" alt="VirtualBoxformac"><br>ps: $ docker ps -a<br>查看容器。</p>
<pre><code class="bash">[root@centos-docker docker]# docker start centos-d
centos-d
[root@centos-docker docker]# docker ps -a
CONTAINER ID        IMAGE               COMMAND               CREATED             STATUS                   PORTS                   NAMES
0ffb8ab3f777        centos-ssh          &quot;/usr/sbin/sshd -D&quot;   11 weeks ago        Up 12 seconds            0.0.0.0:10022-&gt;22/tcp   centos-d
</code></pre>
<p>$ docker-enter centos-d 进入容器。<br>可以按Ctrl+d或输入exit命令来退出容器，<br>通过exit命令或Ctrl+d来退出终端时，所创建的容器立刻终止，处于stopped状态。</p>
<h4 id="利用ssh进入到docker中的centos里"><a href="#利用ssh进入到docker中的centos里" class="headerlink" title="利用ssh进入到docker中的centos里"></a>利用ssh进入到docker中的centos里</h4><p>然后 我们试着从宿主机直接进入到docker中的centos里：</p>
<pre><code class="bash">~ ssh root@192.168.99.100 -p 10022
root@192.168.99.100&#39;s password:
Last login: Thu Jun 29 09:03:57 2017 from 192.168.99.1
[root@centos-d ~]#
</code></pre>
<p>避免了先进入虚拟机系统，然后再进入docker中的centos里：</p>
<pre><code class="bash">~ ssh root@192.168.99.100 -p 22
root@192.168.99.100&#39;s password:
Last login: Thu Jun 29 17:11:29 2017 from 192.168.99.1
[root@centos-docker ~]# docker-enter centos-d
Last login: Thu Jun 29 09:21:21 UTC 2017 from 192.168.99.1 on pts/0
[root@centos-d ~]#
</code></pre>
<h4 id="create命令与容器运行模式相关的选项"><a href="#create命令与容器运行模式相关的选项" class="headerlink" title="create命令与容器运行模式相关的选项"></a>create命令与容器运行模式相关的选项</h4><p>-d, –detach=true|false (是否在后台运行容器，默认为否)<br>-P, –publish-all=true|false (通过NAT机制将容器标记暴露的端口自动映射到本地主机的临时端口)<br>-p, –publish=[] (指定如何映射到本地主机端口)<br>–rm=true|false （容器退出后是否自动删除，不能跟-d同时使用）<br>-i, –interactive=true|false (保持标准输入打开，默认为false)<br>-t, –tty=true|false (是否分配一个伪终端，默认是false)<br>–expose=[] (指定容器会暴露出来的端口或端口范围)<br>–group-add=[] (运行容器的用户组)<br>-v|–volume[=[[HOST-DIR:]CONTAINER-DIR[:OPTIONS]]] (挂载主机上的文件卷到容器内)<br>-w, –workdir=”” (容器内的默认工作目录)</p>
<h4 id="create命令与容器环境和配置相关的选项"><a href="#create命令与容器环境和配置相关的选项" class="headerlink" title="create命令与容器环境和配置相关的选项"></a>create命令与容器环境和配置相关的选项</h4><p>–add-host=[] (在容器内添加一个主机名到IP地址的映射关系（通过/etc/hosts文件）)<br>-h, –hostname=”” (指定容器内的主机名)<br>–name=”” (指定容器的别名)</p>
<h4 id="create命令与容器资源限制和安全保护相关的选项"><a href="#create命令与容器资源限制和安全保护相关的选项" class="headerlink" title="create命令与容器资源限制和安全保护相关的选项"></a>create命令与容器资源限制和安全保护相关的选项</h4><p>–privileged=true|false (是否给容器以高权限，这意味着容器内应用将不受权限下限制，一般不推荐)<br>–read-only=true|false (是否让容器内的文件系统只读)</p>
<h4 id="启动容器说明"><a href="#启动容器说明" class="headerlink" title="启动容器说明"></a>启动容器说明</h4><p>当利用docker run来创建并启动容器时，Docker在后台运行的标准操作包括：</p>
<p>·检查本地是否存在指定的镜像，不存在就从公有仓库下载；<br>·利用镜像创建一个容器，并启动该容器；<br>·分配一个文件系统给容器，并在只读的镜像层外面挂载一层可读写层；<br>·从宿主主机配置的网桥接口中桥接一个虚拟接口到容器中；<br>·从网桥的地址池配置一个IP地址给容器；<br>·执行用户指定的应用程序；<br>·执行完毕后容器被自动终止。</p>
<h3 id="终止容器"><a href="#终止容器" class="headerlink" title="终止容器"></a>终止容器</h3><p>可以使用docker stop来终止一个运行中的容器。该命令的格式为docker stop[-t|–time[=10]][CONTAINER…]。<br>首先向容器发送SIGTERM信号，等待一段超时时间（默认为10秒）后，再发送SIGKILL信号来终止容器。</p>
<h3 id="进入容器"><a href="#进入容器" class="headerlink" title="进入容器"></a>进入容器</h3><p>在使用-d参数时，容器启动后会进入后台，用户无法看到容器中的信息，也无法进行操作。<br>这个时候如果需要进入容器进行操作，有多种方法，包括使用官方的attach或exec命令，以及第三方的nsenter工具等。下面分别介绍一下。</p>
<h4 id="attach命令"><a href="#attach命令" class="headerlink" title="attach命令"></a>attach命令</h4><p>attach是Docker自带的命令，命令格式为：</p>
<p>支持三个主要选项：<br>·–detach-keys[=[]]：指定退出attach模式的快捷键序列，默认是CTRL-p CTRL-q；<br>·–no-stdin=true|false：是否关闭标准输入，默认是保持打开；<br>·–sig-proxy=true|false：是否代理收到的系统信号给应用进程，默认为true。<br>ps:当多个窗口同时用attach命令连到同一个容器的时候，所有窗口都会同步显示。不常用。</p>
<h4 id="exec命令"><a href="#exec命令" class="headerlink" title="exec命令"></a>exec命令</h4><p>Docker从1.3.0版本起提供了一个更加方便的exec命令，可以在容器内直接执行任意命令。<br>比较重要的参数有：<br>·-i，–interactive=true|false：打开标准输入接受用户输入命令，默认为false；<br>·–privileged=true|false：是否给执行命令以高权限，默认为false；<br>·-t，–tty=true|false：分配伪终端，默认为false；<br>·-u，–user=””：执行命令的用户名或ID。<br>例如进入到刚创建的容器中，并启动一个bash：</p>
<pre><code class="bash">[root@centos-docker docker]# docker exec -it centos-d /bin/bash
[root@centos-d /]# pwd
/
</code></pre>
<p>可以看到，一个bash终端打开了，在不影响容器内其他应用的前提下，用户可以很容易与容器进行交互。<br>注意<br>通过指定-it参数来保持标准输入打开，并且分配一个伪终端。通过exec命令对容器执行操作是最为推荐的方式。</p>
<h4 id="nsenter工具"><a href="#nsenter工具" class="headerlink" title="nsenter工具"></a>nsenter工具</h4><p>在util-linux软件包版本2.23+中包含nsenter工具。</p>
<pre><code class="bash">[root@centos-docker docker]# docker start centos-d
centos-d
[root@centos-docker docker]# docker ps
CONTAINER ID        IMAGE               COMMAND               CREATED             STATUS              PORTS                   NAMES
0ffb8ab3f777        centos-ssh          &quot;/usr/sbin/sshd -D&quot;   11 weeks ago        Up 6 seconds        0.0.0.0:10022-&gt;22/tcp   centos-d
[root@centos-docker docker]# PID=$(docker inspect --format &quot;{{ .State.Pid }}&quot; centos-d)
[root@centos-docker docker]# nsenter --target $PID --mount --uts --ipc --net --pid
[root@centos-d /]# ps -ef
UID        PID  PPID  C STIME TTY          TIME CMD
root         1     0  0 06:04 ?        00:00:00 /usr/sbin/sshd -D
root         5     0  0 06:07 ?        00:00:00 -bash
root        19     5  0 06:09 ?        00:00:00 ps -ef
</code></pre>
<h3 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h3><p>可以使用docker rm命令来删除处于终止或退出状态的容器，命令格式为docker rm[-f|–force][-l|–link][-v|–volumes]CONTAINER[CONTAINER…]。<br>主要支持的选项包括：<br>·-f，–force=false：是否强行终止并删除一个运行中的容器；<br>·-l，–link=false：删除容器的连接，但保留容器；<br>·-v，–volumes=false：删除容器挂载的数据卷。</p>
<h3 id="导入和导出容器"><a href="#导入和导出容器" class="headerlink" title="导入和导出容器"></a>导入和导出容器</h3><p>某些时候，需要将容器从一个系统迁移到另外一个系统，此时可以使用Docker的导入和导出功能。这也是Docker自身提供的一个重要特性。</p>
<h4 id="导出容器"><a href="#导出容器" class="headerlink" title="导出容器"></a>导出容器</h4><p>导出容器是指导出一个已经创建的容器到一个文件，不管此时这个容器是否处于运行状态，可以使用docker export命令，该命令的格式为docker export[-o|–output[=””]]CONTAINER。其中，可以通过-o选项来指定导出的tar文件名，也可以直接通过重定向来实现。<br>ps:实现容器的迁移</p>
<pre><code class="bash">[root@centos-docker docker]# docker export -o test_centos-d.tar.gz centos-d
[root@centos-docker docker]# ls
a.txt  b.txt  c.txt  epel-release-7-9.noarch.rpm  test_centos-d.tar.gz
[root@centos-docker docker]# docker export centos-d &gt;test2_centos-d.tar.gz
[root@centos-docker docker]# ls
a.txt  b.txt  c.txt  epel-release-7-9.noarch.rpm  test2_centos-d.tar.gz  test_centos-d.tar.gz
</code></pre>
<p>实际上，既可以使用docker load命令来导入镜像存储文件到本地镜像库，也可以使用docker import命令来导入一个容器快照到本地镜像库。<br>这两者的区别在于容器快照文件将丢弃所有的历史记录和元数据信息（即仅保存容器当时的快照状态），而镜像存储文件将保存完整记录，体积也更大。此外，从容器快照文件导入时可以重新指定标签等元数据信息。</p>
<p>参考在此：<a href="https://read.douban.com/reader/ebook/30546100/" target="_blank" rel="external">Docker技术入门与实践</a><br><a href="https://read.douban.com/reader/ebook/17825949/" target="_blank" rel="external">Docker进阶与实战</a> 作者：华为Docker实践小组</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;初始容器与Docker&quot;&gt;&lt;a href=&quot;#初始容器与Docker&quot; class=&quot;headerlink&quot; title=&quot;初始容器与Docker&quot;&gt;&lt;/a&gt;初始容器与Docker&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://docs.docker.com/engine/docker-overview/&quot;&gt;https://docs.docker.com/engine/docker-overview/&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;什么是Docker&quot;&gt;&lt;a href=&quot;#什么是Docker&quot; class=&quot;headerlink&quot; title=&quot;什么是Docker&quot;&gt;&lt;/a&gt;什么是Docker&lt;/h2&gt;&lt;h3 id=&quot;Docker开源项目背景&quot;&gt;&lt;a href=&quot;#Docker开源项目背景&quot; class=&quot;headerlink&quot; title=&quot;Docker开源项目背景&quot;&gt;&lt;/a&gt;Docker开源项目背景&lt;/h3&gt;&lt;p&gt;Docker是基于Go语言实现的开源容器项目，诞生于2013年年初，最初发起者是dotCloud公司。Docker自开源后受到广泛的关注和讨论，目前已有多个相关项目（包括Docker三剑客、Kubernetes等），逐渐形成了围绕Docker容器的生态体系。&lt;br&gt;由于Docker在业界造成的影响力实在太大，dotCloud公司后来也直接改名为Docker Inc，并专注于Docker相关技术和产品的开发。&lt;/p&gt;
&lt;p&gt;对于Docker，目前的定义是一个开源的容器引擎，可以方便地对容器（关于容器，将在第2章详细介绍）进行管理。其对镜像的打包封装，以及引入的Docker Registry对镜像的统一管理，构建了方便快捷的“Build，Ship and Run”流程，它可以统一整个开发、测试和部署的环境和流程，极大地减少运维成本。&lt;br&gt;
    
    </summary>
    
    
      <category term="Docker" scheme="//zeroto.tech/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>Systemd 入门教程：命令篇</title>
    <link href="//zeroto.tech/2017/05/25/systemd/"/>
    <id>//zeroto.tech/2017/05/25/systemd/</id>
    <published>2017-05-25T09:59:57.000Z</published>
    <updated>2018-03-12T03:45:28.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Systemd-入门教程：命令篇"><a href="#Systemd-入门教程：命令篇" class="headerlink" title="Systemd 入门教程：命令篇"></a>Systemd 入门教程：命令篇</h1><p>Systemd 是 Linux 系统工具，用来启动<a href="http://www.ruanyifeng.com/blog/2016/02/linux-daemon.html" target="_blank" rel="external">守护进程</a>，已成为大多数发行版的标准配置。</p>
<p>本文介绍它的基本用法，分为上下两篇。今天介绍它的主要命令，下一篇介绍如何用于实战。</p>
<a id="more"></a>
<h2 id="一、由来"><a href="#一、由来" class="headerlink" title="一、由来"></a>一、由来</h2><p>历史上，<a href="http://www.ruanyifeng.com/blog/2013/08/linux_boot_process.html" target="_blank" rel="external">Linux 的启动</a>一直采用<a href="https://en.wikipedia.org/wiki/Init" target="_blank" rel="external"><code>init</code></a>进程。</p>
<p>下面的命令用来启动服务。</p>
<pre><code class="bash">[root@localhost /]# service httpd start
Redirecting to /bin/systemctl start  httpd.service
</code></pre>
<p>ps:Centos7已经不支持了喔！</p>
<p>这种方法有两个缺点。</p>
<p>一是启动时间长。<code>init</code>进程是串行启动，只有前一个进程启动完，才会启动下一个进程。</p>
<p>二是启动脚本复杂。<code>init</code>进程只是执行启动脚本，不管其他事情。脚本需要自己处理各种情况，这往往使得脚本变得很长。</p>
<h2 id="二、Systemd-概述"><a href="#二、Systemd-概述" class="headerlink" title="二、Systemd 概述"></a>二、Systemd 概述</h2><p>Systemd 就是为了解决这些问题而诞生的。它的设计目标是，为系统的启动和管理提供一套完整的解决方案。</p>
<p>根据 Linux 惯例，字母<code>d</code>是守护进程（daemon）的缩写。 Systemd 这个名字的含义，就是它要守护整个系统。</p>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2016/bg2016030702.jpg" alt=""></p>
<p>（上图为 Systemd 作者 <a href="https://en.wikipedia.org/wiki/Lennart_Poettering" target="_blank" rel="external">Lennart Poettering</a>）</p>
<p>使用了 Systemd，就不需要再用<code>init</code>了。Systemd 取代了<code>initd</code>，成为系统的第一个进程（PID 等于 1），其他进程都是它的子进程。</p>
<pre><code class="bash">$ systemctl --version
</code></pre>
<p>上面的命令查看 Systemd 的版本。</p>
<p>Systemd 的优点是功能强大，使用方便，缺点是系统庞大，非常复杂。事实上，现在还有很多人反对使用 Systemd，理由就是它过于复杂，与操作系统的其他部分强耦合，违反“keep simple, keep stupid”的<a href="http://www.ruanyifeng.com/blog/2009/06/unix_philosophy.html" target="_blank" rel="external">Unix 哲学</a>。</p>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2016/bg2016030703.png" alt=""></p>
<p>（上图为 Systemd 架构图）</p>
<h2 id="三、系统管理"><a href="#三、系统管理" class="headerlink" title="三、系统管理"></a>三、系统管理</h2><p>Systemd 并不是一个命令，而是一组命令，涉及到系统管理的方方面面。</p>
<h3 id="3-1-systemctl"><a href="#3-1-systemctl" class="headerlink" title="3.1 systemctl"></a>3.1 systemctl</h3><p><code>systemctl</code>是 Systemd 的主命令，用于管理系统。</p>
<pre><code class="bash"># 重启系统
$ sudo systemctl reboot

# 关闭系统，切断电源
$ sudo systemctl poweroff

# CPU停止工作
$ sudo systemctl halt

# 暂停系统
$ sudo systemctl suspend

# 让系统进入冬眠状态
$ sudo systemctl hibernate

# 让系统进入交互式休眠状态
$ sudo systemctl hybrid-sleep

# 启动进入救援状态（单用户状态）
$ sudo systemctl rescue
</code></pre>
<h3 id="3-2-systemd-analyze"><a href="#3-2-systemd-analyze" class="headerlink" title="3.2 systemd-analyze"></a>3.2 systemd-analyze</h3><p><code>systemd-analyze</code>命令用于查看启动耗时。</p>
<pre><code class="bash"># 查看启动耗时
$ systemd-analyze                                                                                       

# 查看每个服务的启动耗时
$ systemd-analyze blame

# 显示瀑布状的启动过程流
$ systemd-analyze critical-chain

# 显示指定服务的启动流(eg:sshd.service)
$ systemd-analyze critical-chain sshd.service
</code></pre>
<h3 id="3-3-hostnamectl"><a href="#3-3-hostnamectl" class="headerlink" title="3.3 hostnamectl"></a>3.3 hostnamectl</h3><p><code>hostnamectl</code>命令用于查看当前主机的信息。</p>
<pre><code class="bash"># 显示当前主机的信息
$ hostnamectl

# 设置主机名。
$ sudo hostnamectl set-hostname CentOS-Docker
</code></pre>
<h3 id="3-4-localectl"><a href="#3-4-localectl" class="headerlink" title="3.4 localectl"></a>3.4 localectl</h3><p><code>localectl</code>命令用于查看本地化设置。</p>
<pre><code class="bash"># 查看本地化设置
$ localectl

# 设置本地化参数。
$ sudo localectl set-locale LANG=zh_CN.UTF-8
$ sudo localectl set-keymap cn
</code></pre>
<h3 id="3-5-timedatectl"><a href="#3-5-timedatectl" class="headerlink" title="3.5 timedatectl"></a>3.5 timedatectl</h3><p><code>timedatectl</code>命令用于查看当前时区设置。</p>
<pre><code class="bash"># 查看当前时区设置
$ timedatectl

# 显示所有可用的时区
$ timedatectl list-timezones                                                                                   

# 设置当前时区
$ sudo timedatectl set-timezone America/New_York
</code></pre>
<h3 id="3-6-loginctl"><a href="#3-6-loginctl" class="headerlink" title="3.6 loginctl"></a>3.6 loginctl</h3><p><code>loginctl</code>命令用于查看当前登录的用户。</p>
<pre><code class="bash"># 列出当前session
$ loginctl list-sessions

# 列出当前登录用户
$ loginctl list-users

# 列出显示指定用户的信息
$ loginctl show-user root
</code></pre>
<h2 id="四、Unit"><a href="#四、Unit" class="headerlink" title="四、Unit"></a>四、Unit</h2><h3 id="4-1-含义"><a href="#4-1-含义" class="headerlink" title="4.1 含义"></a>4.1 含义</h3><p>Systemd 可以管理所有系统资源。不同的资源统称为 Unit（单位）。</p>
<p>Unit 一共分成12种。</p>
<blockquote>
<ul>
<li>Service unit：系统服务</li>
<li>Target unit：多个 Unit 构成的一个组</li>
<li>Device Unit：硬件设备</li>
<li>Mount Unit：文件系统的挂载点</li>
<li>Automount Unit：自动挂载点</li>
<li>Path Unit：文件或路径</li>
<li>Scope Unit：不是由 Systemd 启动的外部进程</li>
<li>Slice Unit：进程组</li>
<li>Snapshot Unit：Systemd 快照，可以切回某个快照</li>
<li>Socket Unit：进程间通信的 socket</li>
<li>Swap Unit：swap 文件</li>
<li>Timer Unit：定时器</li>
</ul>
</blockquote>
<p><code>systemctl list-units</code>命令可以查看当前系统的所有 Unit 。</p>
<pre><code class="bash"># 列出正在运行的 Unit
$ systemctl list-units

# 列出所有Unit，包括没有找到配置文件的或者启动失败的
$ systemctl list-units --all

# 列出所有没有运行的 Unit
$ systemctl list-units --all --state=inactive

# 列出所有加载失败的 Unit
$ systemctl list-units --failed

# 列出所有正在运行的、类型为 service 的 Unit
$ systemctl list-units --type=service
</code></pre>
<h3 id="4-2-Unit-的状态"><a href="#4-2-Unit-的状态" class="headerlink" title="4.2 Unit 的状态"></a>4.2 Unit 的状态</h3><p><code>systemctl status</code>命令用于查看系统状态和单个 Unit 的状态。</p>
<pre><code class="bash"># 显示系统状态
$ systemctl status

# 显示单个 Unit 的状态
$ sysystemctl status httpd.service

# 显示远程主机的某个 Unit 的状态
$ systemctl -H root@rhel7.example.com status httpd.service
</code></pre>
<p>除了<code>status</code>命令，<code>systemctl</code>还提供了三个查询状态的简单方法，主要供脚本内部的判断语句使用。</p>
<pre><code class="bash"># 显示某个 Unit 是否正在运行
$ systemctl is-active httpd.service

# 显示某个 Unit 是否处于启动失败状态
$ systemctl is-failed httpd.service

# 显示某个 Unit 服务是否建立了启动链接
$ systemctl is-enabled httpd.service
</code></pre>
<h3 id="4-3-Unit-管理"><a href="#4-3-Unit-管理" class="headerlink" title="4.3 Unit 管理"></a>4.3 Unit 管理</h3><p>对于用户来说，最常用的是下面这些命令，用于启动和停止 Unit（主要是 service）。</p>
<pre><code class="bash"># 立即启动一个服务
$ sudo systemctl start httpd.service
# 立即停止一个服务
$ sudo systemctl stop httpd.service
# 重启一个服务
$ sudo systemctl restart httpd.service
# 杀死一个服务的所有子进程
$ sudo systemctl kill httpd.service
# 重新加载一个服务的配置文件
$ sudo systemctl reload httpd.service
# 重载所有修改过的配置文件
$ sudo systemctl daemon-reload

# 显示某个 Unit 的所有底层参数
$ systemctl show httpd.service

# 显示某个 Unit 的指定属性的值
$ systemctl show -p CPUShares httpd.service
</code></pre>
<h3 id="4-4-依赖关系"><a href="#4-4-依赖关系" class="headerlink" title="4.4 依赖关系"></a>4.4 依赖关系</h3><p>Unit 之间存在依赖关系：A 依赖于 B，就意味着 Systemd 在启动 A 的时候，同时会去启动 B。</p>
<p><code>systemctl list-dependencies</code>命令列出一个 Unit 的所有依赖。</p>
<pre><code class="bash">$ systemctl list-dependencies nginx.service
</code></pre>
<p>上面命令的输出结果之中，有些依赖是 Target 类型（详见下文），默认不会展开显示。如果要展开 Target，就需要使用<code>--all</code>参数。</p>
<pre><code class="bash">$ systemctl list-dependencies --all nginx.service
</code></pre>
<h2 id="五、Unit-的配置文件"><a href="#五、Unit-的配置文件" class="headerlink" title="五、Unit 的配置文件"></a>五、Unit 的配置文件</h2><h3 id="5-1-概述"><a href="#5-1-概述" class="headerlink" title="5.1 概述"></a>5.1 概述</h3><p>每一个 Unit 都有一个配置文件，告诉 Systemd 怎么启动这个 Unit 。</p>
<p>Systemd 默认从目录<code>/etc/systemd/system/</code>读取配置文件。但是，里面存放的大部分文件都是符号链接，指向目录<code>/usr/lib/systemd/system/</code>，真正的配置文件存放在这个目录。</p>
<p><code>systemctl enable</code>命令用于在上面两个目录之间，建立符号链接关系。</p>
<pre><code class="bash">$ sudo systemctl enable sshd.service
# 等同于
$ sudo ln -s &#39;/usr/lib/systemd/system/sshd.service&#39; &#39;/etc/systemd/system/multi-user.target.wants/sshd.service&#39;
</code></pre>
<p>如果配置文件里面设置了开机启动，<code>systemctl enable</code>命令相当于激活开机启动。</p>
<p>与之对应的，<code>systemctl disable</code>命令用于在两个目录之间，撤销符号链接关系，相当于撤销开机启动。</p>
<pre><code class="bash">$ sudo systemctl disable sshd.service
</code></pre>
<p>配置文件的后缀名，就是该 Unit 的种类，比如<code>sshd.socket</code>。如果省略，Systemd 默认后缀名为<code>.service</code>，所以<code>sshd</code>会被理解成<code>sshd.service</code>。</p>
<h3 id="5-2-配置文件的状态"><a href="#5-2-配置文件的状态" class="headerlink" title="5.2 配置文件的状态"></a>5.2 配置文件的状态</h3><p><code>systemctl list-unit-files</code>命令用于列出所有配置文件。</p>
<pre><code class="bash"># 列出所有配置文件
$ systemctl list-unit-files

# 列出指定类型的配置文件
$ systemctl list-unit-files --type=service
</code></pre>
<p>这个命令会输出一个列表。</p>
<pre><code class="bash">$ systemctl list-unit-files

UNIT FILE              STATE
chronyd.service        enabled
clamd@.service         static
sshd.service     disabled
</code></pre>
<p>这个列表显示每个配置文件的状态，一共有四种。</p>
<blockquote>
<ul>
<li>enabled：已建立启动链接</li>
<li>disabled：没建立启动链接</li>
<li>static：该配置文件没有<code>[Install]</code>部分（无法执行），只能作为其他配置文件的依赖</li>
<li>masked：该配置文件被禁止建立启动链接</li>
</ul>
</blockquote>
<p>注意，从配置文件的状态无法看出，该 Unit 是否正在运行。这必须执行前面提到的<code>systemctl status</code>命令。</p>
<pre><code class="bash">$ systemctl status httpd.service
</code></pre>
<p>一旦修改配置文件，就要让 Systemd 重新加载配置文件，然后重新启动，否则修改不会生效。</p>
<pre><code class="bash">$ sudo systemctl daemon-reload
$ sudo systemctl restart httpd.service
</code></pre>
<h3 id="5-3-配置文件的格式"><a href="#5-3-配置文件的格式" class="headerlink" title="5.3 配置文件的格式"></a>5.3 配置文件的格式</h3><p>配置文件就是普通的文本文件，可以用文本编辑器打开。</p>
<p><code>systemctl cat</code>命令可以查看配置文件的内容。<br>注意，配置文件的区块名和字段名，都是大小写敏感的。</p>
<p>每个区块内部是一些等号连接的键值对。</p>
<pre><code class="bash">[Section]
Directive1=value
Directive2=value

. . .
</code></pre>
<p>注意，键值对的等号两侧不能有空格。</p>
<h3 id="5-4-配置文件的区块"><a href="#5-4-配置文件的区块" class="headerlink" title="5.4 配置文件的区块"></a>5.4 配置文件的区块</h3><p><code>[Unit]</code>区块通常是配置文件的第一个区块，用来定义 Unit 的元数据，以及配置与其他 Unit 的关系。它的主要字段如下。</p>
<blockquote>
<ul>
<li><code>Description</code>：简短描述</li>
<li><code>Documentation</code>：文档地址</li>
<li><code>Requires</code>：当前 Unit 依赖的其他 Unit，如果它们没有运行，当前 Unit 会启动失败</li>
<li><code>Wants</code>：与当前 Unit 配合的其他 Unit，如果它们没有运行，当前 Unit 不会启动失败</li>
<li><code>BindsTo</code>：与<code>Requires</code>类似，它指定的 Unit 如果退出，会导致当前 Unit 停止运行</li>
<li><code>Before</code>：如果该字段指定的 Unit 也要启动，那么必须在当前 Unit 之后启动</li>
<li><code>After</code>：如果该字段指定的 Unit 也要启动，那么必须在当前 Unit 之前启动</li>
<li><code>Conflicts</code>：这里指定的 Unit 不能与当前 Unit 同时运行</li>
<li><code>Condition...</code>：当前 Unit 运行必须满足的条件，否则不会运行</li>
<li><code>Assert...</code>：当前 Unit 运行必须满足的条件，否则会报启动失败</li>
</ul>
</blockquote>
<p><code>[Install]</code>通常是配置文件的最后一个区块，用来定义如何启动，以及是否开机启动。它的主要字段如下。</p>
<blockquote>
<ul>
<li><code>WantedBy</code>：它的值是一个或多个 Target，当前 Unit 激活时（enable）符号链接会放入<code>/etc/systemd/system</code>目录下面以 Target 名 + <code>.wants</code>后缀构成的子目录中</li>
<li><code>RequiredBy</code>：它的值是一个或多个 Target，当前 Unit 激活时，符号链接会放入<code>/etc/systemd/system</code>目录下面以 Target 名 + <code>.required</code>后缀构成的子目录中</li>
<li><code>Alias</code>：当前 Unit 可用于启动的别名</li>
<li><code>Also</code>：当前 Unit 激活（enable）时，会被同时激活的其他 Unit</li>
</ul>
</blockquote>
<p><code>[Service]</code>区块用来 Service 的配置，只有 Service 类型的 Unit 才有这个区块。它的主要字段如下。</p>
<blockquote>
<ul>
<li><code>Type</code>：定义启动时的进程行为。它有以下几种值。<ul>
<li><code>simple</code>：默认值，执行<code>ExecStart</code>指定的命令，启动主进程</li>
<li><code>forking</code>：以 fork 方式从父进程创建子进程，创建后父进程会立即退出</li>
<li><code>oneshot</code>：一次性进程，Systemd 会等当前服务退出，再继续往下执行</li>
<li><code>dbus</code>：当前服务通过D-Bus启动</li>
<li><code>notify</code>：当前服务启动完毕，会通知<code>Systemd</code>，再继续往下执行</li>
<li><code>idle</code>：若有其他任务执行完毕，当前服务才会运行</li>
</ul>
</li>
<li><code>ExecStart</code>：启动当前服务的命令</li>
<li><code>ExecStartPre</code>：启动当前服务之前执行的命令</li>
<li><code>ExecStartPost</code>：启动当前服务之后执行的命令</li>
<li><code>ExecReload</code>：重启当前服务时执行的命令</li>
<li><code>ExecStop</code>：停止当前服务时执行的命令</li>
<li><code>ExecStopPost</code>：停止当其服务之后执行的命令</li>
<li><code>RestartSec</code>：自动重启当前服务间隔的秒数</li>
<li><code>Restart</code>：定义何种情况 Systemd 会自动重启当前服务，可能的值包括<code>always</code>（总是重启）、<code>on-success</code>、<code>on-failure</code>、<code>on-abnormal</code>、<code>on-abort</code>、<code>on-watchdog</code></li>
<li><code>TimeoutSec</code>：定义 Systemd 停止当前服务之前等待的秒数</li>
<li><code>Environment</code>：指定环境变量</li>
</ul>
</blockquote>
<p>Unit 配置文件的完整字段清单，请参考<a href="https://www.freedesktop.org/software/systemd/man/systemd.unit.html" target="_blank" rel="external">官方文档</a>。</p>
<h2 id="六、Target"><a href="#六、Target" class="headerlink" title="六、Target"></a>六、Target</h2><p>简单说，Target 就是一个 Unit 组，包含许多相关的 Unit 。启动某个 Target 的时候，Systemd 就会启动里面所有的 Unit。从这个意义上说，Target 这个概念类似于“状态点”，启动某个 Target 就好比启动到某种状态。</p>
<p>传统的<code>init</code>启动模式里面，有 RunLevel 的概念，跟 Target 的作用很类似。不同的是，RunLevel 是互斥的，不可能多个 RunLevel 同时启动，但是多个 Target 可以同时启动。</p>
<pre><code class="bash"># 查看当前系统的所有 Target
$ systemctl list-unit-files --type=target

# 查看一个 Target 包含的所有 Unit
$ systemctl list-dependencies multi-user.target

# 查看启动时的默认 Target
$ systemctl get-default

# 设置启动时的默认 Target
$ sudo systemctl set-default multi-user.target

# 切换 Target 时，默认不关闭前一个 Target 启动的进程，
# systemctl isolate 命令改变这种行为，
# 关闭前一个 Target 里面所有不属于后一个 Target 的进程
$ sudo systemctl isolate multi-user.target
</code></pre>
<p>Target 与 传统 RunLevel 的对应关系如下。</p>
<pre><code class="bash">Traditional runlevel      New target name     Symbolically linked to...

Runlevel 0           |    runlevel0.target -&gt; poweroff.target
Runlevel 1           |    runlevel1.target -&gt; rescue.target
Runlevel 2           |    runlevel2.target -&gt; multi-user.target
Runlevel 3           |    runlevel3.target -&gt; multi-user.target
Runlevel 4           |    runlevel4.target -&gt; multi-user.target
Runlevel 5           |    runlevel5.target -&gt; graphical.target
Runlevel 6           |    runlevel6.target -&gt; reboot.target
</code></pre>
<p>它与<code>init</code>进程的主要差别如下。</p>
<blockquote>
<p><strong>（1）默认的 RunLevel</strong>（在<code>/etc/inittab</code>文件设置）现在被默认的 Target 取代，位置是<code>/etc/systemd/system/default.target</code>，通常符号链接到<code>graphical.target</code>（图形界面）或者<code>multi-user.target</code>（多用户命令行）。</p>
<p><strong>（2）启动脚本的位置</strong>，以前是<code>/etc/init.d</code>目录，符号链接到不同的 RunLevel 目录 （比如<code>/etc/rc3.d</code>、<code>/etc/rc5.d</code>等），现在则存放在<code>/lib/systemd/system</code>和<code>/etc/systemd/system</code>目录。</p>
<p><strong>（3）配置文件的位置</strong>，以前<code>init</code>进程的配置文件是<code>/etc/inittab</code>，各种服务的配置文件存放在<code>/etc/sysconfig</code>目录。现在的配置文件主要存放在<code>/lib/systemd</code>目录，在<code>/etc/systemd</code>目录里面的修改可以覆盖原始设置。</p>
</blockquote>
<h2 id="七、日志管理"><a href="#七、日志管理" class="headerlink" title="七、日志管理"></a>七、日志管理</h2><p>Systemd 统一管理所有 Unit 的启动日志。带来的好处就是，可以只用<code>journalctl</code>一个命令，查看所有日志（内核日志和应用日志）。日志的配置文件是<code>/etc/systemd/journald.conf</code>。</p>
<p><code>journalctl</code>功能强大，用法非常多。</p>
<pre><code class="bash"># 查看所有日志（默认情况下 ，只保存本次启动的日志）
$ sudo journalctl

# 查看内核日志（不显示应用日志）
$ sudo journalctl -k

# 查看系统本次启动的日志
$ sudo journalctl -b
$ sudo journalctl -b -0

# 查看上一次启动的日志（需更改设置）
$ sudo journalctl -b -1

# 查看指定时间的日志
$ sudo journalctl --since=&quot;2012-10-30 18:17:16&quot;
$ sudo journalctl --since &quot;20 min ago&quot;
$ sudo journalctl --since yesterday
$ sudo journalctl --since 09:00 --until &quot;1 hour ago&quot;

# 显示尾部的最新10行日志
$ sudo journalctl -n

# 显示尾部指定行数的日志
$ sudo journalctl -n 20

# 实时滚动显示最新日志
$ sudo journalctl -f

# 查看指定服务的日志
$ sudo journalctl /usr/lib/systemd/systemd

# 查看指定进程的日志
$ sudo journalctl _PID=1

# 查看某个路径的脚本的日志
$ sudo journalctl /usr/bin/bash

# 查看指定用户的日志
$ sudo journalctl _UID=33 --since today

# 查看某个 Unit 的日志
$ sudo journalctl -u nginx.service
$ sudo journalctl -u nginx.service --since today

# 实时滚动显示某个 Unit 的最新日志
$ sudo journalctl -u nginx.service -f

# 合并显示多个 Unit 的日志
$ journalctl -u nginx.service -u php-fpm.service --since today

# 查看指定优先级（及其以上级别）的日志，共有8级
# 0: emerg
# 1: alert
# 2: crit
# 3: err
# 4: warning
# 5: notice
# 6: info
# 7: debug
$ sudo journalctl -p err -b

# 日志默认分页输出，--no-pager 改为正常的标准输出
$ sudo journalctl --no-pager

# 以 JSON 格式（单行）输出
$ sudo journalctl -b -u nginx.service -o json

# 以 JSON 格式（多行）输出，可读性更好
$ sudo journalctl -b -u nginx.service -o json-pretty

# 显示日志占据的硬盘空间
$ sudo journalctl --disk-usage

# 指定日志文件占据的最大空间
$ sudo journalctl --vacuum-size=1G

# 指定日志文件保存多久
$ sudo journalctl --vacuum-time=1years
</code></pre>
<h2 id="八、结语"><a href="#八、结语" class="headerlink" title="八、结语"></a>八、结语</h2><p>转载于<a href="http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html</a></p>
<p>引申阅读：</p>
<ul>
<li><a href="http://coolshell.cn/articles/17998.html" target="_blank" rel="external">LINUX PID 1 和 SYSTEMD</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Systemd-入门教程：命令篇&quot;&gt;&lt;a href=&quot;#Systemd-入门教程：命令篇&quot; class=&quot;headerlink&quot; title=&quot;Systemd 入门教程：命令篇&quot;&gt;&lt;/a&gt;Systemd 入门教程：命令篇&lt;/h1&gt;&lt;p&gt;Systemd 是 Linux 系统工具，用来启动&lt;a href=&quot;http://www.ruanyifeng.com/blog/2016/02/linux-daemon.html&quot;&gt;守护进程&lt;/a&gt;，已成为大多数发行版的标准配置。&lt;/p&gt;
&lt;p&gt;本文介绍它的基本用法，分为上下两篇。今天介绍它的主要命令，下一篇介绍如何用于实战。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="//zeroto.tech/tags/Linux/"/>
    
      <category term="Systemd" scheme="//zeroto.tech/tags/Systemd/"/>
    
  </entry>
  
  <entry>
    <title>Git 学习笔记 - 基本操作</title>
    <link href="//zeroto.tech/2017/05/11/git-how/"/>
    <id>//zeroto.tech/2017/05/11/git-how/</id>
    <published>2017-05-11T09:57:29.000Z</published>
    <updated>2018-03-12T03:35:28.000Z</updated>
    
    <content type="html"><![CDATA[<p>#Git 闲话</p>
<blockquote>
<p>1、最近阅读《数学之美》、《浪潮之巅》惊叹于大神的眼界、文化功底，所以就在得到专栏上订阅了吴军博士的硅谷来信。总之，就是膜拜了。想了解一个人，就先了解一个的思想对不对，所谓见贤与之思齐就是这样了。<br>2、接下来说一说我心目中的另一位大神 林纳斯•托瓦兹，编程界公认的啊。<br>“我不是个有远见的人，我是一名工程师，”托瓦兹说，“我非常乐意跟梦想家在一起，他们行走四方，仰望苍穹……但我是低头看路的那种人，我只想填好眼前这个坑，不让自己掉进去。“<br>只干了两件事啊，毫不夸张的说：惊天地泣鬼神。<br>第一件是开发出Linux内核，驱动了因特网，第二件是开发出Git，一种源代码管理系统，被全世界开发者广泛使用。<br>再接下来，Git 就是我们的主题了，记录以备忘。</p>
</blockquote>
<a id="more"></a>
<h2 id="Git安装与配置"><a href="#Git安装与配置" class="headerlink" title="Git安装与配置"></a>Git安装与配置</h2><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p>Mac 上brew安装算是最便捷的了</p>
<pre><code class="zsh">~ brew install git 
~ brew --version
Homebrew 1.1.13
Homebrew/homebrew-core (git revision ea163; last commit 2017-04-20)
~ git --version
git version 2.11.0
</code></pre>
<h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><p>可以通过 git config –list –global 命令来查看：</p>
<pre><code class="zsh">~ git config --list --global
user.email=1250114609@qq.com
user.name=千古不见一人闲
color.ui=auto
alias.st=status
alias.lg=log --color --graph --pretty=format:&#39;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset&#39; --abbrev-commit
</code></pre>
<p>可以看到有两个alias出现，这里使用了别名。</p>
<p>配置别名</p>
<p>这个功能在shell中是很常用的。我们可以做一些别名来取代比较复杂的指令。<br>比如上面就是使用了以下两个配置</p>
<pre><code class="zsh">~ git config --global alias.st status

~ git config --global alias.lg &quot;log --color --graph --pretty=format:&#39;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset&#39; --abbrev-commit&quot;
</code></pre>
<h4 id="身份认证"><a href="#身份认证" class="headerlink" title="身份认证"></a>身份认证</h4><p>当本地git仓库与git远程仓库通信的时候，需要进行SSH身份认证。<br>打开根目录下的.ssh目录：</p>
<pre><code class="zsh">~/.ssh la
.              ..             config         github_rsa     github_rsa.pub id_rsa         id_rsa.pub     known_hosts
</code></pre>
<p>如果没有id_rsa和id_rsa.pub这两个文件，就通过如下的命令生成：</p>
<p>ssh-keygen -t rsa -C “youremail@example.com”<br>id_rsa和id_rsa.pub这两个文件，就是SSH Key的秘钥对，id_rsa是私钥，id_rsa.pub是公钥，用在github上表明身份。<br>在GitHub上的SSH keys中添加刚刚生成的key。(id_rsa.pub)</p>
<h4 id="创建Git仓库"><a href="#创建Git仓库" class="headerlink" title="创建Git仓库"></a>创建Git仓库</h4><p>创建一个目录，并cd到目录下，通过调用git init来将现有目录初始化为git仓库，或者直接在git init后面跟上目录名，同样也可以创建一个新的仓库。</p>
<p>git clone 直接clone一个远程仓库也是可以的。</p>
<h4 id="提交修改"><a href="#提交修改" class="headerlink" title="提交修改"></a>提交修改</h4><pre><code class="zsh">~/Documents/workspace git_springboot
~/Documents/workspace/git_springboot(master ✔) la
.    ..   .git
~/Documents/workspace/git_springboot(master ✔) touch README.md
~/Documents/workspace/git_springboot(master ✗) vim README.md
~/Documents/workspace/git_springboot(master ✗) git add README.md
~/Documents/workspace/git_springboot(master ✗) git commit -m &quot;add README.md&quot;
[master be9081a] add README.md
 1 file changed, 1 insertion(+)
 create mode 100644 README.md
~/Documents/workspace/git_springboot(master ✔)
</code></pre>
<h4 id="查看修改"><a href="#查看修改" class="headerlink" title="查看修改"></a>查看修改</h4><p>修改README.md文件，git st查看修改</p>
<pre><code class="zsh">~/Documents/workspace/git_springboot(master ✗) git st
On branch master
Your branch is ahead of &#39;origin/master&#39; by 1 commit.
  (use &quot;git push&quot; to publish your local commits)
Changes not staged for commit:
  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)

        modified:   README.md

no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
</code></pre>
<p>Git 比较不同版本文件差异的常用命令格式：</p>
<blockquote>
<p>git diff  查看尚未暂存的文件更新了哪些部分      </p>
<p>git diff filename 查看尚未暂存的某个文件更新了哪些</p>
<p>git diff –cached 查看已经暂存起来的文件和上次提交的版本之间的差异</p>
<p>git diff –cached filename 查看已经暂存起来的某个文件和上次提交的版本之间的差异</p>
</blockquote>
<p>使用git diff README.md 命令看一下修改的具体内容</p>
<blockquote>
<p>diff –git a/README.md b/README.md<br>index e8281cd..f1729fb 100644<br>— a/README.md<br>+++ b/README.md<br>@@ -1 +1 @@<br>-this’s ok.<br>+this’s ok,modify.</p>
</blockquote>
<p>add和commit之后，我们都使用status来查看下状态，可以发现，在commit之后，git提示我们，工作区是干净的。</p>
<pre><code class="zsh">~/Documents/workspace/git_springboot(master ✗) git st
On branch master
Your branch is ahead of &#39;origin/master&#39; by 1 commit.
  (use &quot;git push&quot; to publish your local commits)
Changes not staged for commit:
  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)

        modified:   README.md

no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
~/Documents/workspace/git_springboot(master ✗) git add README.md
~/Documents/workspace/git_springboot(master ✗) git commit -m &quot;modify README.md&quot;
[master a77107b] modify README.md
 1 file changed, 1 insertion(+), 1 deletion(-)
~/Documents/workspace/git_springboot(master ✔) git st
On branch master
Your branch is ahead of &#39;origin/master&#39; by 2 commits.
  (use &quot;git push&quot; to publish your local commits)
nothing to commit, working tree clean
</code></pre>
<h4 id="版本记录"><a href="#版本记录" class="headerlink" title="版本记录"></a>版本记录</h4><p>使用git lg 命令来查看<br>也可以使用gitk命令来查看图形化的log记录</p>
<h4 id="工作区与暂存区"><a href="#工作区与暂存区" class="headerlink" title="工作区与暂存区"></a>工作区与暂存区</h4><p>Git通常是工作在三个区域上：</p>
<p>工作区<br>暂存区<br>历史区<br>其中工作区就是我们平时工作、修改代码的区域；而历史区，用来保存各个版本；而暂存区，则是Git的核心所在。<br><a href="https://git-scm.com/" target="_blank" rel="external">Git官网</a><br><a href="http://marklodato.github.io/visual-git-guide/index-zh-cn.html" target="_blank" rel="external">图解Git</a></p>
<h4 id="版本回退"><a href="#版本回退" class="headerlink" title="版本回退"></a>版本回退</h4><p>回退版本是必不可少的操作啊</p>
<p>我们来考虑以下常见的几种情况：</p>
<ol>
<li>文件已经修改，但是还没有git add</li>
<li>文件已经add到暂存区，又作了修改</li>
<li>文件的修改已经add到了暂存区</li>
</ol>
<p>分别执行以下操作：</p>
<p>➜git checkout – README.md<br>修改被删除，完全还原到上次commit的状态，也就是服务器版本(1.)<br>最后的修改被删除，还原到上次add的状态，也就是修改前的暂存区状态(2.)<br>➜git reset HEAD README.md(3.)</p>
<pre><code class="zsh">~/Documents/workspace/git_springboot(master ✗) git st
On branch master
Your branch is ahead of &#39;origin/master&#39; by 2 commits.
  (use &quot;git push&quot; to publish your local commits)
Changes to be committed:
  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)

        modified:   README.md

~/Documents/workspace/git_springboot(master ✗) git reset HEAD README.md
Unstaged changes after reset:
M       README.md
~/Documents/workspace/git_springboot(master ✗) git st
On branch master
Your branch is ahead of &#39;origin/master&#39; by 2 commits.
  (use &quot;git push&quot; to publish your local commits)
Changes not staged for commit:
  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)

        modified:   README.md

no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
</code></pre>
<p>通过git reset HEAD README.md，我们就把暂存区的文件清除了。这样，在本地就是add前的状态，通过checkout操作，就可以进行修改回退了。<br>在Git中，用HEAD表示当前版本，上一个版本就是<code>HEAD^</code>，<br>上上一个版本就是<code>HEAD^^</code>。（git reset –hard HEAD）<br>要回退到哪个版本，也可以写commit id。</p>
<h4 id="前进版本"><a href="#前进版本" class="headerlink" title="前进版本"></a>前进版本</h4><p>如果我们回退到了旧的版本，但是却后悔了想回到后面某个新的版本,git reflog 查看操作历史。找到 commit id。<br>版本号没必要写全，前7位就可以了，Git会自动去找。</p>
<h4 id="文件暂存"><a href="#文件暂存" class="headerlink" title="文件暂存"></a>文件暂存</h4><p>这里的暂存不是前面说的暂存区，而是只一次备份与恢复操作。<br>git stash<br>指令来将当前修改暂存，这样就可以切换到其他分支或者就在当前干净的分支上checkout了。<br>比如你checkout了一个issue分支，修改了bug，使用git merge合并到了master分支，删除issue分支，切换到dev分支，想继续之前的新功能开发。<br>这时候，就需要恢复现场了：</p>
<p>git stash list<br>指令来查看当前暂存的内容记录。<br>然后，通过git stash apply或者git stash pop来进行恢复，它们的区别是，前者不会删除记录（当然你可以使用git stash drop来删除），而后者会。</p>
<h4 id="远程仓库-amp-同步协作"><a href="#远程仓库-amp-同步协作" class="headerlink" title="远程仓库&amp;同步协作"></a>远程仓库&amp;同步协作</h4><ul>
<li><a href="http://blog.csdn.net/u012702547/article/details/78954832" target="_blank" rel="external">Git关联远程仓库</a></li>
</ul>
<h1 id="Git学习资料"><a href="#Git学习资料" class="headerlink" title="Git学习资料"></a>Git学习资料</h1><p>*<a href="http://blog.csdn.net/u012702547/article/details/78971096" target="_blank" rel="external">Git学习资料</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;#Git 闲话&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;1、最近阅读《数学之美》、《浪潮之巅》惊叹于大神的眼界、文化功底，所以就在得到专栏上订阅了吴军博士的硅谷来信。总之，就是膜拜了。想了解一个人，就先了解一个的思想对不对，所谓见贤与之思齐就是这样了。&lt;br&gt;2、接下来说一说我心目中的另一位大神 林纳斯•托瓦兹，编程界公认的啊。&lt;br&gt;“我不是个有远见的人，我是一名工程师，”托瓦兹说，“我非常乐意跟梦想家在一起，他们行走四方，仰望苍穹……但我是低头看路的那种人，我只想填好眼前这个坑，不让自己掉进去。“&lt;br&gt;只干了两件事啊，毫不夸张的说：惊天地泣鬼神。&lt;br&gt;第一件是开发出Linux内核，驱动了因特网，第二件是开发出Git，一种源代码管理系统，被全世界开发者广泛使用。&lt;br&gt;再接下来，Git 就是我们的主题了，记录以备忘。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Git" scheme="//zeroto.tech/tags/Git/"/>
    
  </entry>
  
</feed>
